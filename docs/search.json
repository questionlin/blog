[{"title":"ç”¨pythonåšçˆ¬è™«çš„æ­£ç¡®å§¿åŠ¿","url":"/posts/1529320519/","content":"å·²ç»ç”¨ python åšäº†ä¸çŸ¥é“å¤šå°‘çˆ¬è™«äº†ï¼Œçœ‹çœ‹ç½‘ä¸Šå…³äºè¿™ä¸ªé¢˜æçš„æ–‡ç« éƒ½å·²ç»å¾ˆè€äº†ï¼Œè¿™ç¯‡æ–‡ç« ä»‹ç»ä¸‹æˆ‘çš„åšæ³•ã€‚\n\nä¸€ä¸ªçˆ¬è™«ç¨‹åºè‡³å°‘éœ€è¦æŠ“å–å’Œè§£æä¸¤ä¸ªéƒ¨åˆ†ï¼ŒæŠ“å–æˆ‘ä½¿ç”¨çš„æ˜¯ [requests](https://github.com/requests/requests)ã€‚è¿™ä¸ªåº“é™¤äº†å°è£… get, post è¯·æ±‚å¤–ï¼Œå°¤å…¶æ–¹ä¾¿çš„æ˜¯å°è£…äº†ä¼šè¯( session )ï¼Œè‡ªåŠ¨æ›´æ–° cookiesã€‚å¯¹æŠ“å–éœ€è¦ç™»å½•çš„ç½‘ç«™ç‰¹åˆ«å¥½ç”¨ã€‚\n\nè§£ææˆ‘ä½¿ç”¨çš„æ˜¯ [pyquery](https://github.com/gawel/pyquery)ã€‚è¿™ä¸ªåº“å¯¹ jQuery è¾¾åˆ°äº†å¾ˆé«˜çš„æ¨¡ä»¿ï¼Œç†Ÿæ‚‰ jQuery çš„äººä¸Šæ‰‹éå¸¸å¿«ã€‚é€šå¸¸æˆ‘éƒ½æ˜¯åœ¨æµè§ˆå™¨çš„ console é‡Œå¤åˆ¶ html å…ƒç´ çš„ css é€‰æ‹©å™¨æˆ–è€… xpath è·¯å¾„ã€‚è¿™é‡Œè¦æ³¨æ„æµè§ˆå™¨ä¼šç»™é€‰æ‹©å™¨æ·»åŠ å…ƒç´ ï¼Œä¾‹å¦‚ tbodyï¼Œå¤åˆ¶å‡ºæ¥æ˜¯ table > tbody > trã€‚ä½†å…¶å® html é‡Œæ²¡æœ‰ tbody è¿™ä¸ªå…ƒç´ ã€‚æ‰‹åŠ¨å»æ‰å°±å¥½äº†ã€‚\n\n----------------------\næ­¤å¤– python è¿˜æœ‰ä¸€ä¸ªé‡é‡çº§çš„çˆ¬è™«åº“å« scrapyã€‚è¿™ä¸ªä»¥å‰ä¼šç”¨ï¼Œç°åœ¨å·²ç»å¾ˆå°‘ç”¨äº†ã€‚å¦‚æœæ˜¯å¤§å·¥ç¨‹å¯ä»¥è€ƒè™‘ã€‚","tags":["python"]},{"title":"golangå¼€å‘ç¯å¢ƒæ­å»º","url":"/posts/1529303379/","content":"### å®‰è£…\nMac ä¸‹å®‰è£… Go ç¼–è¯‘å™¨åªè¦æ‰§è¡Œ\n```\nbrew install go\n```\nå°±å¯ä»¥äº†ã€‚å„ linux ä¹Ÿå¯ä»¥ä½¿ç”¨è‡ªå·±çš„åŒ…ç®¡ç†å™¨ç›´æ¥å®‰è£…\n\n### å·¥ä½œç©ºé—´\né¦–å…ˆæ‰¾ä¸€ä¸ªåœ°æ–¹æ”¾æˆ‘ä»¬çš„å·¥ä½œç©ºé—´ï¼Œæ¯”å¦‚æˆ‘é€‰çš„æ˜¯$HOME/Documents/goworkã€‚è¿™ä¸ªç›®å½•çš„ä½ç½®ä¸èƒ½æ˜¯ Go å®‰è£…ç›®å½•ã€‚\n```\n$ mkdir $HOME/Documents/gowork\n```\nGoä»£ç å¿…é¡»æ”¾åœ¨å·¥ä½œç©ºé—´å†…ã€‚å®ƒå…¶å®å°±æ˜¯ä¸€ä¸ªç›®å½•ï¼Œå…¶ä¸­åŒ…å«ä¸‰ä¸ªå­ç›®å½•ï¼š\n- src ç›®å½•åŒ…å«Goçš„æºæ–‡ä»¶ï¼Œå®ƒä»¬è¢«ç»„ç»‡æˆåŒ…ï¼ˆæ¯ä¸ªç›®å½•éƒ½å¯¹åº”ä¸€ä¸ªåŒ…ï¼‰ï¼Œ\n- pkg ç›®å½•åŒ…å«åŒ…å¯¹è±¡ï¼Œ\n- bin ç›®å½•åŒ…å«å¯æ‰§è¡Œå‘½ä»¤ã€‚\n\nä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ï¼š\n```\nbin/\n    hello       # ç¼–è¯‘å¥½çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¯æ‰§è¡Œå‘½ä»¤\npkg/\n    darwin_amd64/\n        github.com/questionlin/\n            stringutil.a      # ç¼–è¯‘å¥½çš„åŒ…å¯¹è±¡\nsrc/\n    github.com/questionilin/\n        hello/\n            hello.go        # æºä»£ç \n            hello_test.go   # æµ‹è¯•æ–‡ä»¶æºä»£ç \n        stringutil/\n            reverse.go      # åŒ…æºç \n\n```\n\n### \bGOPATH ç¯å¢ƒå˜é‡\næ‰§è¡Œä¸‹é¢çš„å‘½ä»¤\n```\n$ export GOPATH=$HOME/gowork\n$ export PATH=$PATH:$GOPATH/bin\n```\n\n### ç¬¬ä¸€ä¸ªç¨‹åº\næˆ‘åœ¨ github çš„ç”¨æˆ·åæ˜¯ questionlinï¼Œæˆ‘è¦åšçš„ç¬¬ä¸€ä¸ªç¨‹åºå« helloã€‚æ‰§è¡Œå‘½ä»¤\n```\n$ mkdir -p $GOPATH/src/github.com/questionlin/hello\n$ cd $GOPATH/src/github.com/questionlin/hello\n$ touch hello.go\n```\nå†™å…¥ä¸€ä¸‹ä»£ç \n```\npackage main\n\nimport \"fmt\"\n\nfunc main() {\n\tfmt.Printf(\"Hello, world.\\n\")\n}\n```\næ‰§è¡Œä¸€ä¸‹å‘½ä»¤ç¼–è¯‘ã€‚è¿™ä¸ªå‘½ä»¤åœ¨ä»»ä½•ç›®å½•éƒ½å¯ä»¥æ‰§è¡Œï¼Œä¸éœ€è¦åœ¨å·¥ä½œç©ºé—´\n```\n$ go install github.com/questionlin/hello\n```\nå¦‚æœåœ¨å·¥ä½œç©ºé—´å¯ä»¥çœç•¥è·¯å¾„\n```\n$ cd $GOPATH/src/github.com/questionlin/hello\n$ go install\n```\nç°åœ¨æ‰§è¡Œçœ‹çœ‹\n```\n$ $GOPATH/bin/hello\nHello, world.\n```\n\n### ç¬¬ä¸€ä¸ªåº“\né¦–å…ˆåˆ›å»ºç›®å½•ï¼š\n```\n$ mkdir $GOPATH/src/github.com/questionlin/stringutil\n$ cd $GOPATH/src/github.com/questionlin/stringutil\n$ touch reverse.go\n```\nå†™å…¥ä¸€ä¸‹å†…å®¹\n```\n// stringutil åŒ…å«æœ‰ç”¨äºå¤„ç†å­—ç¬¦ä¸²çš„å·¥å…·å‡½æ•°ã€‚\npackage stringutil\n\n// Reverse å°†å…¶å®å‚å­—ç¬¦ä¸²ä»¥ç¬¦æ–‡ä¸ºå•ä½å·¦å³åè½¬ã€‚\nfunc Reverse(s string) string {\n\tr := []rune(s)\n\tfor i, j := 0, len(r)-1; i < len(r)/2; i, j = i+1, j-1 {\n\t\tr[i], r[j] = r[j], r[i]\n\t}\n\treturn string(r)\n}\n```\nä½¿ç”¨ go build æ¥ç¼–è¯‘:\n```\n$ go build github.com/questionlin/stringutil\n```\nå¦‚æœä½ åœ¨è¯¥åŒ…çš„æºç ç›®å½•ä¸­ï¼Œåªéœ€æ‰§è¡Œï¼š\n```\n$ go build\n```\nä¿®æ”¹åŸæ¥çš„ hello.go æ–‡ä»¶ï¼ŒåŠ å…¥è¿™ä¸ªåŒ…ï¼š\n```\npackage main\n\nimport (\n\t\"fmt\"\n\n\t\"github.com/questionlin/stringutil\"\n)\n\nfunc main() {\n\tfmt.Printf(stringutil.Reverse(\"!oG ,olleH\"))\n}\n```\nç„¶ååœ¨ç¼–è¯‘ä¸€æ¬¡ helloï¼š\n```\n$ go install github.com/questionlin/hello\n```\nç°åœ¨å†è¿è¡Œä¸€æ¬¡\n```\n$ hello\nHello, Go!\n```\nå®Œæˆä»¥ä¸Šæ­¥éª¤åï¼Œä½ çš„å·¥ä½œåŒºé—´åº”è¯¥æ˜¯åƒæœ€ä¸Šé¢ä»‹ç»å·¥ä½œç©ºé—´é‚£ç« é‡Œä¸€æ ·\n\n\n### åŒ…å\nGoæºæ–‡ä»¶ä¸­çš„ç¬¬ä¸€ä¸ªè¯­å¥å¿…é¡»æ˜¯\n```\npackage åç§°\n```\nè¿™é‡Œçš„ åç§° å³ä¸ºå¯¼å…¥è¯¥åŒ…æ—¶ä½¿ç”¨çš„é»˜è®¤åç§°ã€‚ ï¼ˆä¸€ä¸ªåŒ…ä¸­çš„æ‰€æœ‰æ–‡ä»¶éƒ½å¿…é¡»ä½¿ç”¨ç›¸åŒçš„ åç§°ã€‚ï¼‰\n\nGoçš„çº¦å®šæ˜¯åŒ…åä¸ºå¯¼å…¥è·¯å¾„çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼šä½œä¸º â€œcrypto/rot13â€ å¯¼å…¥çš„åŒ…åº”å‘½åä¸º rot13ã€‚\n\nå¯æ‰§è¡Œå‘½ä»¤å¿…é¡»ä½¿ç”¨ package mainã€‚\n\n### æµ‹è¯•\nGoæ‹¥æœ‰ä¸€ä¸ªè½»é‡çº§çš„æµ‹è¯•æ¡†æ¶ï¼Œå®ƒç”± go test å‘½ä»¤å’Œ testing åŒ…æ„æˆã€‚\n\nä½ å¯ä»¥é€šè¿‡åˆ›å»ºä¸€ä¸ªåå­—ä»¥ _test.go ç»“å°¾çš„ï¼ŒåŒ…å«åä¸º TestXXX ä¸”ç­¾åä¸º func (t *testing.T) å‡½æ•°çš„æ–‡ä»¶æ¥ç¼–å†™æµ‹è¯•ã€‚ æµ‹è¯•æ¡†æ¶ä¼šè¿è¡Œæ¯ä¸€ä¸ªè¿™æ ·çš„å‡½æ•°ï¼›è‹¥è¯¥å‡½æ•°è°ƒç”¨äº†åƒ t.Error æˆ– t.Fail è¿™æ ·è¡¨ç¤ºå¤±è´¥çš„å‡½æ•°ï¼Œæ­¤æµ‹è¯•å³è¡¨ç¤ºå¤±è´¥ã€‚\n\næˆ‘ä»¬å¯é€šè¿‡åˆ›å»ºæ–‡ä»¶ $GOPATH/src/github.com/questionlin/stringutil/reverse_test.go æ¥ä¸º stringutil æ·»åŠ æµ‹è¯•ï¼Œå…¶å†…å®¹å¦‚ä¸‹ï¼š\n```\npackage stringutil\n\nimport \"testing\"\n\nfunc TestReverse(t *testing.T) {\n\tcases := []struct {\n\t\tin, want string\n\t}{\n\t\t{\"Hello, world\", \"dlrow ,olleH\"},\n\t\t{\"Hello, ä¸–ç•Œ\", \"ç•Œä¸– ,olleH\"},\n\t\t{\"\", \"\"},\n\t}\n\tfor _, c := range cases {\n\t\tgot := Reverse(c.in)\n\t\tif got != c.want {\n\t\t\tt.Errorf(\"Reverse(%q) == %q, want %q\", c.in, got, c.want)\n\t\t}\n\t}\n}\n```\næ¥ç€ä½¿ç”¨ go test è¿è¡Œè¯¥æµ‹è¯•ï¼š\n```\n$ go test github.com/questionlin/stringutil\nok  \tgithub.com/questionlin/stringutil 0.165s\n```\n\n\næœ€åç»™ä¸€ä¸ªå¢™å†…èƒ½ç”¨çš„ golang å­¦ä¹ æ•™ç¨‹ï¼š\nhttps://tour.go-zh.org/list\n\nå‚è€ƒï¼šhttps://go-zh.org/doc/\n","tags":["golang"]},{"title":"linuxç£ç›˜æ»¡äº†æ€ä¹ˆæ¸…ç†","url":"/posts/1528685621/","content":"1. ä½¿ç”¨ df -h æŸ¥çœ‹ç£ç›˜å‰©ä½™ç©ºé—´\n2. ä½¿ç”¨ du --max-depth=1 -h ä¸€çº§ä¸€çº§æŸ¥çœ‹ç£ç›˜æ–‡ä»¶å ç”¨ï¼Œæ‰¾åˆ°é€‚åˆåˆ æ‰çš„æ–‡ä»¶\n3. å¦‚æœæ˜¯åªæƒ³åˆ æ‰å¤§æ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨ find . -maxdepth 1 -size +100M\n```\n#df -h\nFilesystem      Size  Used Avail Use% Mounted on\n/dev/vda1        30G   12G   17G  40% /\ndevtmpfs        7.8G     0  7.8G   0% /dev\n/dev/vdb         99G   55G   39G  59% /opt\n\n\n#du --max-depth=1 -h\n272K ./.gconf \n32K ./.mcop \n16K ./.redhat \n1.7M ./.thumbnails \n8.0K ./.gconfd \n7.5M . \n\n#find . -maxdepth 1 -size +100M\n./.gconf \n./.mcop \n./.redhat \n./.thumbnails \n./.gconfd \n```","tags":["è¿ç»´"]},{"title":"MySQLç´¢å¼•ç»“æ„å’Œä¼˜åŒ–","url":"/posts/1528513470/","content":"### B-Tree ç´¢å¼•\nInnoDB ä½¿ç”¨çš„æ˜¯B+Treeï¼Œå³æ¯ä¸€ä¸ªå¶å­ç»“ç‚¹éƒ½åŒ…å«æŒ‡å‘ä¸‹ä¸€ä¸ªå¶å­èŠ‚ç‚¹çš„æŒ‡é’ˆï¼Œä»è€Œæ–¹ä¾¿å¶å­èŠ‚ç‚¹çš„èŒƒå›´éå†ã€‚B-Treeé€šå¸¸æ„å‘³ç€æ‰€æœ‰çš„å€¼éƒ½æ˜¯æŒ‰**é¡ºåº**å­˜å‚¨åœ¨å¶å­èŠ‚ç‚¹çš„ï¼Œå¹¶ä¸”æ¯ä¸€ä¸ªå¶å­é¡µåˆ°æ ¹çš„è·ç¦»ç›¸åŒã€‚\n\nå‡è®¾æœ‰å¦‚ä¸‹æ•°æ®è¡¨ï¼š\n```\nCREATE TABLE People (\n    last_name varchar(50)    not null,\n    first_name varchar(50)   not null,\n    dob date                 not null,\n    gender enum('m', 'f')  not null,\n    key(last_name, first_name, dob)\n);\n```\nå¯ä»¥ä½¿ç”¨B-Treeç´¢å¼•çš„æŸ¥è¯¢ç±»å‹ã€‚B-Treeç´¢å¼•é€‚ç”¨äºå…¨é”®å€¼ã€é”®å€¼èŒƒå›´æˆ–é”®å‰ç¼€æŸ¥æ‰¾ã€‚**å…¶ä¸­é”®å‰ç¼€æŸ¥æ‰¾åªé€‚ç”¨äºæ ¹æ®æœ€å·¦å‰ç¼€çš„æŸ¥æ‰¾**ã€‚æ­¤ç´¢å¼•å¯¹å¦‚ä¸‹ç±»å‹çš„æŸ¥è¯¢æœ‰æ•ˆã€‚\n\n- å…¨å€¼åŒ¹é…\n  å…¨å€¼åŒ¹é…æŒ‡çš„æ˜¯å’Œç´¢å¼•ä¸­çš„æ‰€æœ‰åˆ—è¿›è¡ŒåŒ¹é…ï¼Œä¾‹å¦‚å‰é¢æåˆ°çš„ç´¢å¼•å¯ç”¨äºæŸ¥æ‰¾ last_name ä¸º Allen, first_name ä¸º Cuba ã€å‡ºç”Ÿäº1960-01-01çš„äººã€‚\n\n- åŒ¹é…æœ€å·¦å‰ç¼€  \nç´¢å¼•å¯ç”¨äºæŸ¥æ‰¾æ‰€æœ‰ lat_name ä¸ºAllençš„äººï¼Œå³åªä½¿ç”¨ç´¢å¼•çš„ç¬¬ä¸€åˆ—ã€‚\n\n- åŒ¹é…åˆ—å‰ç¼€  \nä¹Ÿå¯ä»¥åªåŒ¹é…æŸä¸€åˆ—çš„å€¼çš„å¼€å¤´éƒ¨åˆ†ã€‚ä¾‹å¦‚å‰é¢æåˆ°çš„ç´¢å¼•å¯ç”¨äºæŸ¥æ‰¾æ‰€æœ‰ä»¥Jå¼€å¤´çš„å§“çš„äººã€‚è¿™é‡Œä¹Ÿåªä½¿ç”¨äº†ç´¢å¼•çš„ç¬¬ä¸€åˆ—ã€‚\n\n- åŒ¹é…èŒƒå›´å€¼  \nä¾‹å¦‚å‰é¢æåˆ°çš„ç´¢å¼•å¯ç”¨äºæŸ¥æ‰¾å§“åœ¨Allenå’ŒBarrymoreä¹‹é—´çš„äººã€‚è¿™é‡Œä¹Ÿåªä½¿ç”¨äº†ç´¢å¼•çš„ç¬¬ä¸€åˆ—ã€‚\n\n- ç²¾ç¡®åŒ¹é…æŸä¸€åˆ—å¹¶èŒƒå›´åŒ¹é…å¦å¤–ä¸€åˆ—  \nå‰é¢æåˆ°çš„ç´¢å¼•ä¹Ÿå¯ç”¨äºæŸ¥æ‰¾æ‰€æœ‰å§“ä¸ºAllenï¼Œå¹¶ä¸”åå­—æ˜¯å­—æ¯Kå¼€å¤´ï¼ˆæ¯”å¦‚Kimã€Karlç­‰ï¼‰çš„äººã€‚å³ç¬¬ä¸€åˆ—last_nameå…¨åŒ¹é…ï¼Œç¬¬äºŒåˆ—frst_nameèŒƒå›´åŒ¹é…ã€‚\n\n#### B-Treeç´¢å¼•çš„é™åˆ¶ï¼š\n- å¦‚æœä¸æ˜¯æŒ‰ç…§ç´¢å¼•çš„æœ€å·¦åˆ—å¼€å§‹æŸ¥æ‰¾ï¼Œåˆ™æ— æ³•ä½¿ç”¨ç´¢å¼•ã€‚ä¾‹å¦‚ä¸Šé¢ä¾‹å­ä¸­çš„ç´¢å¼•æ— æ³•ç”¨äºæŸ¥æ‰¾åå­—ä¸ºBillçš„äººï¼Œä¹Ÿæ— æ³•æŸ¥æ‰¾æŸä¸ªç‰¹å®šç”Ÿæ—¥çš„äººï¼Œå› ä¸ºè¿™ä¸¤åˆ—éƒ½ä¸æ˜¯æœ€å·¦æ•°æ®åˆ—ã€‚ç±»ä¼¼åœ°ï¼Œä¹Ÿæ— æ³•æŸ¥æ‰¾å§“æ°ä»¥æŸä¸ªå­—æ¯ç»“å°¾çš„äººã€‚\n- ä¸èƒ½è·³è¿‡ç´¢å¼•ä¸­çš„åˆ—ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå‰é¢æ‰€è¿°çš„ç´¢å¼•æ— æ³•ç”¨äºæŸ¥æ‰¾å§“ä¸ºSmithå¹¶ä¸”åœ¨æŸä¸ªç‰¹å®šæ—¥æœŸå‡ºç”Ÿçš„äººã€‚å¦‚æœä¸æŒ‡å®šåï¼ˆfirst_nameï¼‰ï¼Œåˆ™MySQLåªèƒ½ä½¿ç”¨ç´¢å¼•çš„ç¬¬ä¸€åˆ—ã€‚\n- å¦‚æœæŸ¥è¯¢ä¸­æœ‰æŸä¸ªåˆ—çš„èŒƒå›´æŸ¥è¯¢ï¼Œåˆ™å…¶å³è¾¹æ‰€æœ‰åˆ—éƒ½æ— æ³•ä½¿ç”¨ç´¢å¼•ä¼˜åŒ–æŸ¥æ‰¾ã€‚ä¾‹å¦‚æœ‰æŸ¥è¯¢WHERE last_name='Smith' AND frst_name LIKE 'Jï¼…' AND dob='1976-12-23'ï¼Œè¿™ä¸ªæŸ¥è¯¢åªèƒ½ä½¿ç”¨ç´¢å¼•çš„å‰ä¸¤åˆ—ï¼Œå› ä¸ºè¿™é‡ŒLIKEæ˜¯ä¸€ä¸ªèŒƒå›´æ¡ä»¶ï¼ˆä½†æ˜¯æœåŠ¡å™¨å¯ä»¥æŠŠå…¶ä½™åˆ—ç”¨äºå…¶ä»–ç›®çš„ï¼‰ã€‚å¦‚æœèŒƒå›´æŸ¥è¯¢åˆ—å€¼çš„æ•°é‡æœ‰é™ï¼Œé‚£ä¹ˆå¯ä»¥é€šè¿‡ä½¿ç”¨å¤šä¸ªç­‰äºæ¡ä»¶æ¥ä»£æ›¿èŒƒå›´æ¡ä»¶ã€‚åœ¨æœ¬ç« çš„ç´¢å¼•æ¡ˆä¾‹å­¦ä¹ éƒ¨åˆ†ï¼Œæˆ‘ä»¬å°†æ¼”ç¤ºä¸€ä¸ªè¯¦ç»†çš„æ¡ˆä¾‹ã€‚\n\nåˆ°è¿™é‡Œè¯»è€…åº”è¯¥å¯ä»¥æ˜ç™½ï¼Œå‰é¢æåˆ°çš„ç´¢å¼•åˆ—çš„é¡ºåºæ˜¯å¤šä¹ˆçš„é‡è¦ï¼šè¿™äº›é™åˆ¶éƒ½å’Œç´¢å¼•åˆ—çš„é¡ºåºæœ‰å…³ã€‚åœ¨ä¼˜åŒ–æ€§èƒ½çš„æ—¶å€™ï¼Œå¯èƒ½éœ€è¦ä½¿ç”¨ç›¸åŒçš„åˆ—ä½†é¡ºåºä¸åŒçš„ç´¢å¼•æ¥æ»¡è¶³ä¸åŒç±»å‹çš„æŸ¥è¯¢éœ€æ±‚ã€‚\n\n### é«˜æ€§èƒ½ç´¢å¼•ç­–ç•¥\n#### ç‹¬ç«‹çš„åˆ—\n**ç´¢å¼•åˆ—ä¸èƒ½æ˜¯è¡¨è¾¾å¼çš„ä¸€éƒ¨åˆ†ï¼Œä¹Ÿä¸èƒ½æ˜¯å‡½æ•°çš„å‚æ•°ã€‚** ä»¥ä¸‹æ˜¯å¤±è´¥ä¾‹å­ï¼š\n```\nmysql> SELECT actor_id FROM sakila.actor WHERE actor_id + 1 = 5;\nmysql> SELECT ... WHERE TO_DAYS(CURRENT_DATE) - TO_DAYS(date_col) <= 10;\n```\n\n#### å‰ç¼€ç´¢å¼•å’Œç´¢å¼•é€‰æ‹©æ€§\næœ‰æ—¶å€™éœ€è¦ç´¢å¼•å¾ˆé•¿çš„å­—ç¬¦åˆ—ï¼Œè¿™ä¼šè®©ç´¢å¼•å˜å¾—å¤§ä¸”æ…¢ã€‚\bè¯€çªåœ¨äºè¦é€‰æ‹©è¶³å¤Ÿé•¿çš„å‰ç¼€ä»¥ä¿è¯è¾ƒé«˜çš„é€‰æ‹©æ€§ï¼ŒåŒæ—¶åˆä¸èƒ½å¤ªé•¿ã€‚  \nç°åœ¨æˆ‘ä»¬æœ‰å¦‚ä¸‹æ•°æ®é›†\n```\nmysql>SELECT COUNT(*) AS cnt, city FROM city GROUP BY city ORDER BY cnt DESC LIMIT 10;\n-------------------------------------\n| cnt | city|\n+-----+-----+\n| 65 | London |\n| 49 | Hiroshima |\n| 48 | Teboksary |\n| 48 | Pak Kret |\n| 48 | Yaound |\n| 47 | Tel Aviv-Jaffa |\n| 47 | Shimoga |\n| 45 | Cabuyao |\n| 45 | Callao |\n| 45 | Bislig |\n```\næ³¨æ„åˆ°ï¼Œä¸Šé¢æ¯ä¸ªå€¼éƒ½å‡ºç°äº†45ï½65æ¬¡ã€‚ç°åœ¨æŸ¥æ‰¾åˆ°æœ€é¢‘ç¹å‡ºç°çš„åŸå¸‚å‰ç¼€ï¼Œå…ˆä»3ä¸ªå‰ç¼€å­—æ¯å¼€å§‹ï¼š\n```\nmysql>SELECT COUNT(*) AS cnt, LEFT(city, 3) AS pref FROM city GROUP BY pref ORDER BY cnt DESC LIMIT 10;\n| cnt | pref |\n+-----+------+\n| 483 | San |\n| 195 | Cha |\n| 177 | Tan |\n| 167 | Sou |\n| 163 | al- |\n| 163 | Sal |\n| 146 | Shi |\n| 136 | Hal |\n| 130 | Val |\n| 129 | Bat |\n```\næ¯ä¸ªå‰ç¼€éƒ½æ¯”åŸæ¥çš„åŸå¸‚å‡ºç°çš„æ¬¡æ•°æ›´å¤šï¼Œå› æ­¤å”¯ä¸€å‰ç¼€æ¯”å”¯ä¸€åŸå¸‚è¦å°‘å¾—å¤šã€‚ç„¶åæˆ‘ä»¬å¢åŠ å‰ç¼€é•¿åº¦ï¼Œç›´åˆ°è¿™ä¸ªå‰ç¼€çš„é€‰æ‹©æ€§æ¥è¿‘å®Œæ•´åˆ—çš„é€‰æ‹©æ€§ã€‚ç»è¿‡å®éªŒåå‘ç°å‰ç¼€é•¿åº¦ä¸º7æ—¶æ¯”è¾ƒåˆé€‚ï¼š\n```\nmysql>SELECT COUNT(*) AS cnt, LEFT(city, 3) AS pref FROM city GROUP BY pref ORDER BY cnt DESC LIMIT 10;\n| cnt | pref |\n+-----+------+\n| 70 | Santiag |\n| 68 | San Fel |\n| 65 | London |\n| 61 | Valle d |\n| 49 | Hiroshi |\n| 48 | Teboksa |\n| 48 | Pak Kre |\n| 48 | Yaound |\n| 47 | Tel Avi |\n| 47 | Shimoga |\n```\nè®¡ç®—åˆé€‚çš„å‰ç¼€é•¿åº¦çš„å¦å¤–ä¸€ä¸ªåŠæ³•å°±æ˜¯è®¡ç®—å®Œæ•´åˆ—çš„é€‰æ‹©æ€§ï¼Œå¹¶ä½¿å‰ç¼€çš„é€‰æ‹©æ€§æ¥è¿‘äºå®Œæ•´åˆ—çš„é€‰æ‹©æ€§ã€‚ä¸‹é¢æ˜¾ç¤ºå¦‚ä½•è®¡ç®—å®Œæ•´åˆ—çš„é€‰æ‹©æ€§ï¼š\n```\nmysql> SELECT COUNT(DISTINCT LEFT(city, 7))/COUNT(*) FROM city;\n| COUNT(DISTINCT city)/COUNT(*) |\n+-------------------------------+\n| 0.0310 |\n```\né€šå¸¸æ¥è¯´ï¼ˆå°½ç®¡ä¹Ÿæœ‰ä¾‹å¤–æƒ…å†µï¼‰ï¼Œè¿™ä¸ªä¾‹å­ä¸­å¦‚æœå‰ç¼€çš„é€‰æ‹©æ€§èƒ½å¤Ÿæ¥è¿‘0.031ï¼ŒåŸºæœ¬ä¸Šå°±å¯ç”¨äº†ã€‚\n\nåœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œå·²ç»æ‰¾åˆ°äº†åˆé€‚çš„å‰ç¼€é•¿åº¦ï¼Œä¸‹é¢æ¼”ç¤ºä¸€ä¸‹å¦‚ä½•åˆ›å»ºå‰ç¼€ç´¢å¼•ï¼š\n```\nmysql> ALTER TABLE sakila.city_demo ADD KEY (city(7));\n```\nå‰ç¼€ç´¢å¼•æ˜¯ä¸€ç§èƒ½ä½¿ç´¢å¼•æ›´å°ã€æ›´å¿«çš„æœ‰æ•ˆåŠæ³•ï¼Œä½†å¦ä¸€æ–¹é¢ä¹Ÿæœ‰å…¶ç¼ºç‚¹ï¼šMySQLæ— æ³•ä½¿ç”¨å‰ç¼€ç´¢å¼•åšORDER BYå’ŒGROUP BYï¼Œä¹Ÿæ— æ³•ä½¿ç”¨å‰ç¼€ç´¢å¼•åšè¦†ç›–æ‰«æã€‚\n\n\n--------------------------\nå‚è€ƒèµ„æ–™ï¼šã€Šé«˜æ€§èƒ½MySQLã€‹","tags":["mysql"]},{"title":"Hello World","url":"/posts/1528164216/","content":"Welcome to [Hexo](https://hexo.io/)! This is your very first post. Check [documentation](https://hexo.io/docs/) for more info. If you get any problems when using Hexo, you can find the answer in [troubleshooting](https://hexo.io/docs/troubleshooting.html) or you can ask me on [GitHub](https://github.com/hexojs/hexo/issues).\n\n## Quick Start\n\n### Create a new post\n\n``` bash\n$ hexo new \"My New Post\"\n```\n\nMore info: [Writing](https://hexo.io/docs/writing.html)\n\n### Run server\n\n``` bash\n$ hexo server\n```\n\nMore info: [Server](https://hexo.io/docs/server.html)\n\n### Generate static files\n\n``` bash\n$ hexo generate\n```\n\nMore info: [Generating](https://hexo.io/docs/generating.html)\n\n### Deploy to remote sites\n\n``` bash\n$ hexo deploy\n```\n\nMore info: [Deployment](https://hexo.io/docs/deployment.html)\n"},{"title":"JVM åƒåœ¾å¤„ç†çš„ä¸€äº›æ€»ç»“","url":"/posts/1528196487/","content":"## å†…å­˜ç®¡ç†\n### ç¨‹åºè®¡æ•°å™¨\nç¨‹åºè®¡æ•°å™¨ï¼ˆProgram Counter Registerï¼‰ï¼Œç”¨æ¥è®°å½•ç¨‹åºå·²ç»æ‰§è¡Œåˆ°çš„è¡Œå·ï¼Œå½“è™šæ‹Ÿæœºåœ¨å¤šä¸ªçº¿ç¨‹è½®æµåˆ‡æ¢æ—¶ï¼Œé å®ƒå›åˆ°æ­£ç¡®çš„æ‰§è¡Œä½ç½®ã€‚\n\n### å †å’Œæ ˆ\nJava å†…å­˜å¯ä»¥å¤§è‡´åˆ†ä¸ºï¼šåˆ†ä¸ºè™šæ‹Ÿæœºæ ˆï¼Œæœ¬åœ°æ–¹æ³•æ ˆï¼ŒJava å †ï¼Œæ–¹æ³•åŒºï¼Œè¿è¡Œæ—¶å¸¸é‡æ± ï¼Œç›´æ¥å†…å­˜ã€‚å„è‡ªç”¨æ¥å­˜å‚¨è™šæ‹Ÿæœºå’Œç”¨æˆ·ç¨‹åºçš„ä»£ç ã€å˜é‡å’Œå…¶ä»–ä¸€äº›ä¿¡æ¯ã€‚å…¶ä¸­ï¼ŒJava å †æ˜¯æ‰€æœ‰çº¿ç¨‹å…±äº«çš„ä¸€å—å†…å­˜åŒºåŸŸï¼Œå”¯ä¸€ç›®çš„æ—¶å­˜æ”¾å¯¹è±¡å®ä¾‹ã€‚å› æ­¤ä¹Ÿæˆä¸ºåƒåœ¾ç®¡ç†çš„ä¸»è¦åŒºåŸŸã€‚\n\n## åƒåœ¾æ”¶é›†\n### åˆ¤æ–­å¯¹è±¡æ˜¯å¦éœ€è¦è¢«æ¸…ç†\nåˆ¤æ–­å¯¹è±¡æ˜¯å¦éœ€è¦è¢«æ¸…ç†å¯ä»¥åˆ†ä¸ºå¼•ç”¨è®¡æ•°ç®—æ³•å’Œå¯è¾¾æ€§åˆ†æç®—æ³•ã€‚\n\nå¼•ç”¨è®¡æ•°ç®—æ³•çš„åŸç†æ˜¯è¿™æ ·çš„ï¼šç»™å¯¹è±¡ä¸­æ·»åŠ ä¸€ä¸ªå¼•ç”¨è®¡æ•°å™¨ï¼Œæ¯å½“æœ‰ä¸€ä¸ªåœ°æ–¹å¼•ç”¨å®ƒæ—¶ï¼Œè®¡æ•°å™¨å°±åŠ 1ï¼›å½“é¥®ç”¨å¤±æ•ˆæ—¶ï¼Œè®¡æ•°å™¨å°±å‡1ï¼›ä»»ä½•æ—¶åˆ»è®¡æ•°å™¨ä¸º0çš„å¯¹è±¡å°±æ˜¯ä¸å¯èƒ½å†è¢«ä½¿ç”¨çš„ã€‚\n\nå¯è¾¾æ€§åˆ†æç®—æ³•é€šè¿‡æ ‘æ¥ä¿å­˜å¯¹è±¡çš„å¼•ç”¨é“¾ï¼Œå¦‚æœå¯¹è±¡å’Œæ ¹ï¼ˆGC Rootsï¼‰ä¸å†æœ‰å¼•ç”¨é“¾æ—¶ï¼Œå°±è¢«åˆ¤æ–­åˆ¤æ–­ä¸ºä¸å¯è¾¾ã€‚æ­¤æ—¶å¯¹è±¡ä¸ä¼šè¢«ç«‹å³å›æ”¶ï¼Œè€Œæ˜¯è¦ç»å†ä¸€ä¸ª finalize() æ–¹æ³•çš„å›æ”¶è¿‡ç¨‹ï¼Œåœ¨æ­¤è¿‡ç¨‹ä¸­å¯¹è±¡å¯ä»¥è‡ªæ•‘ã€‚\n\n\n### åƒåœ¾æ”¶é›†ç®—æ³•\n#### æ ‡è®°-æ¸…é™¤ç®—æ³•\næœ€åŸºç¡€çš„æ”¶é›†ç®—æ³•æ˜¯â€œæ ‡è®°-æ¸…é™¤â€ï¼ˆMark-Sweepï¼‰ç®—æ³•ï¼Œå¦‚åŒå®ƒçš„åå­—ä¸€æ ·ï¼Œç®—æ³•åˆ†ä¸ºâ€œæ ‡è®°â€å’Œâ€œæ¸…é™¤â€ä¸¤ä¸ªé˜¶æ®µï¼šé¦–å…ˆæ ‡è®°å‡ºæ‰€æœ‰éœ€è¦å›æ”¶çš„å¯¹è±¡ï¼Œåœ¨æ ‡è®°å®Œæˆåç»Ÿä¸€å›æ”¶æ‰€æœ‰è¢«æ ‡è®°çš„å¯¹è±¡ï¼Œå®ƒçš„æ ‡è®°è¿‡ç¨‹å…¶å®åœ¨å‰ä¸€èŠ‚è®²è¿°å¯¹è±¡æ ‡è®°åˆ¤å®šæ—¶å·²ç»ä»‹ç»è¿‡äº†ã€‚ä¹‹æ‰€ä»¥è¯´å®ƒæ˜¯æœ€åŸºç¡€çš„æ”¶é›†ç®—æ³•ï¼Œæ˜¯å› ä¸ºåç»­çš„æ”¶é›†ç®—æ³•éƒ½æ˜¯åŸºäºè¿™ç§æ€è·¯å¹¶å¯¹å…¶ä¸è¶³è¿›è¡Œæ”¹è¿›è€Œå¾—åˆ°çš„ã€‚å®ƒçš„ä¸»è¦ä¸è¶³æœ‰ä¸¤ä¸ªï¼šä¸€ä¸ªæ˜¯æ•ˆç‡é—®é¢˜ï¼Œæ ‡è®°å’Œæ¸…é™¤ä¸¤ä¸ªè¿‡ç¨‹çš„æ•ˆç‡éƒ½ä¸é«˜ï¼›å¦ä¸€ä¸ªæ˜¯ç©ºé—´é—®é¢˜ï¼Œæ ‡è®°æ¸…é™¤ä¹‹åä¼šäº§ç”Ÿå¤§é‡ä¸è¿ç»­çš„å†…å­˜ç¢ç‰‡ï¼Œç©ºé—´ç¢ç‰‡å¤ªå¤šå¯èƒ½ä¼šå¯¼è‡´ä»¥ååœ¨ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­éœ€è¦åˆ†é…è¾ƒå¤§å¯¹è±¡æ—¶ï¼Œæ— æ³•æ‰¾åˆ°è¶³å¤Ÿçš„è¿ç»­å†…å­˜è€Œä¸å¾—ä¸æå‰è§¦å‘å¦ä¸€æ¬¡åƒåœ¾æ”¶é›†åŠ¨ä½œã€‚\n\n#### å¤åˆ¶ç®—æ³•\nä¸ºäº†è§£å†³æ•ˆç‡é—®é¢˜ï¼Œä¸€ç§ç§°ä¸ºâ€œå¤åˆ¶â€ï¼ˆCopyingï¼‰çš„æ”¶é›†ç®—æ³•å‡ºç°äº†ï¼Œå®ƒå°†å¯ç”¨å†…å­˜æŒ‰å®¹é‡åˆ’åˆ†ä¸ºå¤§å°ç›¸ç­‰çš„ä¸¤å—ï¼Œæ¯æ¬¡åªä½¿ç”¨å…¶ä¸­çš„ä¸€å—ã€‚å½“è¿™ä¸€å—çš„å†…å­˜ç”¨å®Œäº†ï¼Œå°±å°†è¿˜å­˜æ´»ç€çš„å¯¹è±¡å¤åˆ¶åˆ°å¦å¤–ä¸€å—ä¸Šé¢ï¼Œç„¶åå†æŠŠå·²ä½¿ç”¨è¿‡çš„å†…å­˜ç©ºé—´ä¸€æ¬¡æ¸…ç†æ‰ã€‚è¿™æ ·ä½¿å¾—æ¯æ¬¡éƒ½æ˜¯å¯¹æ•´ä¸ªåŠåŒºè¿›è¡Œå†…å­˜å›æ”¶ï¼Œå†…å­˜åˆ†é…æ—¶ä¹Ÿå°±ä¸ç”¨è€ƒè™‘å†…å­˜ç¢ç‰‡ç­‰å¤æ‚æƒ…å†µï¼Œåªè¦ç§»åŠ¨å †é¡¶æŒ‡é’ˆï¼ŒæŒ‰é¡ºåºåˆ†é…å†…å­˜å³å¯ï¼Œå®ç°ç®€å•ï¼Œè¿è¡Œé«˜æ•ˆã€‚åªæ˜¯è¿™ç§ç®—æ³•çš„ä»£ä»·æ˜¯å°†å†…å­˜ç¼©å°ä¸ºäº†åŸæ¥çš„ä¸€åŠï¼Œæœªå…å¤ªé«˜äº†ä¸€ç‚¹ã€‚\n\n#### æ ‡è®°-æ•´ç†ç®—æ³•\nå¤åˆ¶æ”¶é›†ç®—æ³•åœ¨å¯¹è±¡å­˜æ´»ç‡è¾ƒé«˜æ—¶å°±è¦è¿›è¡Œè¾ƒå¤šçš„å¤åˆ¶æ“ä½œï¼Œæ•ˆç‡å°†ä¼šå˜ä½ã€‚æ›´å…³é”®çš„æ˜¯ï¼Œå¦‚æœä¸æƒ³æµªè´¹50%çš„ç©ºé—´ï¼Œå°±éœ€è¦æœ‰é¢å¤–çš„ç©ºé—´è¿›è¡Œåˆ†é…æ‹…ä¿ï¼Œä»¥åº”å¯¹è¢«ä½¿ç”¨çš„å†…å­˜ä¸­æ‰€æœ‰å¯¹è±¡éƒ½100%å­˜æ´»çš„æç«¯æƒ…å†µï¼Œæ‰€ä»¥åœ¨è€å¹´ä»£ä¸€èˆ¬ä¸èƒ½ç›´æ¥é€‰ç”¨è¿™ç§ç®—æ³•ã€‚\n\næ ¹æ®è€å¹´ä»£çš„ç‰¹ç‚¹ï¼Œæœ‰äººæå‡ºäº†å¦å¤–ä¸€ç§â€œæ ‡è®°-æ•´ç†â€ï¼ˆMark-Compactï¼‰ç®—æ³•ï¼Œæ ‡è®°è¿‡ç¨‹ä»ç„¶ä¸â€œæ ‡è®°-æ¸…é™¤â€ç®—æ³•ä¸€æ ·ï¼Œä½†åç»­æ­¥éª¤ä¸æ˜¯ç›´æ¥å¯¹å¯å›æ”¶å¯¹è±¡è¿›è¡Œæ¸…ç†ï¼Œè€Œæ˜¯è®©æ‰€æœ‰å­˜æ´»çš„å¯¹è±¡éƒ½å‘ä¸€ç«¯ç§»åŠ¨ï¼Œç„¶åç›´æ¥æ¸…ç†æ‰ç«¯è¾¹ç•Œä»¥å¤–çš„å†…å­˜ã€‚\n\n#### åˆ†ä»£æ”¶é›†ç®—æ³•\nå½“å‰å•†ä¸šè™šæ‹Ÿæœºçš„åƒåœ¾æ”¶é›†éƒ½é‡‡ç”¨â€œåˆ†ä»£æ”¶é›†â€ï¼ˆGenerational Collectionï¼‰ç®—æ³•ï¼Œè¿™ç§ç®—æ³•å¹¶æ²¡æœ‰ä»€ä¹ˆæ–°çš„æ€æƒ³ï¼Œåªæ˜¯æ ¹æ®å¯¹è±¡å­˜æ´»å‘¨æœŸçš„ä¸åŒå°†å†…å­˜åˆ’åˆ†ä¸ºå‡ å—ã€‚ä¸€èˆ¬æ˜¯æŠŠJavaå †åˆ†ä¸ºæ–°ç”Ÿä»£å’Œè€å¹´ä»£ï¼Œè¿™æ ·å°±å¯ä»¥æ ¹æ®å„ä¸ªå¹´ä»£çš„ç‰¹ç‚¹é‡‡ç”¨æœ€é€‚å½“çš„æ”¶é›†ç®—æ³•ã€‚åœ¨æ–°ç”Ÿä»£ä¸­ï¼Œæ¯æ¬¡åƒåœ¾æ”¶é›†æ—¶éƒ½å‘ç°æœ‰å¤§æ‰¹å¯¹è±¡æ­»å»ï¼Œåªæœ‰å°‘é‡å­˜æ´»ï¼Œé‚£å°±é€‰ç”¨å¤åˆ¶ç®—æ³•ï¼Œåªéœ€è¦ä»˜å‡ºå°‘é‡å­˜æ´»å¯¹è±¡çš„å¤åˆ¶æˆæœ¬å°±å¯ä»¥å®Œæˆæ”¶é›†ã€‚è€Œè€å¹´ä»£ä¸­å› ä¸ºå¯¹è±¡å­˜æ´»ç‡é«˜ã€æ²¡æœ‰é¢å¤–ç©ºé—´å¯¹å®ƒè¿›è¡Œåˆ†é…æ‹…ä¿ï¼Œå°±å¿…é¡»ä½¿ç”¨â€œæ ‡è®°â€”æ¸…ç†â€æˆ–è€…â€œæ ‡è®°â€”æ•´ç†â€ç®—æ³•æ¥è¿›è¡Œå›æ”¶ã€‚\n\n--------------------------\nå‚è€ƒèµ„æ–™ï¼šã€Šæ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºï¼šJVMé«˜çº§ç‰¹æ€§ä¸æœ€ä½³å®è·µã€‹","tags":["java"]},{"title":"é€šè¿‡ä¾‹å­ç†è§£mysqläº‹åŠ¡çš„4ç§éš”ç¦»çº§åˆ«","url":"/posts/1528164495/","content":"SQLæ ‡å‡†å®šä¹‰äº†4ç§éš”ç¦»çº§åˆ«ï¼ŒåŒ…æ‹¬äº†ä¸€äº›å…·ä½“è§„åˆ™ï¼Œç”¨æ¥é™å®šäº‹åŠ¡å†…å¤–çš„å“ªäº›æ”¹å˜æ˜¯å¯è§çš„ï¼Œå“ªäº›æ˜¯ä¸å¯è§çš„ã€‚\n\nä½çº§åˆ«çš„éš”ç¦»çº§ä¸€èˆ¬æ”¯æŒæ›´é«˜çš„å¹¶å‘å¤„ç†ï¼Œå¹¶æ‹¥æœ‰æ›´ä½çš„ç³»ç»Ÿå¼€é”€ã€‚\n\né¦–å…ˆï¼Œæˆ‘ä»¬ä½¿ç”¨ test æ•°æ®åº“ï¼Œæ–°å»º tx è¡¨ã€‚\n\n### ç¬¬1çº§åˆ«ï¼šRead Uncommitted(è¯»å–æœªæäº¤å†…å®¹)\n(1)æ‰€æœ‰äº‹åŠ¡éƒ½å¯ä»¥çœ‹åˆ°å…¶ä»–æœªæäº¤äº‹åŠ¡çš„æ‰§è¡Œç»“æœ  \n(2)æœ¬éš”ç¦»çº§åˆ«å¾ˆå°‘ç”¨äºå®é™…åº”ç”¨ï¼Œå› ä¸ºå®ƒçš„æ€§èƒ½ä¹Ÿä¸æ¯”å…¶ä»–çº§åˆ«å¥½å¤šå°‘  \n(3)è¯¥çº§åˆ«å¼•å‘çš„é—®é¢˜æ˜¯â€”â€”è„è¯»(**Dirty Read**)ï¼šè¯»å–åˆ°äº†æœªæäº¤çš„æ•°æ®\n```\n#é¦–å…ˆï¼Œä¿®æ”¹éš”ç¦»çº§åˆ«\nset tx_isolation='READ-UNCOMMITTED';\nselect @@tx_isolation;\n+------------------+\n| @@tx_isolation   |\n+------------------+\n| READ-UNCOMMITTED |\n+------------------+\n\n#äº‹åŠ¡Aï¼šå¯åŠ¨ä¸€ä¸ªäº‹åŠ¡\nstart transaction;\nselect * from tx;\n+------+------+\n| id   | num  |\n+------+------+\n|    1 |    1 |\n|    2 |    2 |\n|    3 |    3 |\n+------+------+\n\n#äº‹åŠ¡Bï¼šä¹Ÿå¯åŠ¨ä¸€ä¸ªäº‹åŠ¡(é‚£ä¹ˆä¸¤ä¸ªäº‹åŠ¡äº¤å‰äº†)\n       åœ¨äº‹åŠ¡Bä¸­æ‰§è¡Œæ›´æ–°è¯­å¥ï¼Œä¸”ä¸æäº¤\nstart transaction;\nupdate tx set num=10 where id=1;\nselect * from tx;\n+------+------+\n| id   | num  |\n+------+------+\n|    1 |   10 |\n|    2 |    2 |\n|    3 |    3 |\n+------+------+\n\n#äº‹åŠ¡Aï¼šé‚£ä¹ˆè¿™æ—¶å€™äº‹åŠ¡Aèƒ½çœ‹åˆ°è¿™ä¸ªæ›´æ–°äº†çš„æ•°æ®å—?\nselect * from tx;\n+------+------+\n| id   | num  |\n+------+------+\n|    1 |   10 |   --->å¯ä»¥çœ‹åˆ°ï¼è¯´æ˜æˆ‘ä»¬è¯»åˆ°äº†äº‹åŠ¡Bè¿˜æ²¡æœ‰æäº¤çš„æ•°æ®\n|    2 |    2 |\n|    3 |    3 |\n+------+------+\n\n#äº‹åŠ¡Bï¼šäº‹åŠ¡Bå›æ»š,ä»ç„¶æœªæäº¤\nrollback;\nselect * from tx;\n+------+------+\n| id   | num  |\n+------+------+\n|    1 |    1 |\n|    2 |    2 |\n|    3 |    3 |\n+------+------+\n\n#äº‹åŠ¡Aï¼šåœ¨äº‹åŠ¡Aé‡Œé¢çœ‹åˆ°çš„ä¹Ÿæ˜¯Bæ²¡æœ‰æäº¤çš„æ•°æ®\nselect * from tx;\n+------+------+\n| id   | num  |\n+------+------+\n|    1 |    1 |      --->è„è¯»æ„å‘³ç€æˆ‘åœ¨è¿™ä¸ªäº‹åŠ¡ä¸­(Aä¸­)ï¼Œäº‹åŠ¡Bè™½ç„¶æ²¡æœ‰æäº¤ï¼Œä½†å®ƒä»»ä½•ä¸€æ¡æ•°æ®å˜åŒ–ï¼Œæˆ‘éƒ½å¯ä»¥çœ‹åˆ°ï¼\n|    2 |    2 |\n|    3 |    3 |\n+------+------+\n```\n-------------------------------------\n### ç¬¬2çº§åˆ«ï¼šRead Committed(è¯»å–æäº¤å†…å®¹)\n(1)è¿™æ˜¯å¤§å¤šæ•°æ•°æ®åº“ç³»ç»Ÿçš„é»˜è®¤éš”ç¦»çº§åˆ«ï¼ˆä½†ä¸æ˜¯MySQLé»˜è®¤çš„ï¼‰  \n(2)å®ƒæ»¡è¶³äº†éš”ç¦»çš„ç®€å•å®šä¹‰ï¼šä¸€ä¸ªäº‹åŠ¡åªèƒ½çœ‹è§å·²ç»æäº¤äº‹åŠ¡æ‰€åšçš„æ”¹å˜  \n(3)è¿™ç§éš”ç¦»çº§åˆ«å‡ºç°çš„é—®é¢˜æ˜¯â€”â€”ä¸å¯é‡å¤è¯»(Nonrepeatable Read)ï¼šä¸å¯é‡å¤è¯»æ„å‘³ç€æˆ‘ä»¬åœ¨åŒä¸€ä¸ªäº‹åŠ¡ä¸­æ‰§è¡Œå®Œå…¨ç›¸åŒçš„selectè¯­å¥æ—¶å¯èƒ½çœ‹åˆ°ä¸ä¸€æ ·çš„ç»“æœã€‚  \n|â€”â€”>å¯¼è‡´è¿™ç§æƒ…å†µçš„åŸå› å¯èƒ½æœ‰ï¼š\n1. æœ‰ä¸€ä¸ªäº¤å‰çš„äº‹åŠ¡æœ‰æ–°çš„commitï¼Œå¯¼è‡´äº†æ•°æ®çš„æ”¹å˜  \n2. ä¸€ä¸ªæ•°æ®åº“è¢«å¤šä¸ªå®ä¾‹æ“ä½œæ—¶,åŒä¸€äº‹åŠ¡çš„å…¶ä»–å®ä¾‹åœ¨è¯¥å®ä¾‹å¤„ç†å…¶é—´å¯èƒ½ä¼šæœ‰æ–°çš„commit\n```\n#é¦–å…ˆä¿®æ”¹éš”ç¦»çº§åˆ«\nset tx_isolation='read-committed';\nselect @@tx_isolation;\n+----------------+\n| @@tx_isolation |\n+----------------+\n| READ-COMMITTED |\n+----------------+\n\n#äº‹åŠ¡Aï¼šå¯åŠ¨ä¸€ä¸ªäº‹åŠ¡\nstart transaction;\nselect * from tx;\n+------+------+\n| id   | num  |\n+------+------+\n|    1 |    1 |\n|    2 |    2 |\n|    3 |    3 |\n+------+------+\n\n#äº‹åŠ¡Bï¼šä¹Ÿå¯åŠ¨ä¸€ä¸ªäº‹åŠ¡(é‚£ä¹ˆä¸¤ä¸ªäº‹åŠ¡äº¤å‰äº†)\n       åœ¨è¿™äº‹åŠ¡ä¸­æ›´æ–°æ•°æ®ï¼Œä¸”æœªæäº¤\nstart transaction;\nupdate tx set num=10 where id=1;\nselect * from tx;\n+------+------+\n| id   | num  |\n+------+------+\n|    1 |   10 |\n|    2 |    2 |\n|    3 |    3 |\n+------+------+\n\n#äº‹åŠ¡Aï¼šè¿™ä¸ªæ—¶å€™æˆ‘ä»¬åœ¨äº‹åŠ¡Aä¸­èƒ½çœ‹åˆ°æ•°æ®çš„å˜åŒ–å—?\nselect * from tx; --------------->\n+------+------+                |\n| id   | num  |                |\n+------+------+                |\n|    1 |    1 |--->å¹¶ä¸èƒ½çœ‹åˆ°ï¼  |\n|    2 |    2 |                |\n|    3 |    3 |                |\n+------+------+                |â€”â€”>ç›¸åŒçš„selectè¯­å¥ï¼Œç»“æœå´ä¸ä¸€æ ·\n                               |\n#äº‹åŠ¡Bï¼šå¦‚æœæäº¤äº†äº‹åŠ¡Bå‘¢?         |\ncommit;                        |\n                               |\n#äº‹åŠ¡A:                         |\nselect * from tx; --------------->\n+------+------+\n| id   | num  |\n+------+------+\n|    1 |   10 |--->å› ä¸ºäº‹åŠ¡Bå·²ç»æäº¤äº†ï¼Œæ‰€ä»¥åœ¨Aä¸­æˆ‘ä»¬çœ‹åˆ°äº†æ•°æ®å˜åŒ–\n|    2 |    2 |\n|    3 |    3 |\n+------+------+\n```\n-------------------------------------\n### ç¬¬3çº§åˆ«ï¼šRepeatable Read(å¯é‡è¯»)\n(1)è¿™æ˜¯MySQLçš„é»˜è®¤äº‹åŠ¡éš”ç¦»çº§åˆ«  \n(2)å®ƒç¡®ä¿åŒä¸€äº‹åŠ¡çš„å¤šä¸ªå®ä¾‹åœ¨å¹¶å‘è¯»å–æ•°æ®æ—¶ï¼Œä¼šçœ‹åˆ°åŒæ ·çš„æ•°æ®è¡Œ  \n(3)æ­¤çº§åˆ«å¯èƒ½å‡ºç°çš„é—®é¢˜â€”â€”å¹»è¯»(Phantom Read)ï¼šå½“ç”¨æˆ·è¯»å–æŸä¸€èŒƒå›´çš„æ•°æ®è¡Œæ—¶ï¼Œå¦ä¸€ä¸ªäº‹åŠ¡åˆåœ¨è¯¥èŒƒå›´å†…æ’å…¥äº†æ–°è¡Œï¼Œå½“ç”¨æˆ·å†è¯»å–è¯¥èŒƒå›´çš„æ•°æ®è¡Œæ—¶ï¼Œä¼šå‘ç°æœ‰æ–°çš„â€œå¹»å½±â€ è¡Œ  \n(4)InnoDBå’ŒFalconå­˜å‚¨å¼•æ“é€šè¿‡å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶(MVCCï¼ŒMultiversion Concurrency Control)æœºåˆ¶è§£å†³äº†è¯¥é—®é¢˜\n```\n#é¦–å…ˆï¼Œæ›´æ”¹éš”ç¦»çº§åˆ«\nset tx_isolation='repeatable-read';\nselect @@tx_isolation;\n+-----------------+\n| @@tx_isolation  |\n+-----------------+\n| REPEATABLE-READ |\n+-----------------+\n\n#äº‹åŠ¡Aï¼šå¯åŠ¨ä¸€ä¸ªäº‹åŠ¡\nstart transaction;\nselect * from tx;\n+------+------+\n| id   | num  |\n+------+------+\n|    1 |    1 |\n|    2 |    2 |\n|    3 |    3 |\n+------+------+\n\n#äº‹åŠ¡Bï¼šå¼€å¯ä¸€ä¸ªæ–°äº‹åŠ¡(é‚£ä¹ˆè¿™ä¸¤ä¸ªäº‹åŠ¡äº¤å‰äº†)\n       åœ¨äº‹åŠ¡Bä¸­æ›´æ–°æ•°æ®ï¼Œå¹¶æäº¤\nstart transaction;\nupdate tx set num=10 where id=1;\nselect * from tx;\n+------+------+\n| id   | num  |\n+------+------+\n|    1 |   10 |\n|    2 |    2 |\n|    3 |    3 |\n+------+------+\ncommit;\n\n#äº‹åŠ¡Aï¼šè¿™æ—¶å€™å³ä½¿äº‹åŠ¡Bå·²ç»æäº¤äº†,ä½†Aèƒ½ä¸èƒ½çœ‹åˆ°æ•°æ®å˜åŒ–ï¼Ÿ\nselect * from tx;\n+------+------+\n| id   | num  |\n+------+------+\n|    1 |    1 | --->è¿˜æ˜¯çœ‹ä¸åˆ°çš„ï¼(è¿™ä¸ªçº§åˆ«2ä¸ä¸€æ ·ï¼Œä¹Ÿè¯´æ˜çº§åˆ«3è§£å†³äº†ä¸å¯é‡å¤è¯»é—®é¢˜)\n|    2 |    2 |\n|    3 |    3 |\n+------+------+\n\n#äº‹åŠ¡Aï¼šåªæœ‰å½“äº‹åŠ¡Aä¹Ÿæäº¤äº†ï¼Œå®ƒæ‰èƒ½å¤Ÿçœ‹åˆ°æ•°æ®å˜åŒ–\ncommit;\nselect * from tx;\n+------+------+\n| id   | num  |\n+------+------+\n|    1 |   10 |\n|    2 |    2 |\n|    3 |    3 |\n+------+------+\n```\n-------------------------------------\n### ç¬¬4çº§åˆ«ï¼šSerializable(å¯ä¸²è¡ŒåŒ–)\n(1)è¿™æ˜¯æœ€é«˜çš„éš”ç¦»çº§åˆ«  \n(2)å®ƒé€šè¿‡å¼ºåˆ¶äº‹åŠ¡æ’åºï¼Œä½¿ä¹‹ä¸å¯èƒ½ç›¸äº’å†²çªï¼Œä»è€Œè§£å†³å¹»è¯»é—®é¢˜ã€‚ç®€è¨€ä¹‹,å®ƒæ˜¯åœ¨æ¯ä¸ªè¯»çš„æ•°æ®è¡Œä¸ŠåŠ ä¸Šå…±äº«é”ã€‚  \n(3)åœ¨è¿™ä¸ªçº§åˆ«ï¼Œå¯èƒ½å¯¼è‡´å¤§é‡çš„è¶…æ—¶ç°è±¡å’Œé”ç«äº‰\n```\n#é¦–å…ˆä¿®æ”¹éš”ç¦»ç•Œåˆ«\nset tx_isolation='serializable';\nselect @@tx_isolation;\n+----------------+\n| @@tx_isolation |\n+----------------+\n| SERIALIZABLE   |\n+----------------+\n\n#äº‹åŠ¡Aï¼šå¼€å¯ä¸€ä¸ªæ–°äº‹åŠ¡\nstart transaction;\n\n#äº‹åŠ¡Bï¼šåœ¨Aæ²¡æœ‰commitä¹‹å‰ï¼Œè¿™ä¸ªäº¤å‰äº‹åŠ¡æ˜¯ä¸èƒ½æ›´æ”¹æ•°æ®çš„\nstart transaction;\ninsert tx values('4','4');\nERROR 1205 (HY000): Lock wait timeout exceeded; try restarting transaction\nupdate tx set num=10 where id=1;\nERROR 1205 (HY000): Lock wait timeout exceeded; try restarting transaction\n```\n-------------------------------------\n| éš”ç¦»çº§åˆ«                      | è„è¯» | ä¸å¯é‡å¤è¯» | å¹»è¯» |\n| - | :-: | :-: | :-: |\n| è¯»æœªæäº¤ ( Read uncommitted ) | âœ“ | âœ“ | âœ“ |\n| è¯»å·²æäº¤ ( Read committed )   | Ã— | âœ“ | âœ“ |\n| å¯é‡å¤è¯» ( Repeatable read )  | Ã— | Ã— | âœ“ |\n| å¯ä¸²è¡ŒåŒ– ( Serializable )     | Ã— | Ã— | Ã— |\n\nå‚è€ƒæ–‡ç« \nhttp://xm-king.iteye.com/blog/770721\n\nè½¬è‡ªï¼šhttp://www.cnblogs.com/snsdzjlz320/p/5761387.html","tags":["mysql"]},{"title":"çº¿ä¸Šä»£ç å’Œrpc debugå“ªå®¶å¼º","url":"/posts/1528164505/","content":"æ ‡é¢˜ä¸¤ç§æƒ…å†µï¼Œé™¤äº†çœ‹æ—¥å¿—å¤–ï¼Œè¿˜æœ‰ä¸€ç§åšæ³•æ˜¯åšä¸€ç§è½¬å‘å™¨ï¼ŒæŠŠæ–­ç‚¹è¾“å‡ºè½¬å‘åˆ°ç¨‹åºå‘˜è¿™è¾¹ã€‚è¿™ç¯‡æ–‡ç« å®‰åˆ©ä¸‹æˆ‘åšçš„è½¬å‘å™¨ [rebugger](https://github.com/questionlin/rebugger)ã€‚\n\nrebugger çš„åŸç†æ˜¯ç”¨ WorkerMan åšä¸€ä¸ªä¸­è½¬ç«™ï¼ŒæœåŠ¡å™¨é€šè¿‡ http è¯·æ±‚å‘ä¸­å‘å‡ºæ¶ˆæ¯ï¼Œä¸­è½¬ç«™æå–å‡ºå†…å®¹ï¼Œè½¬å‘åˆ°ç¨‹åºå‘˜è¿™è¾¹çš„ telnet \bå®¢æˆ·ç«¯ã€‚ä¾‹å¦‚ PHP æœåŠ¡å™¨ï¼Œç¨‹åºåªè¦æ‰§è¡Œ file_get_contents() å°±èƒ½æŠŠæ¶ˆæ¯å‘å‡ºå»äº†ã€‚\n\nä½¿ç”¨ rebugger \bçš„ä¼˜ç‚¹æ˜¯ file_get_contents() ä¸€ä¸ªå‡½æ•°å°±æŠŠæ¶ˆæ¯å‘å‡ºå»äº†ï¼Œè½»ä¾¿æ— ä¾èµ–ã€‚ç¼ºç‚¹æ˜¯ get è¯·æ±‚ä¸èƒ½æœ‰ç‰¹æ®Šå­—ç¬¦ï¼Œç‰¹æ®Šæƒ…å†µéœ€è¦è½¬ä¹‰ä¸€ä¸‹ã€‚æ›´é‡çš„åšæ³•æ˜¯åšä¸€ä¸ªæ’ä»¶ï¼Œç¨‹åºå¼•å…¥åå¯ä»¥æœ‰ä¸€ä¸ªæ¥å£ï¼Œç›´æ¥å‘é€ socket è¯·æ±‚ç»™telnet å®¢æˆ·ç«¯ã€‚ä¸è¿‡ rebugger åº”è¯¥å·²ç»èƒ½æ»¡è¶³å¤§éƒ¨åˆ† php ç¨‹åºå‘˜çš„éœ€æ±‚äº†ã€‚","tags":["å®‰åˆ©"]},{"title":"select poll epoll ä¹‹é—´çš„åŒºåˆ«","url":"/posts/1528164527/","content":"selectï¼Œpollï¼Œepolléƒ½æ˜¯IOå¤šè·¯å¤ç”¨çš„æœºåˆ¶ã€‚I/Oå¤šè·¯å¤ç”¨å°±é€šè¿‡ä¸€ç§æœºåˆ¶ï¼Œå¯ä»¥ç›‘è§†å¤šä¸ªæè¿°ç¬¦ï¼Œä¸€æ—¦æŸä¸ªæè¿°ç¬¦å°±ç»ªï¼ˆä¸€èˆ¬æ˜¯è¯»å°±ç»ªæˆ–è€…å†™å°±ç»ªï¼‰ï¼Œèƒ½å¤Ÿé€šçŸ¥ç¨‹åºè¿›è¡Œç›¸åº”çš„è¯»å†™æ“ä½œã€‚**ä½†selectï¼Œpollï¼Œepollæœ¬è´¨ä¸Šéƒ½æ˜¯åŒæ­¥I/Oï¼Œå› ä¸ºä»–ä»¬éƒ½éœ€è¦åœ¨è¯»å†™äº‹ä»¶å°±ç»ªåè‡ªå·±è´Ÿè´£è¿›è¡Œè¯»å†™ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™ä¸ªè¯»å†™è¿‡ç¨‹æ˜¯é˜»å¡çš„**ï¼Œè€Œå¼‚æ­¥I/Oåˆ™æ— éœ€è‡ªå·±è´Ÿè´£è¿›è¡Œè¯»å†™ï¼Œå¼‚æ­¥I/Oçš„å®ç°ä¼šè´Ÿè´£æŠŠæ•°æ®ä»å†…æ ¸æ‹·è´åˆ°ç”¨æˆ·ç©ºé—´ã€‚\n\nä»Šå¤©å¯¹è¿™ä¸‰ç§IOå¤šè·¯å¤ç”¨è¿›è¡Œå¯¹æ¯”ï¼Œå‚è€ƒç½‘ä¸Šå’Œä¹¦ä¸Šé¢çš„èµ„æ–™ï¼Œæ•´ç†å¦‚ä¸‹ï¼š\n\n### 1. select å®ç°\nselect çš„è°ƒç”¨è¿‡ç¨‹å¦‚ä¸‹æ‰€ç¤ºï¼š  \n![è¿‡ç¨‹å›¾](http://wx4.sinaimg.cn/large/726f09bbgy1frycff5ubgj20hk0a8q34.jpg)\n1. ä½¿ç”¨ copy_from_user ä»ç”¨æˆ·æ§ä»¶æ‹·è´ fd_set åˆ°å†…æ ¸ç©ºé—´\n2. æ³¨å†Œå›è°ƒå‡½æ•° __pollwait\n3. éå†æ‰€æœ‰ fdï¼Œè°ƒç”¨å…¶å¯¹åº”çš„ poll æ–¹æ³•ï¼ˆå¯¹äº socketï¼Œ è¿™ä¸ª poll æ–¹æ³•æ˜¯ sock_pollï¼Œ sock_poll \bæ ¹æ®æƒ…å†µä¼šè°ƒç”¨åˆ° tcp_poll, udp_poll æˆ–è€… datagram_poll)\n4. ä»¥ tcp_poll ä¸ºä¾‹ï¼Œå…¶æ ¸å¿ƒæ—¶é—´å°±æ˜¯ __pollwaitï¼Œä¹Ÿå°±æ˜¯ä¸Šé¢æ³¨å†Œçš„å›è°ƒå‡½æ•°ã€‚\n5. __pollwaitçš„ä¸»è¦å·¥ä½œå°±æ˜¯æŠŠcurrentï¼ˆå½“å‰è¿›ç¨‹ï¼‰æŒ‚åˆ°è®¾å¤‡çš„ç­‰å¾…é˜Ÿåˆ—ä¸­ï¼Œä¸åŒçš„è®¾å¤‡æœ‰ä¸åŒçš„ç­‰å¾…é˜Ÿåˆ—ï¼Œå¯¹äºtcp_pollæ¥è¯´ï¼Œå…¶ç­‰å¾…é˜Ÿåˆ—æ˜¯sk->sk_sleepï¼ˆæ³¨æ„æŠŠè¿›ç¨‹æŒ‚åˆ°ç­‰å¾…é˜Ÿåˆ—ä¸­å¹¶ä¸ä»£è¡¨è¿›ç¨‹å·²ç»ç¡çœ äº†ï¼‰ã€‚åœ¨è®¾å¤‡æ”¶åˆ°ä¸€æ¡æ¶ˆæ¯ï¼ˆç½‘ç»œè®¾å¤‡ï¼‰æˆ–å¡«å†™å®Œæ–‡ä»¶æ•°æ®ï¼ˆç£ç›˜è®¾å¤‡ï¼‰åï¼Œä¼šå”¤é†’è®¾å¤‡ç­‰å¾…é˜Ÿåˆ—ä¸Šç¡çœ çš„è¿›ç¨‹ï¼Œè¿™æ—¶currentä¾¿è¢«å”¤é†’äº†ã€‚\n6. pollæ–¹æ³•è¿”å›æ—¶ä¼šè¿”å›ä¸€ä¸ªæè¿°è¯»å†™æ“ä½œæ˜¯å¦å°±ç»ªçš„maskæ©ç ï¼Œæ ¹æ®è¿™ä¸ªmaskæ©ç ç»™fd_setèµ‹å€¼ã€‚\n7. å¦‚æœéå†å®Œæ‰€æœ‰çš„fdï¼Œè¿˜æ²¡æœ‰è¿”å›ä¸€ä¸ªå¯è¯»å†™çš„maskæ©ç ï¼Œåˆ™ä¼šè°ƒç”¨schedule_timeoutæ˜¯è°ƒç”¨selectçš„è¿›ç¨‹ï¼ˆä¹Ÿå°±æ˜¯currentï¼‰è¿›å…¥ç¡çœ ã€‚å½“è®¾å¤‡é©±åŠ¨å‘ç”Ÿè‡ªèº«èµ„æºå¯è¯»å†™åï¼Œä¼šå”¤é†’å…¶ç­‰å¾…é˜Ÿåˆ—ä¸Šç¡çœ çš„è¿›ç¨‹ã€‚å¦‚æœè¶…è¿‡ä¸€å®šçš„è¶…æ—¶æ—¶é—´ï¼ˆschedule_timeoutæŒ‡å®šï¼‰ï¼Œè¿˜æ˜¯æ²¡äººå”¤é†’ï¼Œåˆ™è°ƒç”¨selectçš„è¿›ç¨‹ä¼šé‡æ–°è¢«å”¤é†’è·å¾—CPUï¼Œè¿›è€Œé‡æ–°éå†fdï¼Œåˆ¤æ–­æœ‰æ²¡æœ‰å°±ç»ªçš„fdã€‚\n8. æŠŠfd_setä»å†…æ ¸ç©ºé—´æ‹·è´åˆ°ç”¨æˆ·ç©ºé—´ã€‚\n\n### æ€»ç»“\nselectçš„å‡ å¤§ç¼ºç‚¹ï¼š\n\nï¼ˆ1ï¼‰æ¯æ¬¡è°ƒç”¨selectï¼Œéƒ½éœ€è¦æŠŠfdé›†åˆä»ç”¨æˆ·æ€æ‹·è´åˆ°å†…æ ¸æ€ï¼Œè¿™ä¸ªå¼€é”€åœ¨fdå¾ˆå¤šæ—¶ä¼šå¾ˆå¤§\n\nï¼ˆ2ï¼‰åŒæ—¶æ¯æ¬¡è°ƒç”¨selectéƒ½éœ€è¦åœ¨å†…æ ¸éå†ä¼ é€’è¿›æ¥çš„æ‰€æœ‰fdï¼Œè¿™ä¸ªå¼€é”€åœ¨fdå¾ˆå¤šæ—¶ä¹Ÿå¾ˆå¤§\n\nï¼ˆ3ï¼‰selectæ”¯æŒçš„æ–‡ä»¶æè¿°ç¬¦æ•°é‡å¤ªå°äº†ï¼Œé»˜è®¤æ˜¯1024\n\nï¼ˆ4ï¼‰ä½ ä¸èƒ½åœ¨ç­‰å¾…çš„æ—¶å€™ä¿®æ”¹æè¿°ç¬¦é›†\n\n### 2. poll å®ç°\npollçš„å®ç°å’Œselectéå¸¸ç›¸ä¼¼ï¼Œåªæ˜¯æè¿°fdé›†åˆçš„æ–¹å¼ä¸åŒï¼Œpollä½¿ç”¨pollfdç»“æ„è€Œä¸æ˜¯selectçš„fd_setç»“æ„ï¼Œæ²¡æœ‰å¤§å°é™åˆ¶ï¼Œå…¶ä»–çš„éƒ½å·®ä¸å¤šã€‚\n\nå…³äºselectå’Œpollçš„å®ç°åˆ†æï¼Œå¯ä»¥å‚è€ƒä¸‹é¢å‡ ç¯‡åšæ–‡ï¼š\n\nhttp://blog.csdn.net/lizhiguo0532/article/details/6568964#comments\n\nhttp://blog.csdn.net/lizhiguo0532/article/details/6568968\n\nhttp://blog.csdn.net/lizhiguo0532/article/details/6568969\n\nhttp://www.ibm.com/developerworks/cn/linux/l-cn-edntwk/index.html?ca=drs-\n\nhttp://linux.chinaunix.net/techdoc/net/2009/05/03/1109887.shtml\n\n### 3. epoll\nepollæ—¢ç„¶æ˜¯å¯¹selectå’Œpollçš„æ”¹è¿›ï¼Œå°±åº”è¯¥èƒ½é¿å…ä¸Šè¿°çš„ä¸‰ä¸ªç¼ºç‚¹ã€‚é‚£epolléƒ½æ˜¯æ€ä¹ˆè§£å†³çš„å‘¢ï¼Ÿåœ¨æ­¤ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆçœ‹ä¸€ä¸‹epollå’Œselectå’Œpollçš„è°ƒç”¨æ¥å£ä¸Šçš„ä¸åŒï¼Œselectå’Œpolléƒ½åªæä¾›äº†ä¸€ä¸ªå‡½æ•°â€”â€”selectæˆ–è€…pollå‡½æ•°ã€‚è€Œepollæä¾›äº†ä¸‰ä¸ªå‡½æ•°ï¼Œepoll_create,epoll_ctlå’Œepoll_waitï¼Œepoll_createæ˜¯åˆ›å»ºä¸€ä¸ªepollå¥æŸ„ï¼›epoll_ctlæ˜¯æ³¨å†Œè¦ç›‘å¬çš„äº‹ä»¶ç±»å‹ï¼›epoll_waitåˆ™æ˜¯ç­‰å¾…äº‹ä»¶çš„äº§ç”Ÿã€‚\n\nå¯¹äºç¬¬ä¸€ä¸ªç¼ºç‚¹ï¼Œepollçš„è§£å†³æ–¹æ¡ˆåœ¨epoll_ctlå‡½æ•°ä¸­ã€‚æ¯æ¬¡æ³¨å†Œæ–°çš„äº‹ä»¶åˆ°epollå¥æŸ„ä¸­æ—¶ï¼ˆåœ¨epoll_ctlä¸­æŒ‡å®šEPOLL_CTL_ADDï¼‰ï¼Œä¼šæŠŠæ‰€æœ‰çš„fdæ‹·è´è¿›å†…æ ¸ï¼Œè€Œä¸æ˜¯åœ¨epoll_waitçš„æ—¶å€™é‡å¤æ‹·è´ã€‚epollä¿è¯äº†æ¯ä¸ªfdåœ¨æ•´ä¸ªè¿‡ç¨‹ä¸­åªä¼šæ‹·è´ä¸€æ¬¡ã€‚\n\nå¯¹äºç¬¬äºŒä¸ªç¼ºç‚¹ï¼Œepollçš„è§£å†³æ–¹æ¡ˆä¸åƒselectæˆ–pollä¸€æ ·æ¯æ¬¡éƒ½æŠŠcurrentè½®æµåŠ å…¥fdå¯¹åº”çš„è®¾å¤‡ç­‰å¾…é˜Ÿåˆ—ä¸­ï¼Œè€Œåªåœ¨epoll_ctlæ—¶æŠŠcurrentæŒ‚ä¸€éï¼ˆè¿™ä¸€éå¿…ä¸å¯å°‘ï¼‰å¹¶ä¸ºæ¯ä¸ªfdæŒ‡å®šä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œå½“è®¾å¤‡å°±ç»ªï¼Œå”¤é†’ç­‰å¾…é˜Ÿåˆ—ä¸Šçš„ç­‰å¾…è€…æ—¶ï¼Œå°±ä¼šè°ƒç”¨è¿™ä¸ªå›è°ƒå‡½æ•°ï¼Œè€Œè¿™ä¸ªå›è°ƒå‡½æ•°ä¼šæŠŠå°±ç»ªçš„fdåŠ å…¥ä¸€ä¸ªå°±ç»ªé“¾è¡¨ï¼‰ã€‚epoll_waitçš„å·¥ä½œå®é™…ä¸Šå°±æ˜¯åœ¨è¿™ä¸ªå°±ç»ªé“¾è¡¨ä¸­æŸ¥çœ‹æœ‰æ²¡æœ‰å°±ç»ªçš„fdï¼ˆåˆ©ç”¨schedule_timeout()å®ç°ç¡ä¸€ä¼šï¼Œåˆ¤æ–­ä¸€ä¼šçš„æ•ˆæœï¼Œå’Œselectå®ç°ä¸­çš„ç¬¬7æ­¥æ˜¯ç±»ä¼¼çš„ï¼‰ã€‚\n\nå¯¹äºç¬¬ä¸‰ä¸ªç¼ºç‚¹ï¼Œepollæ²¡æœ‰è¿™ä¸ªé™åˆ¶ï¼Œå®ƒæ‰€æ”¯æŒçš„FDä¸Šé™æ˜¯æœ€å¤§å¯ä»¥æ‰“å¼€æ–‡ä»¶çš„æ•°ç›®ï¼Œè¿™ä¸ªæ•°å­—ä¸€èˆ¬è¿œå¤§äº2048,ä¸¾ä¸ªä¾‹å­,åœ¨1GBå†…å­˜çš„æœºå™¨ä¸Šå¤§çº¦æ˜¯10ä¸‡å·¦å³ï¼Œå…·ä½“æ•°ç›®å¯ä»¥cat /proc/sys/fs/file-maxå¯Ÿçœ‹,ä¸€èˆ¬æ¥è¯´è¿™ä¸ªæ•°ç›®å’Œç³»ç»Ÿå†…å­˜å…³ç³»å¾ˆå¤§ã€‚\n\n### æ€»ç»“ï¼š\n\nï¼ˆ1ï¼‰selectï¼Œpollå®ç°éœ€è¦è‡ªå·±ä¸æ–­è½®è¯¢æ‰€æœ‰fdé›†åˆï¼Œç›´åˆ°è®¾å¤‡å°±ç»ªï¼ŒæœŸé—´å¯èƒ½è¦ç¡çœ å’Œå”¤é†’å¤šæ¬¡äº¤æ›¿ã€‚è€Œepollå…¶å®ä¹Ÿéœ€è¦è°ƒç”¨epoll_waitä¸æ–­è½®è¯¢å°±ç»ªé“¾è¡¨ï¼ŒæœŸé—´ä¹Ÿå¯èƒ½å¤šæ¬¡ç¡çœ å’Œå”¤é†’äº¤æ›¿ï¼Œä½†æ˜¯å®ƒæ˜¯è®¾å¤‡å°±ç»ªæ—¶ï¼Œè°ƒç”¨å›è°ƒå‡½æ•°ï¼ŒæŠŠå°±ç»ªfdæ”¾å…¥å°±ç»ªé“¾è¡¨ä¸­ï¼Œå¹¶å”¤é†’åœ¨epoll_waitä¸­è¿›å…¥ç¡çœ çš„è¿›ç¨‹ã€‚è™½ç„¶éƒ½è¦ç¡çœ å’Œäº¤æ›¿ï¼Œä½†æ˜¯selectå’Œpollåœ¨â€œé†’ç€â€çš„æ—¶å€™è¦éå†æ•´ä¸ªfdé›†åˆï¼Œè€Œepollåœ¨â€œé†’ç€â€çš„æ—¶å€™åªè¦åˆ¤æ–­ä¸€ä¸‹å°±ç»ªé“¾è¡¨æ˜¯å¦ä¸ºç©ºå°±è¡Œäº†ï¼Œè¿™èŠ‚çœäº†å¤§é‡çš„CPUæ—¶é—´ã€‚è¿™å°±æ˜¯å›è°ƒæœºåˆ¶å¸¦æ¥çš„æ€§èƒ½æå‡ã€‚\n\nï¼ˆ2ï¼‰selectï¼Œpollæ¯æ¬¡è°ƒç”¨éƒ½è¦æŠŠfdé›†åˆä»ç”¨æˆ·æ€å¾€å†…æ ¸æ€æ‹·è´ä¸€æ¬¡ï¼Œå¹¶ä¸”è¦æŠŠcurrentå¾€è®¾å¤‡ç­‰å¾…é˜Ÿåˆ—ä¸­æŒ‚ä¸€æ¬¡ï¼Œè€Œepollåªè¦ä¸€æ¬¡æ‹·è´ï¼Œè€Œä¸”æŠŠcurrentå¾€ç­‰å¾…é˜Ÿåˆ—ä¸ŠæŒ‚ä¹ŸåªæŒ‚ä¸€æ¬¡ï¼ˆåœ¨epoll_waitçš„å¼€å§‹ï¼Œæ³¨æ„è¿™é‡Œçš„ç­‰å¾…é˜Ÿåˆ—å¹¶ä¸æ˜¯è®¾å¤‡ç­‰å¾…é˜Ÿåˆ—ï¼Œåªæ˜¯ä¸€ä¸ªepollå†…éƒ¨å®šä¹‰çš„ç­‰å¾…é˜Ÿåˆ—ï¼‰ã€‚è¿™ä¹Ÿèƒ½èŠ‚çœä¸å°‘çš„å¼€é”€ã€‚\n\nï¼ˆ3ï¼‰å³ä½¿ä¸€ä¸ªçº¿ç¨‹å¤„åœ¨ epoll_wait \bå‡½æ•°ä¸­ï¼Œä½ ä¹Ÿå¯ä»¥éšæ—¶ä¿®æ”¹åˆ—è¡¨ã€‚\b\n\nï¼ˆ4ï¼‰å¯ä»¥é€šè¿‡ epoll_wait() ä½¿å¤šä¸ªçº¿ç¨‹åœ¨åŒä¸€ä¸ª epoll é˜Ÿåˆ—ä¸­ç­‰å¾…ï¼Œè¿™æ˜¯ select / poll æ— æ³•åšåˆ°çš„ã€‚\n\n### libevent\nlibevent æ˜¯ä¸€ä¸ªåº“ï¼Œå°†ä»¥ä¸Šçš„æ–¹æ³•å°è£…åœ¨ä¸€å¥— API ä¸­ï¼Œä½¿å¾—\båŒä¸€å¥—ä»£ç å¯ä»¥åœ¨ä¸åŒç³»ç»Ÿä¸­ä½¿ç”¨ï¼ˆ\bFreeBSD ä½¿ç”¨ kqueue)ã€‚\n\nå‚è€ƒèµ„æ–™ï¼š\n**https://www.cnblogs.com/Anker/p/3265058.html**\n\n**https://www.ulduzsoft.com/2014/01/select-poll-epoll-practical-difference-for-system-architects/**\n\nhttp://www.cnblogs.com/apprentice89/archive/2013/05/09/3070051.html\n\nhttp://www.linuxidc.com/Linux/2012-05/59873p3.htm\n\nhttp://xingyunbaijunwei.blog.163.com/blog/static/76538067201241685556302/\n\nhttp://blog.csdn.net/kkxgx/article/details/7717125\n\nhttps://banu.com/blog/2/how-to-use-epoll-a-complete-example-in-c/epoll-example.c\n\nä¸‰ç§æ–¹å¼çš„ç”¨æ³•ï¼š\n\nselect: http://www.cnblogs.com/Anker/archive/2013/08/14/3258674.html\n\npoll: http://www.cnblogs.com/Anker/archive/2013/08/15/3261006.html\n\nepoll: http://www.cnblogs.com/Anker/archive/2013/08/17/3263780.html\n"},{"title":"mysqlé…ç½®ä¸»ä»åˆ†ç¦»","url":"/posts/1528164516/","content":"åŸç†ï¼šä¸»æœåŠ¡å™¨ï¼ˆMasterï¼‰è´Ÿè´£ç½‘ç«™NonQueryæ“ä½œï¼Œä»æœåŠ¡å™¨è´Ÿè´£Queryæ“ä½œï¼Œç”¨æˆ·å¯ä»¥æ ¹æ®ç½‘ç«™åŠŸèƒ½æ¨¡ç‰¹æ€§å—å›ºå®šè®¿é—®SlaveæœåŠ¡å™¨ï¼Œæˆ–è€…è‡ªå·±å†™ä¸ªæ± æˆ–é˜Ÿåˆ—ï¼Œè‡ªç”±ä¸ºè¯·æ±‚åˆ†é…ä»æœåŠ¡å™¨è¿æ¥ã€‚ä¸»ä»æœåŠ¡å™¨åˆ©ç”¨MySQLçš„äºŒè¿›åˆ¶æ—¥å¿—æ–‡ä»¶ï¼Œå®ç°æ•°æ®åŒæ­¥ã€‚äºŒè¿›åˆ¶æ—¥å¿—ç”±ä¸»æœåŠ¡å™¨äº§ç”Ÿï¼Œä»æœåŠ¡å™¨å“åº”è·å–åŒæ­¥æ•°æ®åº“ã€‚\n\nå…·ä½“å®ç°ï¼š\n1. é…ç½® Master ä¸»æœåŠ¡å™¨\n    1. åœ¨ Master MySQL ä¸Šåˆ›å»ºç”¨æˆ·'repl'ï¼Œå¹¶å…è®¸å…¶ä»– Slave æœåŠ¡å¯ä»¥é€šè¿‡è¿œç¨‹è®¿é—® Masterï¼Œé€šè¿‡è¯¥ç”¨æˆ·è¯»å–äºŒè¿›åˆ¶æ—¥å¿—ï¼Œ\bå®ç°æ•°æ®åŒæ­¥ã€‚\n\n    ```\n    1 mysql>create user repl; //åˆ›å»ºæ–°ç”¨æˆ·\n    2 //replç”¨æˆ·å¿…é¡»å…·æœ‰REPLICATION SLAVEæƒé™ï¼Œé™¤æ­¤ä¹‹å¤–æ²¡æœ‰å¿…è¦æ·»åŠ ä¸å¿…è¦çš„æƒé™ï¼Œå¯†ç ä¸ºmysqlã€‚è¯´æ˜ä¸€ä¸‹192.168.0.%ï¼Œè¿™ä¸ªé…ç½®æ˜¯æŒ‡æ˜replç”¨æˆ·æ‰€åœ¨æœåŠ¡å™¨ï¼Œè¿™é‡Œ%æ˜¯é€šé…ç¬¦ï¼Œè¡¨ç¤º192.168.0.0-192.168.0.255çš„Serveréƒ½å¯ä»¥ä»¥replç”¨æˆ·ç™»é™†ä¸»æœåŠ¡å™¨ã€‚å½“ç„¶ä½ ä¹Ÿå¯ä»¥æŒ‡å®šå›ºå®šIpã€‚\n    3 mysql> GRANT REPLICATION SLAVE ON *.* TO 'repl'@'192.168.0.%' IDENTIFIED BY 'mysql';\n    ```\n\n    2. æ‰¾åˆ°MySQLå®‰è£…æ–‡ä»¶å¤¹ä¿®æ”¹my.Iniæ–‡ä»¶ã€‚mysqlä¸­æœ‰å¥½å‡ ç§æ—¥å¿—æ–¹å¼ï¼Œè¿™ä¸æ˜¯ä»Šå¤©çš„é‡ç‚¹ã€‚æˆ‘ä»¬åªè¦å¯åŠ¨äºŒè¿›åˆ¶æ—¥å¿—log-binå°±okã€‚\n    åœ¨[mysqld]ä¸‹é¢å¢åŠ ä¸‹é¢å‡ è¡Œä»£ç \n\n    ```\n    1 server-id=1   //ç»™æ•°æ®åº“æœåŠ¡çš„å”¯ä¸€æ ‡è¯†ï¼Œä¸€èˆ¬ä¸ºå¤§å®¶è®¾ç½®æœåŠ¡å™¨Ipçš„æœ«å°¾å·\n    2 log-bin=master-bin\n    3 log-bin-index=master-bin.index\n    ```\n\n    3. æŸ¥çœ‹æ—¥å¿—\n    ```\n    mysql> SHOW MASTER STATUS;\n    +-------------------+----------+--------------+------------------+\n    | File | Position | Binlog_Do_DB | Binlog_Ignore_DB |\n    +-------------------+----------+--------------+------------------+\n    | master-bin.000001 | 1285 | | |\n    +-------------------+----------+--------------+------------------+\n    1 row in set (0.00 sec)\n    ```\n    é‡å¯ MySQL æœåŠ¡\n\n2. \bé…ç½® Slave ä»æœåŠ¡å™¨ (windows)\n    1. æ‰¾åˆ°MySQLå®‰è£…æ–‡ä»¶å¤¹ä¿®æ”¹my.iniæ–‡ä»¶ï¼Œåœ¨[mysqld]ä¸‹é¢å¢åŠ ä¸‹é¢å‡ è¡Œä»£ç \n    ```\n    1 [mysqld]\n    2 server-id=2\n    3 relay-log-index=slave-relay-bin.index\n    4 relay-log=slave-relay-bin \n    ```\n    é‡å¯ MySQL æœåŠ¡\n\n    2. è¿æ¥ Master\n    ```\n    change master to master_host='192.168.0.104', //Master æœåŠ¡å™¨Ip\n    master_port=3306,\n    master_user='repl',\n    master_password='mysql', \n    master_log_file='master-bin.000001',//MasteræœåŠ¡å™¨äº§ç”Ÿçš„æ—¥å¿—\n    master_log_pos=0;\n    ```\n\n    3. å¯åŠ¨ Slave\n    ```\n    start slave;\n    ```\n\n3. Slave ä»æœåŠ¡å™¨ (Ubuntu)\n    1. æ‰¾åˆ° MySQL å®‰è£…æ–‡ä»¶å¤¹ä¿®æ”¹ my.cnf æ–‡ä»¶ï¼Œ vim my.cnf\n    ```\n    [mysqld]\n    basedir =/usr/local/mysql\n    datadir =/usr/local/mysql/data\n    port = 3306\n    server_id = 3\n    relay_log_index=slave-relay-bin.index\n    relay_log=slave-relay-bin\n    ```\n\n    2. ./support-files/myql.server restart é‡å¯MySQLæœåŠ¡  ,  ./bin/mysql è¿›å…¥MySQLå‘½ä»¤çª—å£ \n\n    3. è¿æ¥ Master\n    ```\n    change master to master_host='192.168.0.104', //Master æœåŠ¡å™¨Ip\n    master_port=3306,\n    master_user='repl',\n    master_password='mysql', \n    master_log_file='master-bin.000001',//MasteræœåŠ¡å™¨äº§ç”Ÿçš„æ—¥å¿—\n    master_log_pos=0;\n    ```\n\n    4. å¯åŠ¨ Slave\n    ```\n    start slave;\n    ```\n\nè½¬è‡ªï¼šhttp://www.cnblogs.com/alvin_xp/p/4162249.html","tags":["æ¶æ„"]},{"title":"æœ€ä½³å®‰å…¨å®è·µ","url":"/posts/1528164481/","content":"å¯¹äºéœ€è¦è‡ªè¡Œæˆ–å¤–åŒ…å¼€å‘ä¿¡æ¯ç³»ç»Ÿçš„å•†æˆ·æ¥è¯´ï¼Œæœ‰ä¸€äº›å®‰å…¨çš„æ³¨æ„äº‹é¡¹ï¼Œæˆ‘ä»¬ä» éœ€æ±‚ã€è®¾è®¡ã€ç¼–ç ã€æµ‹è¯•ã€éƒ¨ç½²&è¿ç»´ äº”ä¸ªæ–¹é¢æ¥å±•å¼€ã€‚  \n1. éœ€æ±‚  \n     aã€å•†æˆ·è‡ªå»ºè¥é”€æ´»åŠ¨éœ€è®¾è®¡é˜²åˆ·æœºåˆ¶ã€‚  \n2. è®¾è®¡  \n     aã€æ•°æ®é‡‡é›†  \nâ—† æ³•å¾‹ç¦æ­¢ä¼ä¸šè®°å½•å’Œå­˜å‚¨çš„æ•°æ®ï¼ˆå¦‚ç£é“ä¿¡æ¯ã€ä¿¡ç”¨å¡CVVç ç­‰ï¼‰ä¸èƒ½æ”¶é›†ã€‚  \nâ—† å®¢æˆ·ç«¯æ•æ„Ÿæ•°æ®å¿…é¡»å…ˆè¿›è¡ŒåŠ å¯†å¤„ç†ã€‚  \n     bã€æ•°æ®ä¼ è¾“  \nâ—† ä½¿ç”¨HTTPSç¡®ä¿ç½‘ç»œä¼ è¾“å®‰å…¨æ€§ã€‚  \nâ—† ç¦ç”¨SSLç­‰ä¸å®‰å…¨åè®®å’Œç®—æ³•ï¼Œå»ºè®®ä½¿ç”¨TLS1.2ã€‚  \nâ—† ä¸è¦è½»æ˜“çš„å°è¯•è®¾è®¡å’Œå®ç°è‡ªå·±çš„åŠ å¯†ä¼ è¾“ç®—æ³•ï¼Œå‡ ä¹éƒ½ä¼šå­˜åœ¨é—®é¢˜ã€‚  \n     cã€æ•°æ®ä¿å­˜  \nâ—† æ•æ„Ÿä¿¡æ¯ç¦æ­¢å‡ºç°åœ¨æ—¥å¿—ä¸­ï¼Œå¦‚ç¡®å®éœ€è¦ï¼Œéœ€è¿›è¡Œè„±æ•å¤„ç†ã€‚  \nâ—† ç¼“å­˜å’ŒDBä¸­çš„æ•æ„Ÿæ•°æ®éœ€è¿›è¡ŒåŠ å¯†æˆ–è€…è™šåŒ–ï¼ˆHashï¼‰ã€‚  \nâ—† å¯†ç ç­‰å…³é”®è®¤è¯å¿…é¡»é‡‡ç”¨åŠ ç›Hashæ–¹å¼ä¿å­˜ã€‚  \n     dã€æ•°æ®è®¿é—®  \nâ—† å¤–éƒ¨è¯·æ±‚æ•°æ®è®¿é—®å¿…é¡»è¿›è¡Œé‰´æƒæ“ä½œã€‚  \nâ—† å¯¹äºå†…éƒ¨çš„æ•°æ®è®¿é—®è¦ä¸¥åŠ æ§åˆ¶ï¼Œé™ä½ç”¨æˆ·ä¿¡æ¯æ³„æ¼é£é™©ã€‚  \n     eã€å®¡è®¡æ—¥å¿—  \nâ—† è®°å½•çš„æ“ä½œæ—¥å¿—è¦åŒ…æ‹¬5Wä¿¡æ¯ï¼ˆWhoã€Whenã€Whyã€Howã€Whatï¼‰ã€‚  \n     fã€èµ„é‡‘å¤„ç†  \nâ—† å»ºç«‹å¯¹è´¦æœºåˆ¶ï¼Œæ¯å¤©å¯¹ç³»ç»Ÿæ”¶æ”¯æ•°æ®ä¸å¾®ä¿¡æ”¯ä»˜æ•°æ®è¿›è¡Œå¯¹è´¦ï¼Œé¿å…èµ„é‡‘å‡ºç°é—®é¢˜ã€‚  \nâ—† DBæˆ–è€…KVéœ€è¦è®¾è®¡æ•°æ®é˜²ç¯¡æ”¹æœºåˆ¶ã€‚  \n3. ç¼–ç   \n     aã€é˜²æ­¢å‚æ•°å¤„ç†ä¸å½“å¯¼è‡´çš„å¸¸è§æ¼æ´  \nâ—† å‚è€ƒ [Webæ¼æ´æ£€æµ‹åŠä¿®å¤](http://wiki.open.qq.com/wiki/Webæ¼æ´æ£€æµ‹åŠä¿®å¤)  \n     bã€é˜²æ­¢é€»è¾‘å¤„ç†ä¸å½“å¯¼è‡´çš„æ¼æ´  \nâ—† æ”¯ä»˜æˆåŠŸå›è°ƒé€šçŸ¥å¿…é¡»éªŒè¯å¾®ä¿¡æ”¯ä»˜ç­¾åï¼Œé¿å…è¢«æ¶æ„æ”»å‡»ã€‚  \nâ—† åœ¨åå°è¿›è¡Œå•†æˆ·ä»·æ ¼çš„åˆ¤æ–­é€»è¾‘ï¼Œé¿å…å®¢æˆ·ç«¯ç¯¡æ”¹ä»·æ ¼å¯¼è‡´å•†æˆ·æŸå¤±ã€‚  \nâ—† é¿å…åœ¨Appæˆ–è€…ç½‘ç«™é¡µé¢é‡Œé¢å‡ºç°å•†æˆ·APIkeyæˆ–APIè¯ä¹¦ç­‰ä¿¡æ¯ï¼Œé˜²æ­¢æ³„æ¼ã€‚  \n     cã€APPå¼€å‘å®‰å…¨æ³¨æ„äº‹é¡¹  \nâ—† IOSåº”ç”¨å®‰å…¨å¼€å‘å‚è€ƒ [Apple NextPrevious Security Development Checklists](https://developer.apple.com/library/content/documentation/Security/Conceptual/SecureCodingGuide/SecurityDevelopmentChecklists/SecurityDevelopmentChecklists.html)  \nâ—† andriodåº”ç”¨å®‰å…¨å¼€å‘å‚è€ƒ [Andriod Security Tips](https://developer.android.com/training/articles/security-tips.html)\n4. æµ‹è¯•  \n     aã€å¯¹è¾“å…¥è¾“å‡ºå‚æ•°è¿›è¡Œä¸“é¡¹å®‰å…¨æµ‹è¯•ã€‚  \n     bã€é€šè¿‡ä¼—æµ‹æˆ–è‡ªå»ºã€ç¬¬ä¸‰æ–¹çš„å®‰å…¨æ‰«ææœºåˆ¶å¯¹ç³»ç»Ÿè¿›è¡Œå®‰å…¨æ‰«æå¹¶å¯¹é—®é¢˜è¿›è¡Œä¿®å¤ã€‚\n5. éƒ¨ç½²&è¿ç»´\n     aã€ç¡®ä¿ç³»ç»Ÿæ‰€ä½¿ç”¨å•†ä¸šå’Œå¼€æºç»„ä»¶çš„ç‰ˆæœ¬æ˜¯æœ€æ–°ç¨³å®šç‰ˆã€‚  \n     bã€å‚è€ƒæ­¤ä»½checklistè¿›è¡Œå®‰å…¨é…ç½® [ç³»ç»Ÿæ¼æ´æ£€æµ‹åŠä¿®å¤](http://wiki.open.qq.com/wiki/ç³»ç»Ÿæ¼æ´æ£€æµ‹åŠä¿®å¤)  \n     cã€è€ƒè™‘ç³»ç»Ÿå’Œæ•°æ®æœåŠ¡å®¹ç¾ï¼Œè‡³å°‘æœ‰ä¸»å¤‡æœºåˆ¶ï¼Œå»ºè®®å¤šæœºæˆ¿å¤šåœ°éƒ¨ç½²ã€‚  \n     dã€å»ºè®®é‡‡ç”¨å„å¤§äº‘ç³»ç»Ÿï¼Œå¹¶ä¸”å¯ç”¨ç›¸å…³çš„äº‘å®‰å…¨é˜²æ§æœºåˆ¶ã€‚  \n     eã€å¦‚æœ‰æ¡ä»¶ï¼Œå»ºè®®è‡ªå»ºæˆ–è€…è´­ä¹°ä¸€äº›å®‰å…¨ç›‘æ§æœåŠ¡æˆ–è®¾å¤‡ã€‚  \n     fã€è®¾å®šå…³é”®æŒ‡æ ‡é¡¹ï¼Œè¿›è¡Œå®æ—¶æ•°æ®ä¸ŠæŠ¥å’Œç›‘æ§  \n     gã€æœ‰ä¸“é—¨çš„äººå‘˜æ¥è·Ÿè¿›å®‰å…¨äº‹ä»¶çš„å¤„ç½®ã€‚  \n     hã€å…³æ³¨ä¿¡æ¯ç³»ç»Ÿæ‰€ä½¿ç”¨æ¡†æ¶åŠç»„ä»¶çš„å®‰å…¨ä¿¡æ¯æƒ…å†µã€‚  \n     iã€æŒ‰æ—¶æ‰“è¡¥ä¸ï¼Œå®šæœŸæ£€æŸ¥ç³»ç»Ÿå‡çº§ã€‚  \n     jã€æœåŠ¡ç«¯å£å¼€å¯æœ€å°åŒ–åŸåˆ™ã€‚  \n     kã€æœåŠ¡å™¨ç™»å½•æ“ä½œå¯å®¡è®¡ã€‚  \n     mã€å†…éƒ¨ç®¡ç†è¿è¥ç³»ç»Ÿå¿…é¡»è®¤è¯ç™»å½•åšæ“ä½œæ—¥å¿—è®°å½•ä»¥ä¾›å®¡è®¡ã€‚  \n     nã€å»ºç«‹ä¸šåŠ¡ä¸‹çº¿æœºåˆ¶ï¼Œä¸å†ä½¿ç”¨çš„ä¸šåŠ¡åšä¸‹çº¿æ“ä½œå‡å°‘è¢«æ”»å‡»é¢ã€‚  \n\n\nè½¬è‡ª https://pay.weixin.qq.com/wiki/doc/api/micropay.php?chapter=23_3#menu1","tags":["å®‰å…¨"]},{"title":"HTTPSæœåŠ¡å™¨é…ç½®","url":"/posts/1528164470/","content":"### ä¸€ã€SSLè¯ä¹¦ç”³è¯·\n\n1ã€ç¡®è®¤éœ€è¦ç”³è¯·è¯ä¹¦çš„åŸŸå\n\n2ã€ç”Ÿæˆç§é’¥å’Œcsræ–‡ä»¶  \nåœ¨linuxæœºå™¨ä¸Šæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ç”Ÿæˆç§é’¥  \n```\n#openssl genrsa -out server.key 2048  \n```\nåœ¨linuxæœºå™¨ä¸Šæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ç”Ÿæˆcsræ–‡ä»¶  \n```\n#openssl req -new -key server.key -out certreq.csr  \n```\n**ä»¥ä¸‹é»‘è‰²æ ‡è¯†æ–‡å­—ä»…ä¾›å‚è€ƒï¼Œè¯·æ ¹æ®å•†æˆ·è‡ªå·±å®é™…æƒ…å†µè¿›è¡Œå¡«å†™**  \nCountry Nameï¼š **CN**                      //æ‚¨æ‰€åœ¨å›½å®¶çš„ISOæ ‡å‡†ä»£å·ï¼Œä¸­å›½ä¸ºCN  \nState or Province Nameï¼š**guandong**       //æ‚¨å•ä½æ‰€åœ¨åœ°çœ/è‡ªæ²»åŒº/ç›´è¾–å¸‚  \nLocality Nameï¼š**shenzhen**                 //æ‚¨å•ä½æ‰€åœ¨åœ°çš„å¸‚/å¿/åŒº  \nOrganization Nameï¼š **Tencent Technology (Shenzhen) Company Limited**                 //æ‚¨å•ä½/æœºæ„/ä¼ä¸šåˆæ³•çš„åç§°  \nOrganizational Unit Nameï¼š **R&D**         //éƒ¨é—¨åç§°  \nCommon Nameï¼š **www.example.com**     //é€šç”¨åï¼Œä¾‹å¦‚ï¼šwww.itrus.com.cnã€‚æ­¤é¡¹å¿…é¡»ä¸æ‚¨è®¿é—®æä¾›SSLæœåŠ¡çš„æœåŠ¡å™¨æ—¶æ‰€åº”ç”¨çš„åŸŸåå®Œå…¨åŒ¹é…ã€‚  \nEmail Addressï¼š                          //æ‚¨çš„é‚®ä»¶åœ°å€ï¼Œä¸å¿…è¾“å…¥ï¼Œç›´æ¥å›è½¦è·³è¿‡  \n\"extra\"attributes                        //ä»¥ä¸‹ä¿¡æ¯ä¸å¿…è¾“å…¥ï¼Œå›è½¦è·³è¿‡ç›´åˆ°å‘½ä»¤æ‰§è¡Œå®Œæ¯•ã€‚  \næ‰§è¡Œä¸Šé¢çš„å‘½ä»¤åï¼Œåœ¨å½“å‰ç›®å½•ä¸‹å³å¯ç”Ÿæˆç§é’¥æ–‡ä»¶**server.key**å’Œ**certreq.csr** csræ–‡ä»¶\n\n3ã€å°†ç”Ÿæˆçš„csræ–‡ä»¶æäº¤ç»™ç¬¬ä¸‰æ–¹è¯ä¹¦é¢å‘æœºæ„ç”³è¯·å¯¹åº”åŸŸåçš„æœåŠ¡å™¨è¯ä¹¦ï¼ŒåŒæ—¶å°†ç§é’¥æ–‡ä»¶ä¿å­˜å¥½ï¼Œä»¥å…ä¸¢å¤±ã€‚\n\n4ã€è¯ä¹¦ç”³è¯·åï¼Œè¯ä¹¦é¢å‘æœºæ„ä¼šæä¾›æœåŠ¡å™¨è¯ä¹¦å†…å®¹å’Œä¸¤å¼ ä¸­çº§CAè¯ä¹¦ï¼Œè¯·æŒ‰è¯ä¹¦é¢å‘æœºå™¨è¯´æ˜ç”ŸæˆæœåŠ¡å™¨è¯ä¹¦ï¼Œæ­¤å¤„å‡è®¾æœåŠ¡å™¨è¯ä¹¦æ–‡ä»¶åç§°ä¸º**server.pem**\n\n5ã€å°†ç”Ÿæˆçš„ç§é’¥æ–‡ä»¶**server.key**å’ŒæœåŠ¡å™¨è¯ä¹¦**server.pem**æ‹·è´è‡³æœåŠ¡å™¨æŒ‡å®šçš„ç›®å½•å³å¯è¿›è¡ŒHTTPSæœåŠ¡å™¨é…ç½®\n\n### äºŒã€HTTPSæœåŠ¡å™¨é…ç½®\n\n1ã€ Nginxé…ç½®\n```\nserver {\nlisten       443;   #æŒ‡å®šsslç›‘å¬ç«¯å£\nserver_name  www.example.com;\nssl on;    #å¼€å¯sslæ”¯æŒ\nssl_certificate      /etc/nginx/server.pem;    #æŒ‡å®šæœåŠ¡å™¨è¯ä¹¦è·¯å¾„\nssl_certificate_key  /etc/nginx/server.key;    #æŒ‡å®šç§é’¥è¯ä¹¦è·¯å¾„\nssl_session_timeout  5m;\nssl_protocols TLSv1 TLSv1.1 TLSv1.2;     #æŒ‡å®šSSLæœåŠ¡å™¨ç«¯æ”¯æŒçš„åè®®ç‰ˆæœ¬\nssl_ciphers  ALLï¼š!ADHï¼š!EXPORT56ï¼šRC4+RSAï¼š+HIGHï¼š+MEDIUMï¼š+LOWï¼š+SSLv2ï¼š+EXP;    #æŒ‡å®šåŠ å¯†ç®—æ³•\nssl_prefer_server_ciphers   on;    #åœ¨ä½¿ç”¨SSLv3å’ŒTLSåè®®æ—¶æŒ‡å®šæœåŠ¡å™¨çš„åŠ å¯†ç®—æ³•è¦ä¼˜å…ˆäºå®¢æˆ·ç«¯çš„åŠ å¯†ç®—æ³•\n#ä»¥ä¸‹å†…å®¹è¯·æŒ‰åŸŸåéœ€è¦è¿›è¡Œé…ç½®ï¼Œæ­¤å¤„ä»…ä¾›å‚è€ƒ\nlocation / {\nreturn 444;\n}\n}\n```\n2ã€å…¶å®ƒwebæœåŠ¡å™¨é…ç½®\nè¯·å‚è€ƒæ–‡æ¡£ï¼šhttp://www.itrus.cn/html/fuwuyuzhichi/fuwuqizhengshuanzhuangpeizhizhinan ã€ŠæœåŠ¡å™¨è¯ä¹¦é…ç½®æŒ‡å—ã€‹\n\nä¸‰ã€ç›¸å…³äº‹é¡¹\n\n1ã€è¯ä¹¦é¢å‘æœºæ„  \næ¨èå¤©å¨è¯šä¿¡ï¼Œå…·ä½“è¯·è§ï¼šhttp://www.itrus.com.cn\n\n2ã€ å‚è€ƒæ–‡æ¡£  \nhttp://nginx.org/en/docs/http/ngx_http_ssl_module.html#ssl_prefer_server_ciphers ã€Šngx_http_ssl_moduleã€‹\nhttp://nginx.org/cn/docs/http/configuring_https_servers.html ã€Šnginxé…ç½®HTTPSæœåŠ¡å™¨ã€‹\nhttp://www.itrus.cn/html/fuwuyuzhichi/fuwuqizhengshuanzhuangpeizhizhinan ã€ŠæœåŠ¡å™¨è¯ä¹¦é…ç½®æŒ‡å—ã€‹\n\n3ã€å¸¸è§é—®é¢˜  \nï¼ˆ1ï¼‰è¯ä¹¦å—ä¿¡ä»»çš„é—®é¢˜  \néƒ¨åˆ†å›½å†…ç­¾å‘çš„SSLè¯ä¹¦ï¼Œåœ¨Androidä¸Šä¸å—ä¿¡ä»»ï¼Œæ¨èGeoTrustï¼›  \nï¼ˆ2ï¼‰å¦‚æœé¡µé¢æœ‰åŠ¨é™åˆ†ç¦»ï¼Œé™æ€èµ„æºä½¿ç”¨ç‹¬ç«‹åŸŸåçš„è¯ï¼Œä¹Ÿéœ€è¦ä¸ºè¯¥åŸŸåç”³è¯·è¯ä¹¦ï¼›  \nï¼ˆ3ï¼‰androidä½ç‰ˆæœ¬ä¸æ”¯æŒSNIæ‰©å±•ï¼Œå—æ­¤é™åˆ¶ï¼Œä¸€å°æœåŠ¡å™¨åªèƒ½éƒ¨ç½²ä¸€ä¸ªæ•°å­—è¯ä¹¦ï¼›\n\n\nè½¬è‡ª https://pay.weixin.qq.com/wiki/doc/api/micropay.php?chapter=10_4","tags":["æœ€ä½³å®è·µ"]},{"title":"é˜»æ­¢ç½‘é¡µæ“ä½œå®Œæˆåè‡ªåŠ¨è·³è½¬","url":"/posts/1528164457/","content":"é˜»æ­¢è·³è½¬çš„ä»£ç ï¼š$(window).on('beforeunload', () => { console.log('leave'); return false; });\n\nwindow.addEventListener('beforeunload', function(){console.log('leave');return false;});\n\nå‚è€ƒæ¥æºï¼šhttps://jingyan.baidu.com/article/574c52190bc5ac6c8d9dc196.html","tags":["javascript"]},{"title":"æ‰“åŒ…ç½‘é¡µå®Œæ•´å†…å®¹çš„ä¸€ä¸ªæ–¹æ³•","url":"/posts/1528164446/","content":"ç”¨ safari ä¿å­˜ç½‘ç«™ä¸ºå½’æ¡£ï¼Œæ ¼å¼ä¸º webarchive ï¼Œç”¨ WebArchive Extractor è§£å‹ç¼©ã€‚\n\nè¿™æ ·ä¸ä½†èƒ½ä¿å­˜å®Œæ•´çš„ html, javascript, cssï¼Œè€Œä¸”\bæ¯ä¸ªæ–‡ä»¶åˆ†å¼€ï¼Œéå¸¸ç›´è§‚ã€‚"},{"title":"redisä¸»ä»åˆ‡æ¢è¸©å‘","url":"/posts/1528164430/","content":"æ˜¨å¤©é…ç½®äº† redis sentinel çš„ä¸»ä»åˆ‡æ¢ï¼Œæ— è®ºå¦‚ä½•éƒ½æ— æ³•æˆåŠŸï¼Œç½‘ä¸Šä¹Ÿéƒ½ä¸åˆ°åŸå› ã€‚\n\nåæ¥è§‚å¯Ÿ sentinel æ˜¯æ­£å¸¸å·¥ä½œçš„ï¼Œå¯æ˜¯æœåŠ¡å™¨ä¹‹é—´åªä¼ é€’ sdown æ²¡æœ‰ä¼ é€’ odownï¼Œäºæ˜¯ç”¨è¿™ä¸ªæœåˆ°äº†ã€‚åŸæ¥ sentinel æœ‰ protected modeï¼Œè¦åœ¨é…ç½®é‡Œæ·»åŠ  bind 0.0.0.0ã€‚æ”¹å®Œäº†ä¹‹åç»ˆäºåˆ‡æ¢æˆåŠŸäº†ã€‚\n\nè¿™ä¸ªä¸œè¥¿å¼„äº†æˆ‘æœ‰10å°æ—¶å§ï¼Œé…ç½®æ¨¡ç‰ˆé‡Œæéƒ½æ²¡æï¼ŒçœŸæ˜¯å¤§å‘ã€‚","tags":["redis"]},{"title":"ç”¨äººè¯æ•™ä½ è®¾è®¡æ¨¡å¼","url":"/posts/1528164421/","content":"![Design Patterns For Humans](https://cloud.githubusercontent.com/assets/11269635/23065273/1b7e5938-f515-11e6-8dd3-d0d58de6bb9a.png)\n\n***\n<p align=\"center\">\nğŸ‰ å¯¹è®¾è®¡æ¨¡å¼çš„æç®€è¯´æ˜ï¼ğŸ‰\n</p>\n<p align=\"center\">\nè¿™ä¸ªè¯é¢˜å¯ä»¥è½»æ˜“è®©ä»»ä½•äººç³Šæ¶‚ã€‚ç°åœ¨æˆ‘å°è¯•é€šè¿‡ç”¨<i>æœ€ç®€å•</i>çš„æ–¹å¼è¯´æ˜å®ƒä»¬ï¼Œæ¥è®©ä½ ï¼ˆå’Œæˆ‘ï¼‰æŠŠä»–ä»¬åƒé€ã€‚\n</p>\n***\n\nğŸš€ ç®€ä»‹\n=================\n\nè®¾è®¡æ¨¡å¼ç”¨æ¥è§£å†³é‡å¤çš„é—®é¢˜ï¼›**æ˜¯è§£å†³ç‰¹å®šé—®é¢˜çš„æŒ‡å¯¼æ–¹é’ˆ**ã€‚å®ƒä»¬ä¸æ˜¯ç±»(class)ï¼ŒåŒ…(packages)ï¼Œæˆ–è€…åº“(libraries)ï¼Œä½ ä¸èƒ½å¼•å…¥å®ƒä»¬ï¼Œç„¶åç­‰å¾…å¥‡è¿¹å‘ç”Ÿã€‚å®ƒä»¬æ˜¯é’ˆå¯¹è§£å†³ç‰¹å®šç¯å¢ƒä¸‹ç‰¹å®šé—®é¢˜çš„æŒ‡å¯¼æ–¹é’ˆã€‚\n\n> è®¾è®¡æ¨¡å¼ç”¨æ¥è§£å†³é‡å¤çš„é—®é¢˜ï¼›æ˜¯è§£å†³ç‰¹å®šé—®é¢˜çš„æŒ‡å¯¼æ–¹é’ˆ\n\nç»´åŸºç™¾ç§‘çš„è§£é‡Š\n\n> In software engineering, a software design pattern is a general reusable solution to a commonly occurring problem within a given context in software design. It is not a finished design that can be transformed directly into source or machine code. It is a description or template for how to solve a problem that can be used in many different situations.\n\nâš ï¸ è¯·æ³¨æ„\n-----------------\n- è®¾è®¡æ¨¡å¼ä¸æ˜¯è§£å†³ä½ æ‰€æœ‰é—®é¢˜çš„é“¶å¼¹ã€‚\n- ä¸è¦å°è¯•å¼ºè¡Œä½¿ç”¨å®ƒä»¬ï¼›å¦‚æœåšäº†ï¼Œä¸å¥½çš„äº‹æƒ…å¯èƒ½å‘ç”Ÿã€‚è¯·è®°ä½è®¾è®¡æ¨¡å¼æ˜¯**è§£å†³**é—®é¢˜çš„æ–¹æ¡ˆï¼Œä¸æ˜¯**å‘ç°**é—®é¢˜ï¼›æ‰€ä»¥ä¸è¦è¿‡åº¦æ€è€ƒã€‚\n- å¦‚æœåœ¨æ­£ç¡®çš„åœ°æ–¹ä»¥æ­£ç¡®çš„æ–¹å¼ä½¿ç”¨ï¼Œå®ƒä»¬è¢«è¯æ˜æ˜¯æœ‰å¸®åŠ©çš„ï¼›å¦åˆ™ç»“æœå¯èƒ½æ˜¯ä¸€å †å¯æ€•æ··ä¹±çš„ä»£ç ã€‚\n\n> ä¸‹é¢çš„ä»£ç ç¤ºä¾‹ä½¿ç”¨ PHP-7 ä¹¦å†™ï¼Œä½†ä½ ä¸åº”æ­¢æ­¥äºæ­¤ï¼Œå› ä¸ºç†å¿µæ˜¯ç›¸é€šçš„ã€‚å†åŠ ä¸Š,**å¯¹å…¶ä»–è¯­è¨€çš„æ”¯æŒæ­£åœ¨è·¯ä¸Š**ã€‚\n\nè®¾è®¡æ¨¡å¼çš„ç§ç±»\n-----------------\n\n* [åˆ›å»ºå‹](#åˆ›å»ºå‹æ¨¡å¼)\n* [ç»“æ„å‹](#ç»“æ„å‹æ¨¡å¼)\n* [è¡Œä¸ºå‹](#è¡Œä¸ºå‹æ¨¡å¼)\n\nåˆ›å»ºå‹æ¨¡å¼\n==========================\n\nç™½è¯\n> åˆ›å»ºå‹æ¨¡å¼ä¾§é‡å¦‚ä½•å®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡æˆ–ä¸€ç»„ç›¸å…³å¯¹è±¡ã€‚\n\nç»´åŸºç™¾ç§‘\n> In software engineering, creational design patterns are design patterns that deal with object creation mechanisms, trying to create objects in a manner suitable to the situation. The basic form of object creation could result in design problems or added complexity to the design. Creational design patterns solve this problem by somehow controlling this object creation.\n \n * [ç®€å•å·¥å‚æ¨¡å¼ Simple Factory](#-ç®€å•å·¥å‚æ¨¡å¼)\n * [å·¥å‚æ–¹æ³•æ¨¡å¼ Factory Method](#-å·¥å‚æ–¹æ³•æ¨¡å¼)\n * [æŠ½è±¡å·¥å‚æ¨¡å¼ Abstract Factory](#-æŠ½è±¡å·¥å‚æ¨¡å¼)\n * [å»ºé€ è€…æ¨¡å¼ Builder](#-å»ºé€ è€…æ¨¡å¼)\n * [åŸå‹æ¨¡å¼ Prototype](#-åŸå‹æ¨¡å¼)\n * [å•ä¾‹æ¨¡å¼ Singleton](#-å•ä¾‹æ¨¡å¼)\n \nğŸ  ç®€å•å·¥å‚æ¨¡å¼\n--------------\nç°å®ä¾‹å­\n> å‡è®¾ï¼Œä½ æ­£åœ¨å»ºé€ ä¸€æ‰€æˆ¿å­ï¼Œä½ éœ€è¦é—¨ã€‚å¦‚æœæ¯æ¬¡ä½ éœ€è¦ä¸€æ‰‡é—¨ä½ éƒ½è¦ç©¿ä¸Šæœ¨å·¥æœå¼€å§‹åœ¨æˆ¿å­é‡Œé€ æ‰‡é—¨ï¼Œå°†ä¼šæ˜¯ä¸€å›¢ä¹±ã€‚å–è€Œä»£ä¹‹çš„æ˜¯è®©å·¥å‚é€ å¥½ã€‚\n\nç™½è¯\n> ç®€å•å·¥å‚æ¨¡å¼åœ¨ä¸æš´éœ²ç”Ÿæˆé€»è¾‘çš„å‰æä¸‹ç”Ÿæˆä¸€ä¸ªå®ä¾‹ã€‚\n\nç»´åŸºç™¾ç§‘\n> In object-oriented programming (OOP), a factory is an object for creating other objects â€“ formally a factory is a function or method that returns objects of a varying prototype or class from some method call, which is assumed to be \"new\".\n\n**ä»£ç ä¾‹å­**\n\né¦–å…ˆï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªé—¨çš„æ¥å£å’Œå®ç°\n```php\ninterface Door {\n    public function getWidth() : float;\n    public function getHeight() : float;\n}\n\nclass WoodenDoor implements Door {\n    protected $width;\n    protected $height;\n\n    public function __construct(float $width, float $height) {\n        $this->width = $width;\n        $this->height = $height;\n    }\n    \n    public function getWidth() : float {\n        return $this->width;\n    }\n    \n    public function getHeight() : float {\n        return $this->height;\n    }\n}\n```\nç„¶åï¼Œæˆ‘ä»¬æœ‰äº†å·¥å‚æ¥åˆ¶é€ å’Œè¿”å›é—¨\n```php\nclass DoorFactory {\n   public static function makeDoor($width, $height) : Door {\n       return new WoodenDoor($width, $height);\n   }\n}\n```\nç„¶åè¿™æ ·ä½¿ç”¨\n```php\n$door = DoorFactory::makeDoor(100, 200);\necho 'Width: ' . $door->getWidth();\necho 'Height: ' . $door->getHeight();\n```\n\n**ä»€ä¹ˆæ—¶å€™ä½¿ç”¨ï¼Ÿ**\n\nå½“åˆ›å»ºä¸€ä¸ªå¯¹è±¡ä¸åªæ˜¯å‡ ä¸ªèµ‹å€¼å’Œé€»è¾‘è®¡ç®—ï¼ŒæŠŠè¿™ä»¶å·¥ä½œäº¤ç»™ä¸€ä¸ªå·¥å‚è€Œä¸æ˜¯åˆ°å¤„é‡å¤ç›¸åŒçš„ä»£ç å°±æ¯”è¾ƒåˆé€‚äº†ã€‚\n\nğŸ­ å·¥å‚æ–¹æ³•æ¨¡å¼\n--------------\n\nç°å®ä¾‹å­\n> è®¾æƒ³ä¸€ä¸ªäººäº‹ç»ç†ã€‚ä¸€ä¸ªäººæ˜¯ä¸å¯èƒ½é¢è¯•æ‰€æœ‰èŒä½çš„ã€‚åŸºäºèŒä½ç©ºç¼ºï¼Œå¥¹å¿…é¡»æŠŠé¢è¯•å§”æ‰˜ç»™ä¸åŒçš„äººã€‚\n\nç™½è¯\n> å®ƒæä¾›äº†ä¸€ä¸ªæŠŠç”Ÿæˆé€»è¾‘ç§»äº¤ç»™å­ç±»çš„æ–¹æ³•ã€‚\n\nç»´åŸºç™¾ç§‘\n> In class-based programming, the factory method pattern is a creational pattern that uses factory methods to deal with the problem of creating objects without having to specify the exact class of the object that will be created. This is done by creating objects by calling a factory methodâ€”either specified in an interface and implemented by child classes, or implemented in a base class and optionally overridden by derived classesâ€”rather than by calling a constructor.\n \n **ä»£ç ä¾‹å­**\n \nä»¥ä¸Šé¢çš„äººäº‹ç»ç†ä¸ºä¾‹ã€‚é¦–å…ˆæˆ‘ä»¬æœ‰ä¸€ä¸ªé¢è¯•å®˜æ¥å£å’Œä¸€äº›å®ç°\n\n```php\ninterface Interviewer {\n    public function askQuestions();\n}\n\nclass Developer implements Interviewer {\n    public function askQuestions() {\n        echo 'Asking about design patterns!';\n    }\n}\n\nclass CommunityExecutive implements Interviewer {\n    public function askQuestions() {\n        echo 'Asking about community building';\n    }\n}\n```\n\nç°åœ¨æˆ‘ä»¬æ–°å»ºæˆ‘ä»¬çš„äººäº‹ç»ç† `HiringManager`\n\n```php\nabstract class HiringManager {\n    \n    // Factory method\n    abstract public function makeInterviewer() : Interviewer;\n    \n    public function takeInterview() {\n        $interviewer = $this->makeInterviewer();\n        $interviewer->askQuestions();\n    }\n}\n```\nç°åœ¨ä»»ä½•ä¸€ä¸ªéƒ½å¯ä»¥ç»§æ‰¿å®ƒï¼Œå¹¶ä¸”ç”Ÿæˆéœ€è¦çš„é¢è¯•å®˜\n```php\nclass DevelopmentManager extends HiringManager {\n    public function makeInterviewer() : Interviewer {\n        return new Developer();\n    }\n}\n\nclass MarketingManager extends HiringManager {\n    public function makeInterviewer() : Interviewer {\n        return new CommunityExecutive();\n    }\n}\n```\nç„¶åå¯ä»¥è¿™æ ·ä½¿ç”¨\n\n```php\n$devManager = new DevelopmentManager();\n$devManager->takeInterview(); // Output: Asking about design patterns\n\n$marketingManager = new MarketingManager();\n$marketingManager->takeInterview(); // Output: Asking about community building.\n```\n\n**ä½•æ—¶ä½¿ç”¨ï¼Ÿ**\n\nå½“ä¸€ä¸ªç±»é‡Œæœ‰æ™®éæ€§çš„å¤„ç†è¿‡ç¨‹ï¼Œä½†æ˜¯å­ç±»è¦åœ¨è¿è¡Œæ—¶æ‰ç¡®å®šã€‚æˆ–è€…æ¢å¥è¯è¯´ï¼Œè°ƒç”¨è€…ä¸çŸ¥é“å®ƒéœ€è¦å“ªä¸ªå­ç±»ã€‚\n\nğŸ”¨ æŠ½è±¡å·¥å‚æ¨¡å¼\n----------------\n\nç°å®ä¾‹å­\n> æ‰©å±•æˆ‘ä»¬ç®€å•å·¥å‚æ¨¡å¼çš„ä¾‹å­ã€‚åŸºäºä½ çš„éœ€æ±‚ï¼Œä½ å¯ä»¥ä»æœ¨é—¨åº—å¾—åˆ°ä¸€æ‰‡æœ¨é—¨ï¼Œä»é“é—¨åº—å¾—åˆ°ä¸€æ‰‡é“é—¨ï¼Œæˆ–è€…ä»å¡‘æ–™é—¨åº—å¾—åˆ°ä¸€æ‰‡å¡‘æ–™é—¨ã€‚è€Œä¸”ä½ éœ€è¦ä¸€ä¸ªæœ‰ä¸åŒä¸“é•¿çš„äººæ¥å®‰è£…è¿™æ‰‡é—¨ï¼Œæ¯”å¦‚ä¸€ä¸ªæœ¨åŒ æ¥å®‰æœ¨é—¨ï¼Œç„Šå·¥æ¥å®‰é“é—¨ç­‰ã€‚æ­£å¦‚ä½ çœ‹çš„ï¼Œé—¨å’Œå®‰è£…å·¥æœ‰ä¾èµ–æ€§ï¼Œæœ¨é—¨éœ€è¦æœ¨åŒ ï¼Œé“é—¨éœ€è¦ç„Šå·¥ç­‰ã€‚\n\nç™½è¯\n> ä¸€ä¸ªåˆ¶é€ å·¥å‚çš„å·¥å‚ï¼›ä¸€ä¸ªå·¥å‚æŠŠç‹¬ç«‹ä½†æ˜¯ç›¸å…³ï¼æœ‰ä¾èµ–æ€§çš„å·¥å‚è¿›è¡Œåˆ†ç±»ï¼Œä½†æ˜¯ä¸éœ€è¦ç»™å‡ºå…·ä½“çš„ç±»ã€‚\n  \nç»´åŸºç™¾ç§‘\n> The abstract factory pattern provides a way to encapsulate a group of individual factories that have a common theme without specifying their concrete classes\n\n**ä»£ç ä¾‹å­**\n\nç¿»è¯‘ä¸Šé¢é—¨çš„ä¾‹å­ã€‚é¦–å…ˆæˆ‘ä»¬æœ‰äº†é—¨ `Door` çš„æ¥å£å’Œä¸€äº›å®ç°\n\n```php\ninterface Door {\n    public function getDescription();\n}\n\nclass WoodenDoor implements Door {\n    public function getDescription() {\n        echo 'I am a wooden door';\n    }\n}\n\nclass IronDoor implements Door {\n    public function getDescription() {\n        echo 'I am an iron door';\n    }\n}\n```\nç„¶åæˆ‘ä»¬æœ‰äº†æ¯ç§é—¨çš„å®‰è£…ä¸“å®¶\n\n```php\ninterface DoorFittingExpert {\n    public function getDescription();\n}\n\nclass Welder implements DoorFittingExpert {\n    public function getDescription() {\n        echo 'I can only fit iron doors';\n    }\n}\n\nclass Carpenter implements DoorFittingExpert {\n    public function getDescription() {\n        echo 'I can only fit wooden doors';\n    }\n}\n```\n\nç°åœ¨æˆ‘ä»¬æœ‰äº†æŠ½è±¡å·¥å‚æ¥åˆ›å»ºå…¨éƒ¨ç›¸å…³çš„å¯¹è±¡ï¼Œå³æœ¨é—¨å·¥å‚åˆ¶é€ æœ¨é—¨å’Œæœ¨é—¨å®‰è£…ä¸“å®¶ï¼Œé“é—¨å·¥å‚åˆ¶é€ é“é—¨å’Œé“é—¨å®‰è£…ä¸“å®¶\n```php\ninterface DoorFactory {\n    public function makeDoor() : Door;\n    public function makeFittingExpert() : DoorFittingExpert;\n}\n\n// æœ¨å¤´å·¥å‚è¿”å›æœ¨é—¨å’Œæœ¨åŒ \nclass WoodenDoorFactory implements DoorFactory {\n    public function makeDoor() : Door {\n        return new WoodenDoor();\n    }\n\n    public function makeFittingExpert() : DoorFittingExpert{\n        return new Carpenter();\n    }\n}\n\n// é“é—¨å·¥å‚è¿”å›é“é—¨å’Œå¯¹åº”å®‰è£…ä¸“å®¶\nclass IronDoorFactory implements DoorFactory {\n    public function makeDoor() : Door {\n        return new IronDoor();\n    }\n\n    public function makeFittingExpert() : DoorFittingExpert{\n        return new Welder();\n    }\n}\n```\nç„¶åå¯ä»¥è¿™æ ·ä½¿ç”¨\n```php\n$woodenFactory = new WoodenDoorFactory();\n\n$door = $woodenFactory->makeDoor();\n$expert = $woodenFactory->makeFittingExpert();\n\n$door->getDescription();  // è¾“å‡º: I am a wooden door\n$expert->getDescription(); // è¾“å‡º: I can only fit wooden doors\n\n// é“é—¨å·¥å‚ä¹Ÿä¸€æ ·\n$ironFactory = new IronDoorFactory();\n\n$door = $ironFactory->makeDoor();\n$expert = $ironFactory->makeFittingExpert();\n\n$door->getDescription();  // è¾“å‡º: I am an iron door\n$expert->getDescription(); // è¾“å‡º: I can only fit iron doors\n```\n\nå¦‚ä½ æ‰€è§ï¼Œæœ¨é—¨å·¥å‚åŒ…å«äº†æœ¨åŒ  `carpenter` å’Œæœ¨é—¨ `wooden door` è€Œé“é—¨å·¥å‚åŒ…å«äº†é“é—¨ `iron door` å’Œç„Šå·¥ `welder`ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥ç¡®ä¿æ¯æ‰‡åˆ¶é€ å‡ºæ¥çš„é—¨ä¸ä¼šå¸¦ä¸Šé”™è¯¯çš„å®‰è£…å·¥ã€‚\n\n**ä½•æ—¶ä½¿ç”¨ï¼Ÿ**\n\nå½“åˆ›å»ºé€»è¾‘ä¸é‚£ä¹ˆç®€å•ï¼Œè€Œä¸”ç›¸äº’ä¹‹é—´æœ‰ä¾èµ–æ—¶\n\nğŸ‘· å»ºé€ è€…æ¨¡å¼\n--------------------------------------------\nç°å®ä¾‹å­\n> æƒ³è±¡ä½ åœ¨éº¦å½“åŠ³ï¼Œä½ è¦ä¸€ä¸ªâ€œå·¨æ— éœ¸â€ï¼Œä»–ä»¬é©¬ä¸Šå°±ç»™ä½ äº†ï¼Œæ²¡æœ‰ç–‘é—®ï¼Œè¿™æ˜¯ç®€å•å·¥å‚çš„é€»è¾‘ã€‚ä½†å¦‚æœåˆ›å»ºé€»è¾‘åŒ…å«æ›´å¤šæ­¥éª¤ã€‚æ¯”å¦‚ä½ æƒ³è¦ä¸€ä¸ªè‡ªå®šä¹‰èµ›ç™¾å‘³å¥—é¤ï¼Œä½ æœ‰å¤šç§é€‰æ‹©æ¥åˆ¶ä½œæ±‰å ¡ï¼Œä¾‹å¦‚ä½ è¦å“ªç§é¢åŒ…ï¼Ÿä½ è¦å“ªç§è°ƒå‘³é…±ï¼Ÿä½ è¦å“ªç§å¥¶é…ªï¼Ÿç­‰ã€‚è¿™ç§æƒ…å†µå°±éœ€è¦å»ºé€ è€…æ¨¡å¼æ¥å¤„ç†ã€‚\n\nç™½è¯\n> è®©ä½ èƒ½åˆ›å»ºä¸åŒç‰¹ç‚¹çš„å¯¹è±¡è€Œé¿å…æ„é€ å‡½æ•°æ±¡æŸ“ã€‚å½“ä¸€ä¸ªå¯¹è±¡éƒ½å¤šç§ç‰¹ç‚¹çš„æ—¶å€™æ¯”è¾ƒå®ç”¨ã€‚æˆ–è€…åœ¨åˆ›é€ é€»è¾‘é‡Œæœ‰è®¸å¤šæ­¥éª¤çš„æ—¶å€™ã€‚\n \nç»´åŸºç™¾ç§‘\n> The builder pattern is an object creation software design pattern with the intentions of finding a solution to the telescoping constructor anti-pattern.\n\nè¯è™½å¦‚æ­¤ï¼Œè®©æˆ‘å†™ä¸€ç‚¹å…³äºä¼¸ç¼©æ„é€ å‡½æ•°åé¢æ¨¡å¼ã€‚åœ¨æŸäº›æ—¶å€™ï¼Œæˆ‘ä»¬éƒ½çœ‹è¿‡ä¸‹é¢è¿™æ ·çš„æ„é€ å‡½æ•°\n \n```php\npublic function __construct($size, $cheese = true, $pepperoni = true, $tomato = false, $lettuce = true) {\n}\n```\n\nå¦‚ä½ æ‰€è§ï¼›æ„é€ å‡½æ•°å‚æ•°çš„æ•°é‡é©¬ä¸Šå°±è¦å¤±å»æ§åˆ¶ï¼Œè€Œä¸”æ¢³ç†å‚æ•°ä¹Ÿä¼šå˜å¾—å›°éš¾ã€‚è€Œä¸”å¦‚æœä½ å°†æ¥æƒ³è¦å¢åŠ æ›´å¤šé€‰é¡¹ï¼Œå‚æ•°ä¹Ÿä¼šç»§ç»­å¢åŠ ã€‚è¿™å°±å«åšä¼¸ç¼©æ„é€ å‡½æ•°åé¢æ¨¡å¼ã€‚\n\n**ä»£ç ä¾‹å­**\n\næ­£å¸¸çš„åšæ³•æ˜¯ä½¿ç”¨åˆ›å»ºè€…æ¨¡å¼ã€‚é¦–å…ˆæˆ‘ä»¬æœ‰äº†è¦åšçš„æ±‰å ¡\n\n```php\nclass Burger {\n    protected $size;\n\n    protected $cheese = false;\n    protected $pepperoni = false;\n    protected $lettuce = false;\n    protected $tomato = false;\n    \n    public function __construct(BurgerBuilder $builder) {\n        $this->size = $builder->size;\n        $this->cheese = $builder->cheese;\n        $this->pepperoni = $builder->pepperoni;\n        $this->lettuce = $builder->lettuce;\n        $this->tomato = $builder->tomato;\n    }\n}\n```\n\nç„¶åæˆ‘ä»¬æœ‰äº†åˆ¶ä½œè€…\n\n```php\nclass BurgerBuilder {\n    public $size;\n\n    public $cheese = false;\n    public $pepperoni = false;\n    public $lettuce = false;\n    public $tomato = false;\n\n    public function __construct(int $size) {\n        $this->size = $size;\n    }\n    \n    public function addPepperoni() {\n        $this->pepperoni = true;\n        return $this;\n    }\n    \n    public function addLettuce() {\n        $this->lettuce = true;\n        return $this;\n    }\n    \n    public function addCheese() {\n        $this->cheese = true;\n        return $this;\n    }\n    \n    public function addTomato() {\n        $this->tomato = true;\n        return $this;\n    }\n    \n    public function build() : Burger {\n        return new Burger($this);\n    }\n}\n```\nç„¶åå¯ä»¥è¿™æ ·ä½¿ç”¨\n\n```php\n$burger = (new BurgerBuilder(14))\n                    ->addPepperoni()\n                    ->addLettuce()\n                    ->addTomato()\n                    ->build();\n```\n\n**ä½•æ—¶ä½¿ç”¨ï¼Ÿ**\n\nå½“å¯¹è±¡æœ‰å¤šç§ç‰¹æ€§è€Œè¦é¿å…æ„é€ å‡½æ•°å˜é•¿ã€‚å’Œå·¥å‚æ¨¡å¼çš„æ ¸å¿ƒåŒºåˆ«æ˜¯ï¼›å½“åˆ›å»ºè¿‡ç¨‹åªæœ‰ä¸€ä¸ªæ­¥éª¤çš„æ—¶å€™ä½¿ç”¨å·¥å‚æ¨¡å¼ï¼Œè€Œå½“åˆ›å»ºè¿‡ç¨‹æœ‰å¤šä¸ªæ­¥éª¤çš„æ—¶å€™ä½¿ç”¨åˆ›é€ è€…æ¨¡å¼ã€‚\n\nğŸ‘ åŸå‹æ¨¡å¼\n------------\nç°å®ä¾‹å­\n> è®°å¾—å¤šåˆ©å—ï¼Ÿé‚£åªå…‹éš†ç¾Šï¼ä¸è¦åœ¨æ„ç»†èŠ‚ï¼Œç°åœ¨çš„é‡ç‚¹æ˜¯å…‹éš†\n\nç™½è¯\n> é€šè¿‡å…‹éš†å·²æœ‰çš„å¯¹è±¡æ¥åˆ›å»ºæ–°å¯¹è±¡ã€‚\n\nç»´åŸºç™¾ç§‘\n> The prototype pattern is a creational design pattern in software development. It is used when the type of objects to create is determined by a prototypical instance, which is cloned to produce new objects.\n\né•¿è¯çŸ­è¯´ï¼Œå®ƒè®©ä½ åˆ›å»ºå·²æœ‰å¯¹è±¡çš„æ‹·è´ï¼Œç„¶åä¿®æ”¹åˆ°ä½ è¦çš„æ ·å­ï¼Œè€Œä¸æ˜¯ä»å¤´å¼€å§‹å»ºé€ ã€‚\n\n**ä»£ç ä¾‹å­**\n\nåœ¨ PHP é‡Œï¼Œç®€å•çš„ä½¿ç”¨ `clone` å°±å¯ä»¥äº†\n  \n```php\nclass Sheep {\n    protected $name;\n    protected $category;\n\n    public function __construct(string $name, string $category = 'Mountain Sheep') {\n        $this->name = $name;\n        $this->category = $category;\n    }\n    \n    public function setName(string $name) {\n        $this->name = $name;\n    }\n\n    public function getName() {\n        return $this->name;\n    }\n\n    public function setCategory(string $category) {\n        $this->category = $category;\n    }\n\n    public function getCategory() {\n        return $this->category;\n    }\n}\n```\nç„¶åå®ƒå¯ä»¥è¢«è¿™æ ·å…‹éš†\n```php\n$original = new Sheep('Jolly');\necho $original->getName(); // Jolly\necho $original->getCategory(); // Mountain Sheep\n\n// Clone and modify what is required\n$cloned = clone $original;\n$cloned->setName('Dolly');\necho $cloned->getName(); // Dolly\necho $cloned->getCategory(); // Mountain sheep\n```\n\nä½ ä¹Ÿå¯ä»¥ä½¿ç”¨é­”æ³•æ–¹æ³• `__clone` æ¥æ”¹å˜å…‹éš†é€»è¾‘ã€‚\n\n**ä½•æ—¶ä½¿ç”¨ï¼Ÿ**\n\nå½“ä¸€ä¸ªå¯¹è±¡éœ€è¦è·Ÿå·²æœ‰çš„å¯¹è±¡ç›¸ä¼¼ï¼Œæˆ–è€…å½“åˆ›é€ è¿‡ç¨‹æ¯”èµ·å…‹éš†æ¥å¤ªæ˜‚è´µæ—¶ã€‚\n\nğŸ’ å•ä¾‹æ¨¡å¼\n------------\nç°å®ä¾‹å­\n> ä¸€ä¸ªå›½å®¶åŒä¸€æ—¶é—´åªèƒ½æœ‰ä¸€ä¸ªæ€»ç»Ÿã€‚å½“ä½¿å‘½å¬å”¤çš„æ—¶å€™ï¼Œè¿™ä¸ªæ€»ç»Ÿè¦é‡‡å–è¡ŒåŠ¨ã€‚è¿™é‡Œçš„æ€»ç»Ÿå°±æ˜¯å•ä¾‹çš„ã€‚\n\nç™½è¯\n> ç¡®ä¿æŒ‡å®šçš„ç±»åªç”Ÿæˆä¸€ä¸ªå¯¹è±¡ã€‚\n\nç»´åŸºç™¾ç§‘\n> In software engineering, the singleton pattern is a software design pattern that restricts the instantiation of a class to one object. This is useful when exactly one object is needed to coordinate actions across the system.\n\nå•ä¾‹æ¨¡å¼å…¶å®è¢«çœ‹ä½œä¸€ç§åé¢æ¨¡å¼ï¼Œåº”è¯¥é¿å…è¿‡åº¦ä½¿ç”¨ã€‚å®ƒä¸ä¸€å®šä¸å¥½ï¼Œè€Œä¸”ç¡®æœ‰ä¸€äº›æœ‰æ•ˆçš„ç”¨ä¾‹ï¼Œä½†æ˜¯åº”è¯¥è°¨æ…ä½¿ç”¨ï¼Œå› ä¸ºå®ƒåœ¨ä½ çš„åº”ç”¨é‡Œå¼•å…¥äº†å…¨å±€çŠ¶æ€ï¼Œåœ¨ä¸€ä¸ªåœ°æ–¹æ”¹å˜ï¼Œä¼šå½±å“å…¶ä»–åœ°æ–¹ã€‚è€Œä¸”å¾ˆéš¾ debug ã€‚å¦ä¸€ä¸ªåå¤„æ˜¯å®ƒè®©ä½ çš„ä»£ç ç´§è€¦åˆï¼Œè€Œä¸”å¾ˆéš¾ä»¿åˆ¶å•ä¾‹ã€‚\n\n**ä»£ç ä¾‹å­**\n\nè¦åˆ›å»ºä¸€ä¸ªå•ä¾‹ï¼Œå…ˆè®©æ„é€ å‡½æ•°ç§æœ‰ï¼Œä¸èƒ½å…‹éš†ï¼Œä¸èƒ½ç»§æ‰¿ï¼Œç„¶ååˆ›é€ ä¸€ä¸ªé™æ€å˜é‡æ¥ä¿å­˜è¿™ä¸ªå®ä¾‹\n```php\nfinal class President {\n    private static $instance;\n\n    private function __construct() {\n        // Hide the constructor\n    }\n    \n    public static function getInstance() : President {\n        if (!self::$instance) {\n            self::$instance = new self();\n        }\n        \n        return self::$instance;\n    }\n    \n    private function __clone() {\n        // Disable cloning\n    }\n    \n    private function __wakeup() {\n        // Disable unserialize\n    }\n}\n```\nç„¶åè¦ä½¿ç”¨çš„è¯\n```php\n$president1 = President::getInstance();\n$president2 = President::getInstance();\n\nvar_dump($president1 === $president2); // true\n```\n\nç»“æ„å‹æ¨¡å¼\n==========================\nç™½è¯\n> ç»“æ„å‹æ¨¡å¼æ›´å…³æ³¨å¯¹è±¡çš„ç»„åˆï¼Œæ¢å¥è¯è¯´ï¼Œå®ä½“å¦‚ä½•å½¼æ­¤ä½¿ç”¨ã€‚æˆ–è€…è¯´ï¼Œå®ƒä»¬å¸®åŠ©è§£ç­”â€œå¦‚ä½•å»ºé€ è½¯ä»¶ç»„ä»¶ï¼Ÿâ€\n\nç»´åŸºç™¾ç§‘\n> In software engineering, structural design patterns are design patterns that ease the design by identifying a simple way to realize relationships between entities.\n  \n * [é€‚é…å™¨æ¨¡å¼ Adapter](#-é€‚é…å™¨æ¨¡å¼)\n * [æ¡¥æ¥æ¨¡å¼ Bridge](#-æ¡¥æ¥æ¨¡å¼)\n * [ç»„åˆæ¨¡å¼ Composite](#-ç»„åˆæ¨¡å¼)\n * [è£…é¥°å™¨æ¨¡å¼ Decorator](#-è£…é¥°å™¨æ¨¡å¼)\n * [é—¨é¢æ¨¡å¼ Facade](#-é—¨é¢æ¨¡å¼)\n * [äº«å…ƒæ¨¡å¼ Flyweight](#-äº«å…ƒæ¨¡å¼)\n * [ä»£ç†æ¨¡å¼ Proxy](#-ä»£ç†æ¨¡å¼)\n\nğŸ”Œ é€‚é…å™¨æ¨¡å¼\n-------\nç°å®ä¾‹å­\n> å‡è®¾åœ¨ä½ çš„å­˜å‚¨å¡é‡Œæœ‰ä¸€äº›ç…§ç‰‡ï¼Œä½ è¦æŠŠå®ƒä»¬ä¼ åˆ°ç”µè„‘ã€‚ä¸ºäº†ä¼ è¾“ï¼Œä½ éœ€è¦ä¸€ä¸ªå…¼å®¹ç”µè„‘ç«¯å£çš„é€‚é…å™¨æ¥è¿æ¥å­˜å‚¨å¡å’Œç”µè„‘ã€‚åœ¨è¿™é‡Œï¼Œè¯»å¡å™¨å°±æ˜¯ä¸€ä¸ªé€‚é…å™¨ã€‚\n> å¦ä¸€ä¸ªä¾‹å­æ˜¯ç”µæºè½¬æ¢å™¨ï¼›ä¸€ä¸ªä¸‰è„šçš„æ’å£ä¸èƒ½æ’åˆ°ä¸¤å£çš„æ’åº§ä¸Šï¼Œå®ƒéœ€è¦ä¸€ä¸ªç”µæºè½¬æ¢å™¨æ¥å…¼å®¹ä¸¤å£çš„æ’åº§ã€‚\n> è¿˜æœ‰ä¸€ä¸ªä¾‹å­æ˜¯ç¿»è¯‘å°†ä¸€ä¸ªäººè¯´çš„è¯ç¿»è¯‘ç»™å¦ä¸€ä¸ªäººã€‚\n\nç™½è¯\n> é€‚é…å™¨æ¨¡å¼è®©ä½ å°è£…ä¸€ä¸ªä¸å…¼å®¹çš„å¯¹è±¡åˆ°ä¸€ä¸ªé€‚é…å™¨ï¼Œæ¥å…¼å®¹å…¶ä»–ç±»ã€‚\n\nç»´åŸºç™¾ç§‘\n> In software engineering, the adapter pattern is a software design pattern that allows the interface of an existing class to be used as another interface. It is often used to make existing classes work with others without modifying their source code.\n\n**ä»£ç ä¾‹å­**\n\nå‡è®¾ä¸€ä¸ªçŒäººç‹©çŒç‹®å­çš„æ¸¸æˆã€‚\n\né¦–å…ˆæˆ‘ä»¬æœ‰äº†ä¸€ä¸ªæ¥å£ç‹®å­ `Lion` æ¥å®ç°æ‰€æœ‰ç§ç±»çš„ç‹®å­\n\n```php\ninterface Lion {\n    public function roar();\n}\n\nclass AfricanLion implements Lion {\n    public function roar() {}\n}\n\nclass AsianLion implements Lion {\n    public function roar() {}\n}\n```\nä»¥åŠçŒäººéœ€è¦ç‹©çŒä»»ä½•ç‹®å­ `Lion` æ¥å£çš„å®ç°ã€‚\n```php\nclass Hunter {\n    public function hunt(Lion $lion) {\n    }\n}\n```\n\nç°åœ¨æˆ‘ä»¬ä¸å¾—ä¸åœ¨æ¸¸æˆé‡ŒåŠ ä¸€ä¸ªé‡ç‹— `WildDog` ï¼ŒçŒäººä¹Ÿèƒ½ç‹©çŒå®ƒã€‚ä½†æ˜¯æˆ‘ä»¬ä¸èƒ½ç›´æ¥è¿™ä¹ˆåšï¼Œå› ä¸ºç‹—æœ‰ä¸åŒçš„æ¥å£ã€‚ä¸ºäº†å…¼å®¹æˆ‘ä»¬çš„çŒäººï¼Œæˆ‘ä»¬ä¸å¾—ä¸åˆ›å»ºä¸€ä¸ªå…¼å®¹çš„é€‚é…å™¨\n \n```php\n// This needs to be added to the game\nclass WildDog {\n    public function bark() {}\n}\n\n// Adapter around wild dog to make it compatible with our game\nclass WildDogAdapter implements Lion {\n    protected $dog;\n\n    public function __construct(WildDog $dog) {\n        $this->dog = $dog;\n    }\n    \n    public function roar() {\n        $this->dog->bark();\n    }\n}\n```\nç°åœ¨é‡ç‹— `WildDog` å¯ä»¥åœ¨æ¸¸æˆé‡Œä½¿ç”¨äº†ï¼Œé€šè¿‡é‡ç‹—é€‚é…å™¨ `WildDogAdapter`.\n\n```php\n$wildDog = new WildDog();\n$wildDogAdapter = new WildDogAdapter($wildDog);\n\n$hunter = new Hunter();\n$hunter->hunt($wildDogAdapter);\n```\n\nğŸš¡ æ¡¥æ¥æ¨¡å¼\n------\nç°å®ä¾‹å­\n> å‡è®¾ä½ æœ‰ä¸€ä¸ªåŒ…å«å¾ˆå¤šç½‘é¡µçš„ç½‘ç«™ï¼Œä½ æƒ³è¦ç”¨æˆ·å¯ä»¥æ”¹å˜ä¸»é¢˜ã€‚ä½ ä¼šæ€ä¹ˆåšï¼Ÿåˆ›å»ºæ¯ä¸ªé¡µé¢å¯¹åº”æ¯ä¸ªä¸»é¢˜çš„æ‹·å¤‡ï¼Œè¿˜æ˜¯åªæ˜¯åˆ›å»ºä¸åŒçš„ä¸»é¢˜ï¼Œç„¶åæ ¹æ®ç”¨æˆ·çš„å–œå¥½æ¥åŠ è½½å®ƒä»¬ï¼Ÿæ¡¥æ¥æ¨¡å¼è®©ä½ èƒ½åšåˆ°åè€…ã€‚\n\n![With and without the bridge pattern](https://cloud.githubusercontent.com/assets/11269635/23065293/33b7aea0-f515-11e6-983f-98823c9845ee.png)\n\nç™½è¯\n> æ¡¥æ¥æ¨¡å¼å€¾å‘æ„é€ è€Œéç»§æ‰¿ã€‚å®ç°ç»†èŠ‚è¢«ä»ä¸€ä¸ªå±‚æ¨é€åˆ°å¦ä¸€ä¸ªå¯¹è±¡çš„å¦ä¸€å±‚ã€‚\n\nç»´åŸºç™¾ç§‘\n> The bridge pattern is a design pattern used in software engineering that is meant to \"decouple an abstraction from its implementation so that the two can vary independently\"\n\n**ä»£ç ä¾‹å­**\n\nç¿»è¯‘æˆ‘ä»¬ä¸Šé¢çš„ç½‘é¡µä¾‹å­ã€‚è¿™é‡Œæ˜¯ç½‘é¡µ `WebPage` å±‚\n\n```php\ninterface WebPage {\n    public function __construct(Theme $theme);\n    public function getContent();\n}\n\nclass About implements WebPage {\n    protected $theme;\n    \n    public function __construct(Theme $theme) {\n        $this->theme = $theme;\n    }\n    \n    public function getContent() {\n        return \"About page in \" . $this->theme->getColor();\n    }\n}\n\nclass Careers implements WebPage {\n   protected $theme;\n   \n   public function __construct(Theme $theme) {\n       $this->theme = $theme;\n   }\n   \n   public function getContent() {\n       return \"Careers page in \" . $this->theme->getColor();\n   } \n}\n```\nä»¥åŠä¸»é¢˜å±‚\n```php\ninterface Theme {\n    public function getColor();\n}\n\nclass DarkTheme implements Theme {\n    public function getColor() {\n        return 'Dark Black';\n    }\n}\nclass LightTheme implements Theme {\n    public function getColor() {\n        return 'Off white';\n    }\n}\nclass AquaTheme implements Theme {\n    public function getColor() {\n        return 'Light blue';\n    }\n}\n```\nä¸¤ä¸ªå±‚çš„äº’åŠ¨\n```php\n$darkTheme = new DarkTheme();\n\n$about = new About($darkTheme);\n$careers = new Careers($darkTheme);\n\necho $about->getContent(); // \"About page in Dark Black\";\necho $careers->getContent(); // \"Careers page in Dark Black\";\n```\n\nğŸŒ¿ ç»„åˆæ¨¡å¼\n-----------------\n\nç°å®ä¾‹å­\n> ä»»ä½•ç»„ç»‡éƒ½æ˜¯ç”±å‘˜å·¥ç»„æˆã€‚æ¯ä¸ªå‘˜å·¥éƒ½æœ‰ç›¸åŒçš„ç‰¹å¾ï¼Œå³ä¸€ç¬”è–ªæ°´ï¼Œä¸€äº›è´£ä»»ï¼Œå¯èƒ½éœ€è¦å‘åˆ«äººæ±‡æŠ¥ï¼Œå¯èƒ½æœ‰ä¸€äº›ä¸‹å±ç­‰ã€‚\n\nç™½è¯\n> ç»„åˆæ¨¡å¼è®©è°ƒç”¨è€…å¯ä»¥ç”¨ç»Ÿä¸€çš„æ¨¡å¼å¯¹å¾…ä¸åŒçš„å¯¹è±¡ã€‚\n\nç»´åŸºç™¾ç§‘\n> In software engineering, the composite pattern is a partitioning design pattern. The composite pattern describes that a group of objects is to be treated in the same way as a single instance of an object. The intent of a composite is to \"compose\" objects into tree structures to represent part-whole hierarchies. Implementing the composite pattern lets clients treat individual objects and compositions uniformly.\n\n**ä»£ç ä¾‹å­**\n\næ‹¿ä¸Šé¢çš„å‘˜å·¥ä¸ºä¾‹ã€‚ä¸‹é¢æ˜¯ä¸åŒçš„å‘˜å·¥ç±»å‹\n\n```php\n\ninterface Employee {\n    public function __construct(string $name, float $salary);\n    public function getName() : string;\n    public function setSalary(float $salary);\n    public function getSalary() : float;\n    public function getRoles()  : array;\n}\n\nclass Developer implements Employee {\n\n    protected $salary;\n    protected $name;\n\n    public function __construct(string $name, float $salary) {\n        $this->name = $name;\n        $this->salary = $salary;\n    }\n\n    public function getName() : string {\n        return $this->name;\n    }\n\n    public function setSalary(float $salary) {\n        $this->salary = $salary;\n    }\n\n    public function getSalary() : float {\n        return $this->salary;\n    }\n\n    public function getRoles() : array {\n        return $this->roles;\n    }\n}\n\nclass Designer implements Employee {\n\n    protected $salary;\n    protected $name;\n\n    public function __construct(string $name, float $salary) {\n        $this->name = $name;\n        $this->salary = $salary;\n    }\n\n    public function getName() : string {\n        return $this->name;\n    }\n\n    public function setSalary(float $salary) {\n        $this->salary = $salary;\n    }\n\n    public function getSalary() : float {\n        return $this->salary;\n    }\n\n    public function getRoles() : array {\n        return $this->roles;\n    }\n}\n```\n\nä¸‹é¢æ˜¯ä¸€ä¸ªç”±ä¸åŒç±»å‹å‘˜å·¥ç»„æˆçš„ç»„ç»‡\n\n```php\nclass Organization {\n    \n    protected $employees;\n\n    public function addEmployee(Employee $employee) {\n        $this->employees[] = $employee;\n    }\n\n    public function getNetSalaries() : float {\n        $netSalary = 0;\n\n        foreach ($this->employees as $employee) {\n            $netSalary += $employee->getSalary();\n        }\n\n        return $netSalary;\n    }\n}\n```\n\nç„¶åå¯ä»¥è¿™æ ·ä½¿ç”¨\n\n```php\n// å‡†å¤‡å‘˜å·¥\n$john = new Developer('John Doe', 12000);\n$jane = new Designer('Jane', 10000);\n\n// æŠŠä»–ä»¬åŠ åˆ°ç»„ç»‡é‡Œå»\n$organization = new Organization();\n$organization->addEmployee($john);\n$organization->addEmployee($jane);\n\necho \"Net salaries: \" . $organization->getNetSalaries(); // Net Salaries: 22000\n```\n\nâ˜• è£…é¥°å™¨æ¨¡å¼\n-------------\n\nç°å®ä¾‹å­\n\n> æƒ³è±¡ä½ å¼€ä¸€å®¶æ±½è½¦æœåŠ¡åº—ï¼Œæä¾›å„ç§æœåŠ¡ã€‚ç°åœ¨ä½ æ€ä¹ˆè®¡ç®—æ”¶è´¹ï¼Ÿä½ é€‰æ‹©ä¸€ä¸ªæœåŠ¡ï¼Œç„¶åä¸æ–­æŠŠä»·æ ¼åŠ åˆ°å·²é€‰æœåŠ¡çš„ä»·æ ¼é‡Œï¼Œç›´åˆ°å¾—åˆ°æ€»ä»·ã€‚è¿™é‡Œï¼Œæ¯ç§æœåŠ¡å°±æ˜¯ä¸€ä¸ªè£…é¥°å™¨ã€‚\n\nç™½è¯\n> è£…é¥°å™¨æ¨¡å¼è®©ä½ èƒ½åœ¨è¿è¡Œæ—¶åŠ¨æ€åœ°æ”¹å˜ä¸€ä¸ªå¯¹è±¡çš„è¡¨ç°ï¼Œé€šè¿‡æŠŠå®ƒä»¬å°è£…åˆ°ä¸€ä¸ªè£…é¥°å™¨ç±»ã€‚\n\nç»´åŸºç™¾ç§‘\n> In object-oriented programming, the decorator pattern is a design pattern that allows behavior to be added to an individual object, either statically or dynamically, without affecting the behavior of other objects from the same class. The decorator pattern is often useful for adhering to the Single Responsibility Principle, as it allows functionality to be divided between classes with unique areas of concern.\n\n**ä»£ç ä¾‹å­**\n\nè®©æˆ‘ä»¬ä»¥å’–å•¡ä¸ºä¾‹ã€‚é¦–å…ˆæˆ‘ä»¬æœ‰ä¸€ä¸ªå’–å•¡æ¥å£çš„ç®€å•å®ç°\n\n```php\ninterface Coffee {\n    public function getCost();\n    public function getDescription();\n}\n\nclass SimpleCoffee implements Coffee {\n\n    public function getCost() {\n        return 10;\n    }\n\n    public function getDescription() {\n        return 'Simple coffee';\n    }\n}\n```\næˆ‘ä»¬æƒ³è¦è®©ä»£ç å¯æ‰©å±•ï¼Œä»¥åœ¨éœ€è¦çš„æ—¶å€™æ”¹å˜é€‰é¡¹ã€‚è®©æˆ‘ä»¬å¢åŠ ä¸€äº›æ‰©å±•ï¼ˆè£…é¥°å™¨ï¼‰\n```php\nclass MilkCoffee implements Coffee {\n    \n    protected $coffee;\n\n    public function __construct(Coffee $coffee) {\n        $this->coffee = $coffee;\n    }\n\n    public function getCost() {\n        return $this->coffee->getCost() + 2;\n    }\n\n    public function getDescription() {\n        return $this->coffee->getDescription() . ', milk';\n    }\n}\n\nclass WhipCoffee implements Coffee {\n\n    protected $coffee;\n\n    public function __construct(Coffee $coffee) {\n        $this->coffee = $coffee;\n    }\n\n    public function getCost() {\n        return $this->coffee->getCost() + 5;\n    }\n\n    public function getDescription() {\n        return $this->coffee->getDescription() . ', whip';\n    }\n}\n\nclass VanillaCoffee implements Coffee {\n\n    protected $coffee;\n\n    public function __construct(Coffee $coffee) {\n        $this->coffee = $coffee;\n    }\n\n    public function getCost() {\n        return $this->coffee->getCost() + 3;\n    }\n\n    public function getDescription() {\n        return $this->coffee->getDescription() . ', vanilla';\n    }\n}\n\n```\n\nç°åœ¨è®©æˆ‘ä»¬ç”Ÿæˆå’–å•¡\n\n```php\n$someCoffee = new SimpleCoffee();\necho $someCoffee->getCost(); // 10\necho $someCoffee->getDescription(); // Simple Coffee\n\n$someCoffee = new MilkCoffee($someCoffee);\necho $someCoffee->getCost(); // 12\necho $someCoffee->getDescription(); // Simple Coffee, milk\n\n$someCoffee = new WhipCoffee($someCoffee);\necho $someCoffee->getCost(); // 17\necho $someCoffee->getDescription(); // Simple Coffee, milk, whip\n\n$someCoffee = new VanillaCoffee($someCoffee);\necho $someCoffee->getCost(); // 20\necho $someCoffee->getDescription(); // Simple Coffee, milk, whip, vanilla\n```\n\nğŸ“¦ é—¨é¢æ¨¡å¼\n----------------\n\nç°å®ä¾‹å­\n> ä½ æ€ä¹ˆæ‰“å¼€ç”µè„‘ï¼Ÿä½ ä¼šè¯´â€œæŒ‰ç”µæºé”®â€ï¼ä½ è¿™ä¹ˆè®¤ä¸ºæ˜¯å› ä¸ºä½ åœ¨ç”¨ç”µè„‘å¤–éƒ¨æä¾›çš„ç®€å•æ¥å£ï¼Œè€Œåœ¨å†…éƒ¨ï¼Œå®ƒå¿…é¡»åšå¾ˆåšå·¥ä½œæ¥å®ç°è¿™ä»¶äº‹ã€‚è¿™ä¸ªå¤æ‚å­ç³»ç»Ÿçš„ç®€å•æ¥å£å°±æ˜¯ä¸€ä¸ªé—¨é¢ã€‚\n\nç™½è¯\n> é—¨é¢æ¨¡å¼æä¾›äº†ä¸€ä¸ªå¤æ‚å­ç³»ç»Ÿçš„ç®€å•æ¥å£ã€‚\n\nç»´åŸºç™¾ç§‘\n> A facade is an object that provides a simplified interface to a larger body of code, such as a class library.\n\n**ä»£ç ä¾‹å­**\n\næ‹¿ä¸Šé¢ç”µè„‘ä¸ºä¾‹ã€‚ä¸‹é¢æ˜¯ç”µè„‘ç±»\n\n```php\nclass Computer {\n\n    public function getElectricShock() {\n        echo \"Ouch!\";\n    }\n\n    public function makeSound() {\n        echo \"Beep beep!\";\n    }\n\n    public function showLoadingScreen() {\n        echo \"Loading..\";\n    }\n\n    public function bam() {\n        echo \"Ready to be used!\";\n    }\n\n    public function closeEverything() {\n        echo \"Bup bup bup buzzzz!\";\n    }\n\n    public function sooth() {\n        echo \"Zzzzz\";\n    }\n\n    public function pullCurrent() {\n        echo \"Haaah!\";\n    }\n}\n```\nä¸‹é¢æ˜¯é—¨é¢\n```php\nclass ComputerFacade\n{\n    protected $computer;\n\n    public function __construct(Computer $computer) {\n        $this->computer = $computer;\n    }\n\n    public function turnOn() {\n        $this->computer->getElectricShock();\n        $this->computer->makeSound();\n        $this->computer->showLoadingScreen();\n        $this->computer->bam();\n    }\n\n    public function turnOff() {\n        $this->computer->closeEverything();\n        $this->computer->pullCurrent();\n        $this->computer->sooth();\n    }\n}\n```\nå¦‚ä½•ä½¿ç”¨é—¨é¢\n```php\n$computer = new ComputerFacade(new Computer());\n$computer->turnOn(); // Ouch! Beep beep! Loading.. Ready to be used!\n$computer->turnOff(); // Bup bup buzzz! Haah! Zzzzz\n```\n\nğŸƒ äº«å…ƒæ¨¡å¼\n---------\n\nç°å®ä¾‹å­\n> ä½ åœ¨å°åº—é‡Œå–è¿‡èŒ¶å—ï¼Ÿä»–ä»¬ç»å¸¸æ¯”ä½ è¦çš„å¤šåšå‡ æ¯ï¼ŒæŠŠå‰©ä¸‹çš„ç•™ç»™åˆ«çš„å®¢äººï¼Œä»¥æ­¤æ¥çœèµ„æºï¼Œæ¯”å¦‚ç…¤æ°”ã€‚äº«å…ƒæ¨¡å¼å°±æ˜¯ä»¥ä¸Šçš„ä½“ç°ï¼Œå³åˆ†äº«ã€‚\n\nç™½è¯\n> é€šè¿‡å°½å¯èƒ½åˆ†äº«ç›¸ä¼¼çš„å¯¹è±¡ï¼Œæ¥å°†å†…å­˜ä½¿ç”¨æˆ–è®¡ç®—å¼€é”€é™åˆ°æœ€ä½ã€‚\n\nç»´åŸºç™¾ç§‘\n> In computer programming, flyweight is a software design pattern. A flyweight is an object that minimizes memory use by sharing as much data as possible with other similar objects; it is a way to use objects in large numbers when a simple repeated representation would use an unacceptable amount of memory.\n\n**ä»£ç ä¾‹å­**\n\nç¿»è¯‘ä¸Šé¢çš„èŒ¶çš„ä¾‹å­ã€‚é¦–å…ˆæˆ‘ä»¬æœ‰äº†èŒ¶çš„ç±»å‹å’Œç”Ÿæˆå™¨\n\n```php\n// ä»»ä½•è¢«ç¼“å­˜çš„ä¸œè¥¿éƒ½è¢«å«åšäº«å…ƒã€‚ \n// è¿™é‡ŒèŒ¶çš„ç±»å‹å°±æ˜¯äº«å…ƒã€‚\nclass KarakTea {\n}\n\n// åƒå·¥å‚ä¸€æ ·å·¥ä½œï¼Œä¿å­˜èŒ¶\nclass TeaMaker {\n    protected $availableTea = [];\n\n    public function make($preference) {\n        if (empty($this->availableTea[$preference])) {\n            $this->availableTea[$preference] = new KarakTea();\n        }\n\n        return $this->availableTea[$preference];\n    }\n}\n```\n\nä¸‹é¢æ˜¯æˆ‘ä»¬çš„èŒ¶å§ `TeaShop` ï¼Œæ¥å•å’Œæä¾›æœåŠ¡\n\n```php\nclass TeaShop {\n    \n    protected $orders;\n    protected $teaMaker;\n\n    public function __construct(TeaMaker $teaMaker) {\n        $this->teaMaker = $teaMaker;\n    }\n\n    public function takeOrder(string $teaType, int $table) {\n        $this->orders[$table] = $this->teaMaker->make($teaType);\n    }\n\n    public function serve() {\n        foreach($this->orders as $table => $tea) {\n            echo \"Serving tea to table# \" . $table;\n        }\n    }\n}\n```\nç„¶åå¯ä»¥è¿™æ ·ä½¿ç”¨\n\n```php\n$teaMaker = new TeaMaker();\n$shop = new TeaShop($teaMaker);\n\n$shop->takeOrder('less sugar', 1);\n$shop->takeOrder('more milk', 2);\n$shop->takeOrder('without sugar', 5);\n\n$shop->serve();\n// Serving tea to table# 1\n// Serving tea to table# 2\n// Serving tea to table# 5\n```\n\nğŸ± ä»£ç†æ¨¡å¼\n-------------------\nç°å®ä¾‹å­\n> ä½ æœ‰æ²¡æœ‰ç”¨è¿‡é—¨å¡æ¥é€šè¿‡ä¸€æ‰‡é—¨ï¼Ÿæœ‰å¤šç§æ–¹å¼æ¥æ‰“å¼€é‚£æ‰‡é—¨ï¼Œå³å®ƒå¯ä»¥è¢«é—¨å¡æ‰“å¼€ï¼Œæˆ–è€…æŒ‰å¼€é—¨æŒ‰é’®æ‰“å¼€ã€‚è¿™æ‰‡é—¨çš„ä¸»è¦åŠŸèƒ½æ˜¯å¼€å…³ï¼Œä½†åœ¨é¡¶å±‚å¢åŠ äº†ä¸€ä¸ªä»£ç†æ¥å¢åŠ å…¶ä»–åŠŸèƒ½ã€‚ä¸‹é¢çš„ä¾‹å­èƒ½æ›´å¥½çš„è¯´æ˜ã€‚\n\nç™½è¯\n> ä½¿ç”¨ä»£ç†æ¨¡å¼ï¼Œä¸€ä¸ªç±»è¡¨ç°å‡ºäº†å¦ä¸€ä¸ªç±»çš„åŠŸèƒ½ã€‚\n\nç»´åŸºç™¾ç§‘\n> A proxy, in its most general form, is a class functioning as an interface to something else. A proxy is a wrapper or agent object that is being called by the client to access the real serving object behind the scenes. Use of the proxy can simply be forwarding to the real object, or can provide additional logic. In the proxy extra functionality can be provided, for example caching when operations on the real object are resource intensive, or checking preconditions before operations on the real object are invoked.\n\n**ä»£ç ä¾‹å­**\n\næ‹¿ä¸Šé¢å®‰å…¨é—¨ä¸ºä¾‹ã€‚é¦–å…ˆæˆ‘ä»¬æœ‰äº†é—¨çš„æ¥å£å’Œå®ç°\n\n```php\ninterface Door {\n    public function open();\n    public function close();\n}\n\nclass LabDoor implements Door {\n    public function open() {\n        echo \"Opening lab door\";\n    }\n\n    public function close() {\n        echo \"Closing the lab door\";\n    }\n}\n```\nç„¶åä¸‹é¢æ˜¯ä¸€ä¸ªä»£ç†æ¥å®‰ä¿ä»»ä½•æˆ‘ä»¬è¦çš„é—¨\n```php\nclass Security {\n    protected $door;\n\n    public function __construct(Door $door) {\n        $this->door = $door;\n    }\n\n    public function open($password) {\n        if ($this->authenticate($password)) {\n            $this->door->open();\n        } else {\n        \techo \"Big no! It ain't possible.\";\n        }\n    }\n\n    public function authenticate($password) {\n        return $password === '$ecr@t';\n    }\n\n    public function close() {\n        $this->door->close();\n    }\n}\n```\nç„¶åå¯ä»¥è¿™æ ·ä½¿ç”¨\n```php\n$door = new Security(new LabDoor());\n$door->open('invalid'); // Big no! It ain't possible.\n\n$door->open('$ecr@t'); // Opening lab door\n$door->close(); // Closing lab door\n```\nå¦ä¸€ä¸ªä¾‹å­æ˜¯ä¸€äº›æ•°æ®æ˜ å°„çš„å®ç°ã€‚æ¯”å¦‚ï¼Œæˆ‘æœ€è¿‘ç”¨è¿™ä¸ªæ¨¡å¼ç»™ MongoDB åšäº†ä¸€ä¸ªæ•°æ®æ˜ å°„å™¨ ODM (Object Data Mapper)ï¼Œæˆ‘ç”¨é­”æœ¯æ–¹æ³• `__call()` ç»™ mongo ç±»åšäº†ä¸€ä¸ªä»£ç†ã€‚æ‰€æœ‰æ‰§è¡Œçš„æ–¹æ³•éƒ½è¢«ä»£ç†åˆ°åŸå§‹çš„ mongo ç±»ï¼Œè¿”å›æ”¶åˆ°çš„ç»“æœã€‚ä½†æ˜¯åœ¨ `find` æˆ– `findOne` çš„æƒ…å†µï¼Œæ•°æ®è¢«æ˜ å°„åˆ°å¯¹åº”çš„å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡ä¼šè¢«è¿”å›ï¼Œè€Œä¸æ˜¯ `Cursor`ã€‚\n\nè¡Œä¸ºå‹æ¨¡å¼\n==========================\n\nç™½è¯\n> å®ƒå…³æ³¨å¯¹è±¡é—´çš„è´£ä»»åˆ†é…ã€‚å®ƒä»¬å’Œç»“æ„å‹æ¨¡å¼çš„åŒºåˆ«æ˜¯å®ƒä»¬ä¸æ­¢æ˜ç¡®æŒ‡æ˜ç»“æ„ï¼Œè€Œä¸”æŒ‡å‡ºäº†å®ƒä»¬ä¹‹é—´ä¼ é€’/äº¤æµçš„ä¿¡æ¯çš„å½¢å¼ã€‚æˆ–è€…æ¢å¥æˆ–è¯´ï¼Œå®ƒä»¬å¸®åŠ©å›ç­”äº†â€œå¦‚ä½•ç¡®å®šè½¯ä»¶ç»„ä»¶çš„è¡Œä¸ºï¼Ÿâ€\n\nç»´åŸºç™¾ç§‘\n> In software engineering, behavioral design patterns are design patterns that identify common communication patterns between objects and realize these patterns. By doing so, these patterns increase flexibility in carrying out this communication.\n\n* [è´£ä»»é“¾æ¨¡å¼ Chain of Responsibility](#-è´£ä»»é“¾æ¨¡å¼)\n* [å‘½ä»¤æ¨¡å¼ Command](#-å‘½ä»¤æ¨¡å¼)\n* [è¿­ä»£å™¨æ¨¡å¼ Iterator](#-è¿­ä»£å™¨æ¨¡å¼)\n* [ä¸­ä»‹æ¨¡å¼ Mediator](#-ä¸­ä»‹æ¨¡å¼)\n* [å¤‡å¿˜å½•æ¨¡å¼ Memento](#-å¤‡å¿˜å½•æ¨¡å¼)\n* [è§‚å¯Ÿè€…æ¨¡å¼ Observer](#-è§‚å¯Ÿè€…æ¨¡å¼)\n* [è®¿é—®è€…æ¨¡å¼ Visitor](#-è®¿é—®è€…æ¨¡å¼)\n* [ç­–ç•¥æ¨¡å¼ Strategy](#-ç­–ç•¥æ¨¡å¼)\n* [çŠ¶æ€æ¨¡å¼ State](#-çŠ¶æ€æ¨¡å¼)\n* [æ¨¡æ¿æ¨¡å¼ Template Method](#-æ¨¡æ¿æ¨¡å¼)\n\nğŸ”— è´£ä»»é“¾æ¨¡å¼\n-----------------------\n\nç°å®ä¾‹å­\n> æ¯”å¦‚ï¼Œæœ‰ä¸‰ä¸ªæ”¯ä»˜æ–¹å¼ (`A`, `B` å’Œ `C`) å®‰è£…åœ¨ä½ çš„è´¦æˆ·é‡Œï¼›æ¯ç§æ–¹å¼éƒ½æœ‰ä¸åŒé¢åº¦ã€‚`A` æœ‰ 100 å…ƒï¼Œ `B` æœ‰ 300 å…ƒï¼Œä»¥åŠ `C` æœ‰ 1000 å…ƒï¼Œé€‰æ‹©æ”¯ä»˜æ–¹å¼çš„é¡ºåºæ˜¯ `A` ç„¶å `B` ç„¶å `C`ã€‚ä½ è¦ä¹°ä¸€äº›ä»·å€¼ 210 å…ƒçš„ä¸œè¥¿ã€‚ä½¿ç”¨è´£ä»»é“¾æ¨¡å¼ï¼Œé¦–å…ˆè´¦æˆ· `A` ä¼šè¢«æ£€æŸ¥æ˜¯å¦èƒ½å¤Ÿæ”¯ä»˜ï¼Œå¦‚æœæ˜¯ï¼Œæ”¯ä»˜ä¼šè¢«æ‰§è¡Œè€Œé“¾å­ç»ˆæ­¢ã€‚å¦‚æœå¦ï¼Œè¯·æ±‚ä¼šè½¬ç§»åˆ°è´¦æˆ· `B`ï¼Œæ£€æŸ¥é¢åº¦ï¼Œå¦‚æœæ˜¯ï¼Œé“¾å­ç»ˆæ­¢ï¼Œå¦åˆ™è¯·æ±‚ç»§ç»­è½¬ç§»ç›´åˆ°æ‰¾åˆ°åˆé€‚çš„æ‰§è¡Œè€…ã€‚è¿™é‡Œ `A`ï¼Œ`B` å’Œ `C` æ˜¯é“¾æ¥é‡Œçš„ç¯èŠ‚ï¼Œå®ƒä»¬åˆèµ·æ¥å°±æ˜¯è´£ä»»é“¾ã€‚\n\nç™½è¯\n> å®ƒæ„é€ äº†ä¸€ä¸ªå¯¹è±¡çš„é“¾ã€‚è¯·æ±‚è¿›å…¥ä¸€ç«¯ï¼Œç„¶åä»ä¸€ä¸ªå¯¹è±¡åˆ°å¦ä¸€ä¸ªå¯¹è±¡ç›´åˆ°æ‰¾åˆ°åˆé€‚çš„æ‰§è¡Œè€…ã€‚\n\nç»´åŸºç™¾ç§‘\n> In object-oriented design, the chain-of-responsibility pattern is a design pattern consisting of a source of command objects and a series of processing objects. Each processing object contains logic that defines the types of command objects that it can handle; the rest are passed to the next processing object in the chain.\n\n**ä»£ç ä¾‹å­**\n\nç¿»è¯‘ä¸Šé¢çš„è´¦æˆ·ä¾‹å­ã€‚é¦–å…ˆæˆ‘ä»¬æœ‰äº†ä¸€ä¸ªåŸºæœ¬è´¦æˆ·ï¼ŒåŒ…å«æŠŠè´¦æˆ·è¿æ¥èµ·æ¥çš„é€»è¾‘ã€‚ä»¥åŠä¸€äº›è´¦æˆ·\n\n```php\nabstract class Account {\n    protected $successor;\n    protected $balance;\n\n    public function setNext(Account $account) {\n        $this->successor = $account;\n    }\n    \n    public function pay(float $amountToPay) {\n        if ($this->canPay($amountToPay)) {\n            echo sprintf('Paid %s using %s' . PHP_EOL, $amountToPay, get_called_class());\n        } else if ($this->successor) {\n            echo sprintf('Cannot pay using %s. Proceeding ..' . PHP_EOL, get_called_class());\n            $this->successor->pay($amountToPay);\n        } else {\n            throw Exception('None of the accounts have enough balance');\n        }\n    }\n    \n    public function canPay($amount) : bool {\n        return $this->balance >= $amount;\n    }\n}\n\nclass Bank extends Account {\n    protected $balance;\n\n    public function __construct(float $balance) {\n        $this->balance = $balance;\n    }\n}\n\nclass Paypal extends Account {\n    protected $balance;\n\n    public function __construct(float $balance) {\n        $this->balance = $balance;\n    }\n}\n\nclass Bitcoin extends Account {\n    protected $balance;\n\n    public function __construct(float $balance) {\n        $this->balance = $balance;\n    }\n}\n```\n\nç°åœ¨æˆ‘ä»¬ç”¨ä¸Šé¢å®šä¹‰çš„ç¯èŠ‚ï¼ˆå³é“¶è¡Œ Bankï¼Œè´å® Paypalï¼Œæ¯”ç‰¹å¸ Bitcoinï¼‰å‡†å¤‡é“¾\n\n```php\n// æˆ‘ä»¬å‡†å¤‡ä¸‹é¢è¿™æ ·çš„é“¾\n//      $bank->$paypal->$bitcoin\n//\n// é¦–é€‰é“¶è¡Œ bank\n//      å¦‚æœé“¶è¡Œ bank ä¸èƒ½æ”¯ä»˜åˆ™é€‰æ‹©è´å® paypal\n//      å¦‚æœè´å® paypal ä¸èƒ½æ”¯ä»˜åˆ™é€‰æ‹©æ¯”ç‰¹å¸ bit coin\n\n$bank = new Bank(100);          // é“¶è¡Œ Bank æœ‰ä½™é¢ 100\n$paypal = new Paypal(200);      // è´å® Paypal æœ‰ä½™é¢ 200\n$bitcoin = new Bitcoin(300);    // æ¯”ç‰¹å¸ Bitcoin æœ‰ä½™é¢ 300\n\n$bank->setNext($paypal);\n$paypal->setNext($bitcoin);\n\n// æˆ‘ä»¬å°è¯•ç”¨é¦–é€‰é¡¹æ”¯ä»˜ï¼Œå³é“¶è¡Œ bank\n$bank->pay(259);\n\n// è¾“å‡ºå°†ä¼šæ˜¯\n// ==============\n// Cannot pay using bank. Proceeding ..\n// Cannot pay using paypal. Proceeding ..: \n// Paid 259 using Bitcoin!\n```\n\nğŸ‘® å‘½ä»¤æ¨¡å¼\n-------\n\nç°å®ä¾‹å­\n> ä¸€ä¸ªæ™®éçš„ä¾‹å­æ˜¯ä½ åœ¨é¤é¦†ç‚¹é¤ã€‚ä½  (å³è°ƒç”¨è€… `Client`) è¦æ±‚æœåŠ¡å‘˜ (å³è°ƒç”¨å™¨ `Invoker`) ç«¯æ¥ä¸€äº›é£Ÿç‰© (å³å‘½ä»¤ `Command`)ï¼Œè€ŒæœåŠ¡å‘˜åªæ˜¯ç®€å•çš„æŠŠå‘½ä»¤ä¼ è¾¾ç»™çŸ¥é“æ€ä¹ˆåšèœçš„å¨å¸ˆ (å³æ¥æ”¶è€… `Receiver`)ã€‚å¦ä¸€ä¸ªä¾‹å­æ˜¯ä½  (å³è°ƒç”¨è€… `Client`) æ‰“å¼€ (å³å‘½ä»¤ `Command`) ç”µè§† (å³æ¥æ”¶è€… `Receiver`)ï¼Œé€šè¿‡ä½¿ç”¨é¥æ§ (è°ƒç”¨å™¨ `Invoker`).\n\nç™½è¯\n> å…è®¸ä½ å°è£…å¯¹è±¡çš„åŠŸèƒ½ã€‚æ­¤æ¨¡å¼çš„æ ¸å¿ƒæ€æƒ³æ˜¯åˆ†ç¦»è°ƒç”¨è€…å’Œæ¥æ”¶è€…ã€‚\n\nç»´åŸºç™¾ç§‘\n> In object-oriented programming, the command pattern is a behavioral design pattern in which an object is used to encapsulate all information needed to perform an action or trigger an event at a later time. This information includes the method name, the object that owns the method and values for the method parameters.\n\n**ä»£ç ä¾‹å­**\n\né¦–å…ˆæˆ‘ä»¬æœ‰ä¸€ä¸ªæ¥æ”¶è€…ï¼ŒåŒ…å«äº†æ¯ä¸€ä¸ªå¯æ‰§è¡Œçš„åŠŸèƒ½çš„å®ç°\n```php\n// Receiver\nclass Bulb {\n    public function turnOn() {\n        echo \"Bulb has been lit\";\n    }\n    \n    public function turnOff() {\n        echo \"Darkness!\";\n    }\n}\n```\nç„¶åä¸‹é¢æ˜¯æ¯ä¸ªå‘½ä»¤æ‰§è¡Œçš„æ¥å£ï¼Œä¹‹åæˆ‘ä»¬å°±æœ‰äº†ä¸€ä¸ªå‘½ä»¤çš„é›†åˆ\n```php\ninterface Command {\n    public function execute();\n    public function undo();\n    public function redo();\n}\n\n// Command\nclass TurnOn implements Command {\n    protected $bulb;\n    \n    public function __construct(Bulb $bulb) {\n        $this->bulb = $bulb;\n    }\n    \n    public function execute() {\n        $this->bulb->turnOn();\n    }\n    \n    public function undo() {\n        $this->bulb->turnOff();\n    }\n    \n    public function redo() {\n        $this->execute();\n    }\n}\n\nclass TurnOff implements Command {\n    protected $bulb;\n    \n    public function __construct(Bulb $bulb) {\n        $this->bulb = $bulb;\n    }\n    \n    public function execute() {\n        $this->bulb->turnOff();\n    }\n    \n    public function undo() {\n        $this->bulb->turnOn();\n    }\n    \n    public function redo() {\n        $this->execute();\n    }\n}\n```\nç„¶åæˆ‘ä»¬æœ‰äº†ä¸€ä¸ªæ‰§è¡Œå™¨ `Invoker`ï¼Œè°ƒç”¨è€…å¯ä»¥é€šè¿‡å®ƒæ‰§è¡Œå‘½ä»¤\n```php\n// Invoker\nclass RemoteControl {\n    \n    public function submit(Command $command) {\n        $command->execute();\n    }\n}\n```\næœ€åæˆ‘ä»¬çœ‹çœ‹å¯ä»¥å¦‚ä½•ä½¿ç”¨\n```php\n$bulb = new Bulb();\n\n$turnOn = new TurnOn($bulb);\n$turnOff = new TurnOff($bulb);\n\n$remote = new RemoteControl();\n$remote->submit($turnOn); // Bulb has been lit!\n$remote->submit($turnOff); // Darkness!\n```\n\nå‘½ä»¤æ¨¡å¼ä¹Ÿå¯ä»¥ç”¨æ¥å®ç°ä¸€ä¸ªåŸºç¡€ç³»ç»Ÿçš„äº‹åŠ¡ã€‚å½“ä½ è¦ä¸€ç›´åœ¨æ‰§è¡Œå‘½ä»¤åé©¬ä¸Šç»´æŠ¤æ—¥å¿—ã€‚å¦‚æœå‘½ä»¤è¢«æ­£ç¡®æ‰§è¡Œï¼Œä¸€åˆ‡æ­£å¸¸ï¼Œå¦åˆ™æ²¿æ—¥å¿—è¿­ä»£ï¼Œä¸€ç›´å¯¹æ¯ä¸ªå·²æ‰§è¡Œçš„å‘½ä»¤æ‰§è¡Œæ’¤é”€ `undo` ã€‚\n\nâ¿ è¿­ä»£å™¨æ¨¡å¼\n--------\n\nç°å®ä¾‹å­\n> è€å¼è°ƒé¢‘æ”¶éŸ³æœºæ˜¯è¿­ä»£å™¨çš„å¥½ä¾‹å­ï¼Œç”¨æˆ·å¯ä»¥åœ¨ä¸€äº›é¢‘é“å¼€å§‹ï¼Œç„¶åä½¿ç”¨å‰è¿›æˆ–åé€€æŒ‰é’®æ¥æµè§ˆæ¯ä¸ªé¢‘é“ã€‚æˆ–è€…ä»¥ MP3 æ’­æ”¾å™¨æˆ–ç”µè§†æœºä¸ºä¾‹ï¼Œä½ å¯ä»¥æŒ‰å‰è¿›æˆ–åé€€æŒ‰é’®æ¥æµè§ˆè¿ç»­çš„é¢‘é“ã€‚æˆ–è€…è¯´ï¼Œå®ƒä»¬éƒ½æä¾›äº†è¿­ä»£è¿ç»­çš„é¢‘é“ï¼Œæ­Œæ›²æˆ–å¹¿æ’­çš„æ¥å£ã€‚  \n\nç™½è¯\n> å®ƒæä¾›äº†ä¸€ç§æ–¹å¼æ¥è·å¾—å¯¹è±¡çš„å…ƒç´ ï¼Œè€Œä¸å¿…æš´éœ²åº•å±‚å®ç°ã€‚\n\nç»´åŸºç™¾ç§‘\n> In object-oriented programming, the iterator pattern is a design pattern in which an iterator is used to traverse a container and access the container's elements. The iterator pattern decouples algorithms from containers; in some cases, algorithms are necessarily container-specific and thus cannot be decoupled.\n\n**ä»£ç ä¾‹å­**\n\nåœ¨ PHP é‡Œï¼Œç”¨ SPL (æ ‡å‡† PHP åº“) å®ç°éå¸¸ç®€å•ã€‚ç¿»è¯‘ä¸Šé¢çš„å¹¿æ’­ä¾‹å­ã€‚é¦–å…ˆæˆ‘ä»¬æœ‰äº†å¹¿æ’­å° `RadioStation`\n\n```php\nclass RadioStation {\n    protected $frequency;\n\n    public function __construct(float $frequency) {\n        $this->frequency = $frequency;    \n    }\n    \n    public function getFrequency() : float {\n        return $this->frequency;\n    }\n}\n```\nä¸‹é¢æ˜¯æˆ‘ä»¬çš„è¿­ä»£å™¨\n\n```php\nuse Countable;\nuse Iterator;\n\nclass StationList implements Countable, Iterator {\n    /** @var RadioStation[] $stations */\n    protected $stations = [];\n    \n    /** @var int $counter */\n    protected $counter;\n    \n    public function addStation(RadioStation $station) {\n        $this->stations[] = $station;\n    }\n    \n    public function removeStation(RadioStation $toRemove) {\n        $toRemoveFrequency = $toRemove->getFrequency();\n        $this->stations = array_filter($this->stations, function (RadioStation $station) use ($toRemoveFrequency) {\n            return $station->getFrequency() !== $toRemoveFrequency;\n        });\n    }\n    \n    public function count() : int {\n        return count($this->stations);\n    }\n    \n    public function current() : RadioStation {\n        return $this->stations[$this->counter];\n    }\n    \n    public function key() {\n        return $this->counter;\n    }\n    \n    public function next() {\n        $this->counter++;\n    }\n    \n    public function rewind() {\n        $this->counter = 0;\n    }\n    \n    public function valid(): bool\n    {\n        return isset($this->stations[$this->counter]);\n    }\n}\n```\nç„¶åå¯ä»¥è¿™æ ·ä½¿ç”¨\n```php\n$stationList = new StationList();\n\n$stationList->addStation(new Station(89));\n$stationList->addStation(new Station(101));\n$stationList->addStation(new Station(102));\n$stationList->addStation(new Station(103.2));\n\nforeach($stationList as $station) {\n    echo $station->getFrequency() . PHP_EOL;\n}\n\n$stationList->removeStation(new Station(89)); // Will remove station 89\n```\n\nğŸ‘½ ä¸­ä»‹æ¨¡å¼\n========\n\nç°å®ä¾‹å­\n> ä¸€ä¸ªæ™®éçš„ä¾‹å­æ˜¯å½“ä½ ç”¨æ‰‹æœºå’Œåˆ«äººè°ˆè¯ï¼Œä½ å’Œåˆ«äººä¸­é—´éš”äº†ä¸€ä¸ªç”µä¿¡ç½‘ï¼Œä½ çš„å£°éŸ³ç©¿è¿‡å®ƒè€Œä¸æ˜¯ç›´æ¥å‘å‡ºå»ã€‚åœ¨è¿™é‡Œï¼Œç”µä¿¡ç½‘å°±æ˜¯ä¸€ä¸ªä¸­ä»‹ã€‚\n\nç™½è¯\n> ä¸­ä»‹æ¨¡å¼å¢åŠ äº†ä¸€ä¸ªç¬¬ä¸‰æ–¹å¯¹è±¡ï¼ˆå«åšä¸­ä»‹ï¼‰æ¥æ§åˆ¶ä¸¤ä¸ªå¯¹è±¡ï¼ˆå«åšåŒäº‹ï¼‰é—´çš„äº¤äº’ã€‚å®ƒå¸®åŠ©å‡å°‘ç±»å½¼æ­¤ä¹‹é—´äº¤æµçš„è€¦åˆåº¦ã€‚å› ä¸ºå®ƒä»¬ç°åœ¨ä¸éœ€è¦çŸ¥é“å½¼æ­¤çš„å®ç°ã€‚ \n\nç»´åŸºç™¾ç§‘\n> In software engineering, the mediator pattern defines an object that encapsulates how a set of objects interact. This pattern is considered to be a behavioral pattern due to the way it can alter the program's running behavior.\n\n**ä»£ç ä¾‹å­**\n\nä¸‹é¢æ˜¯ä¸€ä¸ªæœ€ç®€å•çš„èŠå¤©å®¤ï¼ˆå³ä¸­ä»‹ï¼‰çš„ä¾‹å­ï¼Œç”¨æˆ·ï¼ˆå³åŒäº‹ï¼‰å½¼æ­¤å‘é€ä¿¡æ¯ã€‚\n\né¦–å…ˆï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªä¸­ä»‹ï¼Œå³èŠå¤©å®¤\n\n```php\n// ä¸­ä»‹\nclass ChatRoom implements ChatRoomMediator {\n    public function showMessage(User $user, string $message) {\n        $time = date('M d, y H:i');\n        $sender = $user->getName();\n\n        echo $time . '[' . $sender . ']:' . $message;\n    }\n}\n```\n\nç„¶åæˆ‘ä»¬æœ‰ç”¨æˆ·ï¼Œå³åŒäº‹\n```php\nclass User {\n    protected $name;\n    protected $chatMediator;\n\n    public function __construct(string $name, ChatRoomMediator $chatMediator) {\n        $this->name = $name;\n        $this->chatMediator = $chatMediator;\n    }\n    \n    public function getName() {\n        return $this->name;\n    }\n    \n    public function send($message) {\n        $this->chatMediator->showMessage($this, $message);\n    }\n}\n```\nç„¶åæ˜¯ä½¿ç”¨\n```php\n$mediator = new ChatRoom();\n\n$john = new User('John Doe', $mediator);\n$jane = new User('Jane Doe', $mediator);\n\n$john->send('Hi there!');\n$jane->send('Hey!');\n\n// è¾“å‡ºå°†ä¼šæ˜¯\n// Feb 14, 10:58 [John]: Hi there!\n// Feb 14, 10:58 [Jane]: Hey!\n```\n\nğŸ’¾ å¤‡å¿˜å½•æ¨¡å¼\n-------\nç°å®ä¾‹å­\n> ä»¥è®¡ç®—å™¨ï¼ˆå³å‘èµ·äººï¼‰ä¸ºä¾‹ï¼Œæ— è®ºä»€ä¹ˆæ—¶å€™ä½ æ‰§è¡Œä¸€äº›è®¡ç®—ï¼Œæœ€åçš„è®¡ç®—éƒ½ä¼šä¿å­˜åœ¨å†…å­˜ï¼ˆå³å¤‡å¿˜ï¼‰é‡Œï¼Œè¿™æ ·ä½ å°±èƒ½è¿”å›åˆ°è¿™é‡Œï¼Œå¹¶ä¸”ç”¨ä¸€äº›æŒ‰é’®ï¼ˆå³å®ˆæŠ¤è€…ï¼‰æ¢å¤ã€‚ \n\nç™½è¯\n> å¤‡å¿˜å½•æ¨¡å¼æ•æ‰å’Œä¿å­˜å½“å‰å¯¹è±¡çš„çŠ¶æ€ï¼Œç„¶åç”¨ä¸€ç§å¹³æ»‘çš„æ–¹å¼æ¢å¤ã€‚\n\nç»´åŸºç™¾ç§‘\n> The memento pattern is a software design pattern that provides the ability to restore an object to its previous state (undo via rollback).\n\nå½“ä½ è¦æä¾›æ’¤é”€æ–¹æ³•æ—¶å¼‚å¸¸å®ç”¨ã€‚\n\n**ä»£ç ä¾‹å­**\n\nè®©æˆ‘ä»¬é‚£ç¼–è¾‘å™¨ä¸ºä¾‹ï¼Œç¼–è¾‘å™¨ä¸€ç›´ä¿å­˜çŠ¶æ€ï¼Œåœ¨ä½ éœ€è¦çš„æ—¶å€™å¯ä»¥æ¢å¤ã€‚\n\né¦–å…ˆä¸‹é¢æ˜¯æˆ‘ä»¬çš„å¤‡å¿˜å½•å¯¹è±¡ï¼Œå¯ä»¥ä¿å­˜ç¼–è¾‘å™¨çŠ¶æ€\n\n```php\nclass EditorMemento {\n    protected $content;\n    \n    public function __construct(string $content) {\n        $this->content = $content;\n    }\n    \n    public function getContent() {\n        return $this->content;\n    }\n}\n```\n\nç„¶åæ˜¯æˆ‘ä»¬çš„ç¼–è¾‘å™¨ï¼Œå³å‘èµ·è€…ï¼Œæ¥ä½¿ç”¨å¤‡å¿˜å½•å¯¹è±¡\n\n```php\nclass Editor {\n    protected $content = '';\n    \n    public function type(string $words) {\n        $this->content = $this->content . ' ' . $words;\n    }\n    \n    public function getContent() {\n        return $this->content;\n    }\n    \n    public function save() {\n        return new EditorMemento($this->content);\n    }\n    \n    public function restore(EditorMemento $memento) {\n        $this->content = $memento->getContent();\n    }\n}\n```\n\nç„¶åå¯ä»¥è¿™æ ·ä½¿ç”¨\n\n```php\n$editor = new Editor();\n\n// è¾“å…¥ä¸€äº›ä¸œè¥¿\n$editor->type('This is the first sentence.');\n$editor->type('This is second.');\n\n// ä¿å­˜çŠ¶æ€åˆ°ï¼šThis is the first sentence. This is second.\n$saved = $editor->save();\n\n// è¾“å…¥äº›åˆ«çš„ä¸œè¥¿\n$editor->type('And this is third.');\n\n// è¾“å‡º: Content before Saving\necho $editor->getContent(); // This is the first sentence. This is second. And this is third.\n\n// æ¢å¤åˆ°ä¸Šæ¬¡ä¿å­˜çŠ¶æ€\n$editor->restore($saved);\n\n$editor->getContent(); // This is the first sentence. This is second.\n```\n\nğŸ˜ è§‚å¯Ÿè€…æ¨¡å¼\n--------\nç°å®ä¾‹å­\n> ä¸€ä¸ªå¥½çš„ä¾‹å­æ˜¯æ±‚èŒè€…ï¼Œä»–ä»¬è®¢é˜…äº†ä¸€äº›å·¥ä½œå‘å¸ƒç½‘ç«™ï¼Œå½“æœ‰åˆé€‚çš„å·¥ä½œæœºä¼šæ—¶ï¼Œä»–ä»¬ä¼šæ”¶åˆ°æé†’ã€‚   \n\nç™½è¯\n> å®šä¹‰äº†ä¸€ä¸ªå¯¹è±¡é—´çš„ä¾èµ–ï¼Œè¿™æ ·æ— è®ºä½•æ—¶ä¸€ä¸ªå¯¹è±¡æ”¹å˜äº†çŠ¶æ€ï¼Œå…¶ä»–æ‰€æœ‰ä¾èµ–è€…ä¼šæ”¶åˆ°æé†’ã€‚\n\nç»´åŸºç™¾ç§‘\n> The observer pattern is a software design pattern in which an object, called the subject, maintains a list of its dependents, called observers, and notifies them automatically of any state changes, usually by calling one of their methods.\n\n**ä»£ç ä¾‹å­**\n\nç¿»è¯‘ä¸Šé¢çš„ä¾‹å­ã€‚é¦–å…ˆæˆ‘ä»¬æœ‰éœ€è¦æ”¶åˆ°å·¥ä½œå‘å¸ƒæé†’çš„æ±‚èŒè€…\n```php\nclass JobPost {\n    protected $title;\n    \n    public function __construct(string $title) {\n        $this->title = $title;\n    }\n    \n    public function getTitle() {\n        return $this->title;\n    }\n}\n\nclass JobSeeker implements Observer {\n    protected $name;\n\n    public function __construct(string $name) {\n        $this->name = $name;\n    }\n\n    public function onJobPosted(JobPost $job) {\n        // Do something with the job posting\n        echo 'Hi ' . $this->name . '! New job posted: '. $job->getTitle();\n    }\n}\n```\nä¸‹é¢æ˜¯æ±‚èŒè€…è®¢é˜…çš„å·¥ä½œä¿¡æ¯\n```php\nclass JobPostings implements Observable {\n    protected $observers = [];\n    \n    protected function notify(JobPost $jobPosting) {\n        foreach ($this->observers as $observer) {\n            $observer->onJobPosted($jobPosting);\n        }\n    }\n    \n    public function attach(Observer $observer) {\n        $this->observers[] = $observer;\n    }\n    \n    public function addJob(JobPost $jobPosting) {\n        $this->notify($jobPosting);\n    }\n}\n```\nç„¶åå¯ä»¥è¿™æ ·ä½¿ç”¨\n```php\n// åˆ›å»ºè®¢é˜…è€…\n$johnDoe = new JobSeeker('John Doe');\n$janeDoe = new JobSeeker('Jane Doe');\n\n// åˆ›å»ºå‘å¸ƒè€…ï¼Œç»‘å®šè®¢é˜…è€…\n$jobPostings = new JobPostings();\n$jobPostings->attach($johnDoe);\n$jobPostings->attach($janeDoe);\n\n// æ·»åŠ ä¸€ä¸ªå·¥ä½œï¼Œçœ‹è®¢é˜…è€…æ˜¯å¦æ”¶åˆ°é€šçŸ¥\n$jobPostings->addJob(new JobPost('Software Engineer'));\n\n// è¾“å‡º\n// Hi John Doe! New job posted: Software Engineer\n// Hi Jane Doe! New job posted: Software Engineer\n```\n\nğŸƒ è®¿é—®è€…æ¨¡å¼\n-------\nç°å®ä¾‹å­\n> å‡è®¾ä¸€äº›äººè®¿é—®è¿ªæ‹œã€‚ä»–ä»¬éœ€è¦ä¸€äº›æ–¹å¼ï¼ˆå³ç­¾è¯ï¼‰æ¥è¿›å…¥è¿ªæ‹œã€‚æŠµè¾¾åï¼Œä»–ä»¬å¯ä»¥å»è¿ªæ‹œçš„ä»»ä½•åœ°æ–¹ï¼Œè€Œä¸ç”¨ç”³è¯·è®¸å¯æˆ–è€…è·‘è…¿ï¼›ä»–ä»¬çŸ¥é“çš„åœ°æ–¹éƒ½å¯ä»¥å»ã€‚è®¿é—®è€…æ¨¡å¼å¯ä»¥è®©ä½ è¿™æ ·åšï¼Œå®ƒå¸®ä½ æ·»åŠ å¯ä»¥è®¿é—®çš„åœ°æ–¹ï¼Œç„¶åä»–ä»¬å¯ä»¥è®¿é—®å°½å¯èƒ½å¤šçš„åœ°æ–¹è€Œä¸ç”¨åˆ°å¤„è·‘è…¿ã€‚\n\nç™½è¯\n> è®¿é—®è€…æ¨¡å¼å¯ä»¥è®©ä½ æ·»åŠ æ›´å¤šçš„æ“ä½œåˆ°å¯¹è±¡ï¼Œè€Œä¸ç”¨æ”¹å˜ä»–ä»¬ã€‚\n    \nç»´åŸºç™¾ç§‘\n> In object-oriented programming and software engineering, the visitor design pattern is a way of separating an algorithm from an object structure on which it operates. A practical result of this separation is the ability to add new operations to existing object structures without modifying those structures. It is one way to follow the open/closed principle.\n\n**ä»£ç ä¾‹å­**\n\nè®©æˆ‘ä»¬ä»¥åŠ¨ç‰©å›­æ¨¡æ‹Ÿå™¨ä¸ºä¾‹ï¼Œåœ¨é‡Œé¢æˆ‘ä»¬æœ‰ä¸€äº›åŠ¨ç‰©ï¼Œæˆ‘ä»¬å¿…é¡»è®©ä»–ä»¬å«ã€‚è®©æˆ‘ä»¬ç”¨è®¿é—®è€…æ¨¡å¼æ¥ç¿»è¯‘\n\n```php\n// è¢«è®¿è€…\ninterface Animal {\n    public function accept(AnimalOperation $operation);\n}\n\n// è®¿é—®è€…\ninterface AnimalOperation {\n    public function visitMonkey(Monkey $monkey);\n    public function visitLion(Lion $lion);\n    public function visitDolphin(Dolphin $dolphin);\n}\n```\nThen we have our implementations for the animals\n```php\nclass Monkey implements Animal {\n    \n    public function shout() {\n        echo 'Ooh oo aa aa!';\n    }\n\n    public function accept(AnimalOperation $operation) {\n        $operation->visitMonkey($this);\n    }\n}\n\nclass Lion implements Animal {\n    public function roar() {\n        echo 'Roaaar!';\n    }\n    \n    public function accept(AnimalOperation $operation) {\n        $operation->visitLion($this);\n    }\n}\n\nclass Dolphin implements Animal {\n    public function speak() {\n        echo 'Tuut tuttu tuutt!';\n    }\n    \n    public function accept(AnimalOperation $operation) {\n        $operation->visitDolphin($this);\n    }\n}\n```\nå®ç°æˆ‘ä»¬çš„è®¿é—®è€…\n```php\nclass Speak implements AnimalOperation {\n    public function visitMonkey(Monkey $monkey) {\n        $monkey->shout();\n    }\n    \n    public function visitLion(Lion $lion) {\n        $lion->roar();\n    }\n    \n    public function visitDolphin(Dolphin $dolphin) {\n        $dolphin->speak();\n    }\n}\n```\n\nç„¶åå¯ä»¥è¿™æ ·ä½¿ç”¨\n```php\n$monkey = new Monkey();\n$lion = new Lion();\n$dolphin = new Dolphin();\n\n$speak = new Speak();\n\n$monkey->accept($speak);    // Ooh oo aa aa!    \n$lion->accept($speak);      // Roaaar!\n$dolphin->accept($speak);   // Tuut tutt tuutt!\n```\næˆ‘ä»¬æœ¬å¯ä»¥ç®€å•åœ°ç»™åŠ¨ç‰©åŠ ä¸€ä¸ªç»§æ‰¿å±‚æ¥åšåˆ°è¿™ç‚¹ï¼Œä½†æ˜¯è¿™æ ·æ¯å½“æˆ‘ä»¬è¦ç»™åŠ¨ç‰©å¢åŠ æ–°åŠŸèƒ½çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±ä¸å¾—ä¸æ”¹å˜åŠ¨ç‰©ã€‚ä½†æ˜¯ç°åœ¨æˆ‘ä»¬ä¸ç”¨æ”¹å˜ä»–ä»¬ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬è¦ç»™åŠ¨ç‰©å¢åŠ ä¸€ä¸ªè·³çš„è¡Œä¸ºï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ç®€å•åœ°å¢åŠ ä¸€ä¸ªæ–°çš„è®¿é—®è€…\n\n```php\nclass Jump implements AnimalOperation {\n    public function visitMonkey(Monkey $monkey) {\n        echo 'Jumped 20 feet high! on to the tree!';\n    }\n    \n    public function visitLion(Lion $lion) {\n        echo 'Jumped 7 feet! Back on the ground!';\n    }\n    \n    public function visitDolphin(Dolphin $dolphin) {\n        echo 'Walked on water a little and disappeared';\n    }\n}\n```\nç„¶åè¿™æ ·ç”¨\n```php\n$jump = new Jump();\n\n$monkey->accept($speak);   // Ooh oo aa aa!\n$monkey->accept($jump);    // Jumped 20 feet high! on to the tree!\n\n$lion->accept($speak);     // Roaaar!\n$lion->accept($jump);      // Jumped 7 feet! Back on the ground! \n\n$dolphin->accept($speak);  // Tuut tutt tuutt! \n$dolphin->accept($jump);   // Walked on water a little and disappeared\n```\n\nğŸ’¡ ç­–ç•¥æ¨¡å¼\n--------\n\nç°å®ä¾‹å­\n> è€ƒè™‘æ’åºçš„ä¾‹å­ï¼Œæˆ‘ä»¬å®ç°äº†å†’æ³¡æ’åºï¼Œä½†æ˜¯æ•°æ®å¼€å§‹å¢é•¿ï¼Œå†’æ³¡æ’åºå˜å¾—å¾ˆæ…¢ã€‚ä¸ºäº†åº”å¯¹è¿™ä¸ªï¼Œæˆ‘ä»¬å®ç°äº†å¿«é€Ÿæ’åºã€‚ä½†ç°åœ¨å°½ç®¡å¿«é€Ÿæ’åºç®—æ³•å¯¹å¤§æ•°æ®é›†è¡¨ç°æ›´å¥½ï¼Œå°æ•°æ®é›†å´å¾ˆæ…¢ã€‚ä¸ºäº†åº”å¯¹è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬å®ç°ä¸€ä¸ªç­–ç•¥ï¼Œå†’æ³¡æ’åºå¤„ç†å°æ•°æ®é›†ï¼Œå¿«é€Ÿæ’åºå¤„ç†å¤§æ•°æ®é›†ã€‚\n\nç™½è¯\n> ç­–ç•¥æ¨¡å¼å…è®¸ä½ åŸºäºæƒ…å†µé€‰æ‹©ç®—æ³•æˆ–ç­–ç•¥ã€‚\n\nç»´åŸºç™¾ç§‘\n> In computer programming, the strategy pattern (also known as the policy pattern) is a behavioural software design pattern that enables an algorithm's behavior to be selected at runtime.\n \n**ä»£ç ä¾‹å­**\n\nç¿»è¯‘æˆ‘ä»¬ä¸Šé¢çš„ä¾‹å­ã€‚é¦–å…ˆæˆ‘ä»¬æœ‰äº†ç­–ç•¥æ¥å£å’Œä¸åŒçš„ç­–ç•¥å®ç°\n\n```php\ninterface SortStrategy {\n    public function sort(array $dataset) : array; \n}\n\nclass BubbleSortStrategy implements SortStrategy {\n    public function sort(array $dataset) : array {\n        echo \"Sorting using bubble sort\";\n         \n        // Do sorting\n        return $dataset;\n    }\n} \n\nclass QuickSortStrategy implements SortStrategy {\n    public function sort(array $dataset) : array {\n        echo \"Sorting using quick sort\";\n        \n        // Do sorting\n        return $dataset;\n    }\n}\n```\n \nç„¶åæ˜¯å®ç”¨ç­–ç•¥çš„è°ƒç”¨è€…\n```php\nclass Sorter {\n    protected $sorter;\n    \n    public function __construct(SortStrategy $sorter) {\n        $this->sorter = $sorter;\n    }\n    \n    public function sort(array $dataset) : array {\n        return $this->sorter->sort($dataset);\n    }\n}\n```\nç„¶åå¯ä»¥è¿™æ ·ä½¿ç”¨\n```php\n$dataset = [1, 5, 4, 3, 2, 8];\n\n$sorter = new Sorter(new BubbleSortStrategy());\n$sorter->sort($dataset); // è¾“å‡º : Sorting using bubble sort\n\n$sorter = new Sorter(new QuickSortStrategy());\n$sorter->sort($dataset); // è¾“å‡º : Sorting using quick sort\n```\n\nğŸ’¢ çŠ¶æ€æ¨¡å¼\n-----\nç°å®ä¾‹å­\n> æƒ³è±¡ä½ åœ¨ä½¿ç”¨ç”»å›¾ç¨‹åºï¼Œä½ é€‰æ‹©ç¬”åˆ·æ¥ç”»ã€‚ç°åœ¨ç¬”åˆ·æ ¹æ®é€‰æ‹©çš„é¢œè‰²æ”¹å˜è‡ªå·±çš„è¡Œä¸ºã€‚å³å¦‚æœä½ é€‰æ‹©çº¢è‰²ï¼Œå®ƒå°±ç”¨çº¢è‰²ç”»ï¼Œå¦‚æœæ˜¯è“è‰²å®ƒå°±ç”¨è“è‰²ç­‰ç­‰ã€‚  \n\nç™½è¯\n> ä»–è®©ä½ èƒ½ç±»çš„çŠ¶æ€æ”¹å˜æ—¶ï¼Œæ”¹å˜å…¶è¡Œä¸ºã€‚\n\nç»´åŸºç™¾ç§‘\n> The state pattern is a behavioral software design pattern that implements a state machine in an object-oriented way. With the state pattern, a state machine is implemented by implementing each individual state as a derived class of the state pattern interface, and implementing state transitions by invoking methods defined by the pattern's superclass.\n> The state pattern can be interpreted as a strategy pattern which is able to switch the current strategy through invocations of methods defined in the pattern's interface.\n\n**ä»£ç ä¾‹å­**\n\nè®©æˆ‘ä»¬ä»¥ç¼–è¾‘å™¨ä½œä¸ºä¾‹å­ï¼Œå®ƒèƒ½è®©ä½ æ”¹å˜æ–‡æœ¬çš„çŠ¶æ€ï¼Œæ¯”å¦‚ä½ é€‰æ‹©äº†åŠ ç²—ï¼Œå®ƒå¼€å§‹ä»¥åŠ ç²—å­—ä½“ä¹¦å†™ï¼Œå¦‚æœé€‰æ‹©å€¾æ–œï¼Œå°±ä»¥å€¾æ–œå­—ä½“ç­‰ç­‰ã€‚\n\né¦–å…ˆï¼Œæˆ‘ä»¬æœ‰çŠ¶æ€æ¥å£å’Œä¸€äº›çŠ¶æ€å®ç°\n\n```php\ninterface WritingState {\n    public function write(string $words);\n}\n\nclass UpperCase implements WritingState {\n    public function write(string $words) {\n        echo strtoupper($words); \n    }\n} \n\nclass LowerCase implements WritingState {\n    public function write(string $words) {\n        echo strtolower($words); \n    }\n}\n\nclass Default implements WritingState {\n    public function write(string $words) {\n        echo $words;\n    }\n}\n```\nä¸‹é¢æ˜¯æˆ‘ä»¬çš„ç¼–è¾‘å™¨\n```php\nclass TextEditor {\n    protected $state;\n    \n    public function __construct(WritingState $state) {\n        $this->state = $state;\n    }\n    \n    public function setState(WritingState $state) {\n        $this->state = $state;\n    }\n    \n    public function type(string $words) {\n        $this->state->write($words);\n    }\n}\n```\nç„¶åå¯ä»¥è¿™æ ·ä½¿ç”¨\n```php\n$editor = new TextEditor(new Default());\n\n$editor->type('First line');\n\n$editor->setState(new UpperCaseState());\n\n$editor->type('Second line');\n$editor->type('Third line');\n\n$editor->setState(new LowerCaseState());\n\n$editor->type('Fourth line');\n$editor->type('Fifth line');\n\n// è¾“å‡º:\n// First line\n// SECOND LINE\n// THIRD LINE\n// fourth line\n// fifth line\n```\n\nğŸ“’ æ¨¡æ¿æ¨¡å¼\n---------------\n\nç°å®ä¾‹å­\n> å‡è®¾æˆ‘ä»¬è¦å»ºæˆ¿å­ã€‚å»ºé€ çš„æ­¥éª¤ç±»ä¼¼è¿™æ · \n> - å‡†å¤‡æˆ¿å­çš„åœ°åŸº\n> - å»ºé€ å¢™\n> - å»ºé€ æˆ¿é¡¶\n> - ç„¶åæ˜¯åœ°æ¿\n> è¿™äº›æ­¥éª¤æ­¥éª¤çš„é¡ºåºæ°¸è¿œä¸ä¼šå˜ï¼Œå³ä½ ä¸èƒ½åœ¨å»ºå¢™ä¹‹å‰å»ºå±‹é¡¶ï¼Œå½“æ—¶æ¯ä¸ªæ­¥éª¤éƒ½å¯ä»¥æ”¹å˜ï¼Œæ¯”å¦‚å¢™å¯ä»¥æ˜¯æœ¨å¤´å¯ä»¥æ˜¯èšé…¯æˆ–è€…çŸ³å¤´ã€‚\n  \nç™½è¯\n> æ¨¡æ¿æ¨¡å¼å®šä¹‰äº†ä¸€ä¸ªç®—æ³•ä¼šå¦‚ä½•æ‰§è¡Œçš„éª¨æ¶ï¼Œä½†æŠŠè¿™äº›æ­¥éª¤çš„å®ç°ç§»äº¤ç»™å­ç±»ã€‚\n \nç»´åŸºç™¾ç§‘\n> In software engineering, the template method pattern is a behavioral design pattern that defines the program skeleton of an algorithm in an operation, deferring some steps to subclasses. It lets one redefine certain steps of an algorithm without changing the algorithm's structure.\n\n**ä»£ç ä¾‹å­**\n\næƒ³è±¡æˆ‘ä»¬æœ‰ä¸€ä¸ªæ„å»ºå·¥å…·å¸®æˆ‘ä»¬æµ‹è¯•ï¼Œçº é”™ï¼Œæ„å»ºï¼Œç”Ÿæˆæ„å»ºæŠ¥å‘Šï¼ˆå³ä»£ç æŠ¥å‘Šï¼ŒæŸ¥é”™æŠ¥å‘Šï¼‰ï¼Œç„¶åæŠŠåº”ç”¨å‘å¸ƒåˆ°æµ‹è¯•æœåŠ¡å™¨ã€‚\n\né¦–å…ˆæ˜¯æˆ‘ä»¬çš„åŸºç¡€ç±»ï¼Œå®ƒæè¿°äº†æ„å»ºç®—æ³•çš„éª¨æ¶\n```php\nabstract class Builder {\n    \n    // Template method \n    public final function build() {\n        $this->test();\n        $this->lint();\n        $this->assemble();\n        $this->deploy();\n    }\n    \n    public abstract function test();\n    public abstract function lint();\n    public abstract function assemble();\n    public abstract function deploy();\n}\n```\n\nä»¥ä¸‹æ˜¯å®ç°\n\n```php\nclass AndroidBuilder extends Builder {\n    public function test() {\n        echo 'Running android tests';\n    }\n    \n    public function lint() {\n        echo 'Linting the android code';\n    }\n    \n    public function assemble() {\n        echo 'Assembling the android build';\n    }\n    \n    public function deploy() {\n        echo 'Deploying android build to server';\n    }\n}\n\nclass IosBuilder extends Builder {\n    public function test() {\n        echo 'Running ios tests';\n    }\n    \n    public function lint() {\n        echo 'Linting the ios code';\n    }\n    \n    public function assemble() {\n        echo 'Assembling the ios build';\n    }\n    \n    public function deploy() {\n        echo 'Deploying ios build to server';\n    }\n}\n```\nç„¶åå¯ä»¥è¿™æ ·ä½¿ç”¨\n\n```php\n$androidBuilder = new AndroidBuilder();\n$androidBuilder->build();\n\n// è¾“å‡º:\n// Running android tests\n// Linting the android code\n// Assembling the android build\n// Deploying android build to server\n\n$iosBuilder = new IosBuilder();\n$iosBuilder->build();\n\n// è¾“å‡º:\n// Running ios tests\n// Linting the ios code\n// Assembling the ios build\n// Deploying ios build to server\n```\n\n## ğŸš¦ æ”¶å°¾äº†åŒå¿—ä»¬\n\nç»ˆäºæ”¶å°¾äº†ã€‚æˆ‘ä¼šç»§ç»­æ”¹è¿›è¿™ç¯‡æ–‡æ¡£ï¼Œæ‰€ä»¥ä½ æˆ–è®¸éœ€è¦ watch/star è¿™ä¸ªä»“åº“ï¼Œå…ˆç åçœ‹ã€‚\n\n## ğŸ‘¬ Contribution\n\n- Report issues\n- Open pull request with improvements\n- Spread the word\n\n## ç¿»è¯‘\n[æœˆçƒäºº](https://github.com/questionlin)\n\n## License\nMIT Â© [Kamran Ahmed](http://kamranahmed.info)\n","tags":["php"]},{"title":"hexo+githubæ­å»ºåšå®¢æœ€ä½³å®è·µ","url":"/posts/1528164408/","content":"\båœ¨è€ƒå¯Ÿäº†å¤šç§æ–¹æ¡ˆåæœ€ç»ˆä½¿ç”¨ hexo æ­èµ·äº†åšå®¢ï¼Œè¿™ç¯‡æ–‡ç« å†™å†™æˆ‘æ˜¯æ€ä¹ˆ\bä½¿ç”¨ hexo å’Œ github æ¥æ­åšå®¢çš„ã€‚\n\nåœ¨å®˜ç½‘ä¸»é¢˜é‚£é‡Œé€‰ä¸€ä¸ªå–œæ¬¢çš„ä¸»é¢˜ï¼Œæˆ‘æ‰¾äº†ä¸€ä¸ªæœ‰æœç´¢å¼•æ“é…ç½®æ•™å­¦çš„ã€‚ä¸‹è½½åæ”¾åˆ° themes æ–‡ä»¶å¤¹ã€‚ç„¶åæŒ‰ç…§å®˜æ–¹è¯´æ˜é…ç½®ã€‚\n\nhexo ä¸æä¾› markdown ç¼–è¾‘å™¨ï¼Œæˆ‘ä½¿ç”¨ vscodeï¼Œå¿«æ·é”® command + k å†æŒ‰ v åå¯ä»¥æ‰“å¼€ä¸€ä¸ªå®æ—¶é¢„è§ˆæ ‡ç­¾é¡µã€‚\n\næˆ‘æœ‰ä¸€ä¸ªç‰¹æ®Šçš„éœ€æ±‚ï¼Œå¸Œæœ›å¯ä»¥çœç•¥éƒ¨ç½²( hexo deploy) è¿™ä¸ªæ­¥éª¤ã€‚è¿™å°±è¦æ±‚åšå®¢æºæ–‡ä»¶å’Œç”Ÿæˆæ–‡ä»¶æ”¾åœ¨ä¸€èµ·ã€‚github pages æä¾›ç»™ç”¨æˆ·ä¸“é—¨å»º\båšå®¢çš„é¡¹ç›®åªèƒ½æ”¾ç”Ÿæˆåçš„æ–‡ä»¶ï¼Œè¿™ä¸ªæ–¹æ¡ˆå¦å®šã€‚æˆ‘çš„åšæ³•æ˜¯ï¼š\n1. æŠŠ _config.yml é‡Œé¢çš„ public_dir æ”¹ä¸º docs\n2. ç„¶åå»ºä¸€ä¸ªæ™®é€šçš„é¡¹ç›®ä»“åº“ï¼Œåœ¨ settings é‡Œçš„ github pages Source é€‰ä¸º master branch/docs folderã€‚è¿™é‡Œé¡ºä¾¿æŠŠ Custom domain æ”¹ä¸ºè‡ªå·±çš„åŸŸåã€‚\n3. åœ¨åŸŸå dns è®¾ç½®é‡Œé¢æ·»åŠ  cname æŒ‡å‘ question.github.io\n4. åœ¨æ–‡ç« é¡¶éƒ¨å¢åŠ  idï¼Œå€¼ä¸º unix æ—¶é—´æˆ³ï¼Œä»¥ä¼˜åŒ– url\n\nç”¨åˆ°çš„æ’ä»¶ï¼š\n- hexo-generator-search ç”¨æ¥æ”¯æŒ\bæœç´¢\n\nåˆ°æ­¤æˆ‘çš„ hexo åšå®¢å°±å»ºå¥½äº†ï¼Œ\b[é¡¹ç›®ä»“åº“åœ¨è¿™é‡Œ](https://github.com/questionlin/blog)ã€‚æ¯”å®˜æ–¹çš„æ–¹æ³•å°‘äº†ä¸€æ­¥ã€‚","tags":["hexo"]}]